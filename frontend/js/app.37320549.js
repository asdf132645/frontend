(function(){var e={5358:function(e,t,a){var l={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":1470,"./br.js":1470,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":3635,"./cv.js":3635,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":2477,"./fo.js":2477,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":609,"./hu.js":609,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":9532,"./lv.js":9532,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":1765,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":1765,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":4856,"./uz-latn.js":4856,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(l,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}s.keys=function(){return Object.keys(l)},s.resolve=o,e.exports=s,s.id=5358},2708:function(e,t,a){"use strict";var l=a(3751),s=(a(4114),a(3375),a(9225),a(3972),a(9209),a(5714),a(7561),a(6197),a(641)),o=a(953),n=a(33),i=a.p+"img/celli.2d8862ab.png",r=a(5220),c=a(6278);const u=[{grpCd:"00",grpNm:"User position",cd:"00",cdNm:"Position"},{grpCd:"00",grpNm:"User position",cd:"01",cdNm:"Executive advisor"},{grpCd:"00",grpNm:"User position",cd:"02",cdNm:"General manager"},{grpCd:"00",grpNm:"User position",cd:"03",cdNm:"Chief"},{grpCd:"00",grpNm:"User position",cd:"04",cdNm:"Assistant manager"},{grpCd:"00",grpNm:"User position",cd:"05",cdNm:"Staff"},{grpCd:"01",grpNm:"User authorization",cd:"01",cdNm:"Normal"},{grpCd:"01",grpNm:"User authorization",cd:"02",cdNm:"Admin"},{grpCd:"01",grpNm:"User authorization",cd:"03",cdNm:"Developer"},{grpCd:"02",grpNm:"Cassete state",cd:"0",cdNm:"Empty"},{grpCd:"02",grpNm:"Cassete state",cd:"1",cdNm:"Ready"},{grpCd:"02",grpNm:"Cassete state",cd:"2",cdNm:"Analyzing"},{grpCd:"02",grpNm:"Cassete state",cd:"3",cdNm:"Complete"},{grpCd:"02",grpNm:"Cassete state",cd:"4",cdNm:"Error"},{grpCd:"02",grpNm:"Cassete state",cd:"9",cdNm:"Scan"},{grpCd:"03",grpNm:"Processing code",cd:"01",cdNm:"Cassette Loaded."},{grpCd:"03",grpNm:"Processing code",cd:"02",cdNm:"PB/BM Sequence Start."},{grpCd:"03",grpNm:"Processing code",cd:"03",cdNm:"Cassette Scanning......"},{grpCd:"03",grpNm:"Processing code",cd:"04",cdNm:"Cassette Scanned."},{grpCd:"03",grpNm:"Processing code",cd:"05",cdNm:"Loading Slide #"},{grpCd:"03",grpNm:"Processing code",cd:"06",cdNm:"Barcode Scanned : "},{grpCd:"03",grpNm:"Processing code",cd:"07",cdNm:"Low Power Slide Scanning......"},{grpCd:"03",grpNm:"Processing code",cd:"08",cdNm:"Low Power Slide Scan Complete."},{grpCd:"03",grpNm:"Processing code",cd:"09",cdNm:"Dispensing Immersion Oil......"},{grpCd:"03",grpNm:"Processing code",cd:"10",cdNm:"High Power Slide Scanning......"},{grpCd:"03",grpNm:"Processing code",cd:"11",cdNm:"RBC Classification Processing......"},{grpCd:"03",grpNm:"Processing code",cd:"11",cdNm:"WBC Classification Processing......"},{grpCd:"03",grpNm:"Processing code",cd:"12",cdNm:"Unloading Slide #"},{grpCd:"03",grpNm:"Processing code",cd:"13",cdNm:"Cassette Complete"},{grpCd:"04",grpNm:"Analysis type",cd:"01",cdNm:"PB smear"},{grpCd:"04",grpNm:"Analysis type",cd:"02",cdNm:"BM smear"},{grpCd:"04",grpNm:"Analysis type",cd:"03",cdNm:"Touch print"},{grpCd:"04",grpNm:"Analysis type",cd:"04",cdNm:"BM biopsy"},{grpCd:"04",grpNm:"Analysis type",cd:"05",cdNm:"Clot section"},{grpCd:"05",grpNm:"Cell count",cd:"01",cdNm:"100 count"},{grpCd:"05",grpNm:"Cell count",cd:"02",cdNm:"200 count"},{grpCd:"05",grpNm:"Cell count",cd:"03",cdNm:"300 count"},{grpCd:"05",grpNm:"Cell count",cd:"04",cdNm:"400 count"},{grpCd:"05",grpNm:"Cell count",cd:"05",cdNm:"500 count"},{grpCd:"06",grpNm:"General stain",cd:"01",cdNm:"Wright stain"},{grpCd:"06",grpNm:"General stain",cd:"02",cdNm:"Giemsa stain"},{grpCd:"06",grpNm:"General stain",cd:"03",cdNm:"Wright & Giemsa stain"},{grpCd:"07",grpNm:"Special stain",cd:"04",cdNm:"Iron stain"},{grpCd:"07",grpNm:"Special stain",cd:"05",cdNm:"Trichrome stain"},{grpCd:"07",grpNm:"Special stain",cd:"06",cdNm:"Myeloperoxidase stain"},{grpCd:"07",grpNm:"Special stain",cd:"07",cdNm:"NSE stain"},{grpCd:"07",grpNm:"Special stain",cd:"08",cdNm:"NSE stain after NaFinhibition"},{grpCd:"07",grpNm:"Special stain",cd:"09",cdNm:"Reticulin stain"},{grpCd:"07",grpNm:"Special stain",cd:"10",cdNm:"PAS stain"},{grpCd:"08",grpNm:"Immuno stain",cd:"11",cdNm:"CD 3"},{grpCd:"08",grpNm:"Immuno stain",cd:"12",cdNm:"CD 5"},{grpCd:"08",grpNm:"Immuno stain",cd:"13",cdNm:"CD 20"},{grpCd:"08",grpNm:"Immuno stain",cd:"14",cdNm:"CD 79a"},{grpCd:"09",grpNm:"Sampling stain",cd:"01",cdNm:"Single"},{grpCd:"09",grpNm:"Sampling stain",cd:"02",cdNm:"Both"},{grpCd:"10",grpNm:"Gender",cd:"01",cdNm:"Male"},{grpCd:"10",grpNm:"Gender",cd:"02",cdNm:"Female"},{grpCd:"11",grpNm:"Test Type",cd:"01",cdNm:"PB"},{grpCd:"11",grpNm:"Test Type",cd:"02",cdNm:"BF(Default)"},{grpCd:"11",grpNm:"Test Type",cd:"03",cdNm:"BF(Select)"},{grpCd:"11",grpNm:"Test Type",cd:"04",cdNm:"Premium"},{grpCd:"12",grpNm:"Signed state",cd:"01",cdNm:"Signed"},{grpCd:"12",grpNm:"Signed state",cd:"02",cdNm:"Ready"},{grpCd:"13",grpNm:"Log type",cd:"00",cdNm:"User log"},{grpCd:"13",grpNm:"Log type",cd:"01",cdNm:"System log"},{grpCd:"14",grpNm:"Slot state",cd:"00",cdNm:"Empty"},{grpCd:"14",grpNm:"Slot state",cd:"01",cdNm:"Ready"},{grpCd:"14",grpNm:"Slot state",cd:"02",cdNm:"Scan"},{grpCd:"14",grpNm:"Slot state",cd:"03",cdNm:"Analyzing"},{grpCd:"14",grpNm:"Slot state",cd:"04",cdNm:"Complete"},{grpCd:"14",grpNm:"Slot state",cd:"05",cdNm:"Error"}],d=[{value:"01",text:"WBC Diff"},{value:"04",text:"PBS"},{value:"02",text:"Body fluid default"},{value:"03",text:"Body fluid select"}],m=[{value:"02",text:"BM smear"},{value:"03",text:"Touch print"},{value:"04",text:"BM biopsy"},{value:"05",text:"Clot section"}],v=(e,t)=>{const a=u.find((a=>a.grpCd===e&&a.cd===t));return a?.cdNm};function p(e){if(!e)return"";const[t,a,l,s,o,n]=[e.substring(0,4),e.substring(4,6),e.substring(6,8),e.substring(8,10),e.substring(10,12),e.substring(12,14)];return`${t}-${a}-${l} ${s}:${o}:${n}`}const g=e=>{const t=d.find((t=>t.value===e));return t?t.text:""},f=e=>{const t=m.find((t=>t.value===e));return t?t.text:""},I=(e,t,a,l)=>{const s=window.APP_API_BASE_URL||"http://192.168.0.115:3002";return`${s}/images/getImageRealTime?folder=${t+"/"+a+"/"+l+"/"}&imageName=${e}`},y=(0,s.Lk)("h3",{class:"titleText"},[(0,s.Lk)("span",{class:"greenColor"},"P"),(0,s.eW)("rocessing "),(0,s.Lk)("span",{class:"greenColor"},"I"),(0,s.eW)("nformation ")],-1),b={class:"processInfoUl"},C=(0,s.Lk)("span",{class:"proSpan"},"Cassette No",-1),h={class:"proVal"},S=(0,s.Lk)("span",{class:"proSpan"},"Barcode ID",-1),k={class:"proVal"},N=(0,s.Lk)("span",{class:"proSpan"},"Patient ID",-1),_={class:"proVal"},E=(0,s.Lk)("span",{class:"proSpan"},"Patient Name",-1),w={class:"proVal"},R={class:"proSpan"},L={class:"proVal"},T={class:"proSpan"},P={class:"proVal"},A=(0,s.Lk)("span",{class:"proSpan"},"Oil Count",-1),D={class:"proVal"},M={class:"proSpan"},x={class:"proVal"};var K=(0,s.pM)({__name:"processInfo",props:["parsedData"],setup(e){const t=e,a=(0,c.Pj)(),l=(0,s.EW)((()=>a.state.embeddedStatusModule)),i=(0,s.EW)((()=>a.state.commonModule.siteCd)),r=(0,o.KR)({}),u=(0,o.KR)(null),d=((0,s.nI)(),(0,o.KR)(!1)),m=(0,o.KR)(""),v=(0,o.KR)("");(0,s.wB)([l.value],(async e=>{if(e.length>0){const t=e[0].sysInfo;t.oilCount!==u.value&&(r.value.oilCount=t.oilCount,u.value=t.oilCount),m.value=t.currentCardCount,v.value=t.currentCardName}})),(0,s.sV)((()=>{u.value=l.value[0]?.sysInfo.oilCount,d.value="bm"===window.PROJECT_TYPE})),(0,s.wB)((()=>t.parsedData),((e,t)=>{g(e)}),{deep:!0});const g=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const e=t?.slotInfo;e&&(r.value={cassetteNo:"",barcodeId:e.barcodeNo,patientId:e.patientId,patientName:e.patientNm,orderDate:p(e.orderDttm),analyzedDttm:p(e.analyzedDttm)})}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[y,(0,s.Lk)("ul",b,[(0,s.Lk)("li",null,[C,(0,s.eW)(),(0,s.Lk)("span",h,(0,n.v_)(r.value?.cassetteNo),1)]),(0,s.Lk)("li",null,[S,(0,s.eW)(),(0,s.Lk)("span",k,(0,n.v_)(r.value?.barcodeId),1)]),(0,s.Lk)("li",null,[N,(0,s.eW)(),(0,s.Lk)("span",_,(0,n.v_)(r.value?.patientId),1)]),(0,s.Lk)("li",null,[E,(0,s.eW)(),(0,s.Lk)("span",w,(0,n.v_)(r.value?.patientName),1)]),(0,s.Lk)("li",null,[(0,s.Lk)("span",R,(0,n.v_)(d.value?"BM CELL Count ":"WBC Count "),1),(0,s.Lk)("span",L,(0,n.v_)(r.value?.wbcCount),1)]),(0,s.Lk)("li",null,[(0,s.Lk)("span",T,(0,n.v_)("0019"===i.value?"Order Date":"Analyzed Date"),1),(0,s.Lk)("span",P,(0,n.v_)("0019"===i.value?r.value?.analyzedDttm:r.value?.orderDate),1)]),(0,s.Lk)("li",null,[A,(0,s.Lk)("span",D,(0,n.v_)(u.value),1)]),(0,s.Lk)("li",null,[(0,s.Lk)("span",M,(0,n.v_)(v.value),1),(0,s.Lk)("span",x,(0,n.v_)(m.value),1)])])]))}});const O=K;var B=O;const F=[{value:"100",text:"100 WBC"},{value:"150",text:"150 WBC"},{value:"200",text:"200 WBC"},{value:"250",text:"250 WBC"},{value:"300",text:"300 WBC"},{value:"350",text:"350 WBC"},{value:"400",text:"400 WBC"},{value:"450",text:"450 WBC"},{value:"500",text:"500 WBC"}],U=[{value:"100",text:"100"},{value:"200",text:"200"},{value:"300",text:"300"},{value:"400",text:"400"},{value:"500",text:"500"},{value:"600",text:"600"},{value:"700",text:"700"},{value:"800",text:"800"},{value:"900",text:"900"},{value:"1000",text:"1000"},{value:"1100",text:"1100"},{value:"1200",text:"1200"},{value:"1300",text:"1300"},{value:"1400",text:"1400"},{value:"1500",text:"1500"}],$=[{value:"1",text:"1 stitch"},{value:"2",text:"2 stitch"},{value:"3",text:"3 stitch"},{value:"4",text:"4 stitch"},{value:"5",text:"5 stitch"}],W={input:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"},{slotNo:11,slotState:"0"},{slotNo:12,slotState:"0"}],output:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"},{slotNo:11,slotState:"0"},{slotNo:12,slotState:"0"}]},X={input:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"}],output:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"}]},G={Logout:"Would you like to log out?",GET_POSITION_LIST:"getPositionList",GET_LOGIN_HISTORY:"getLoginHistory",SET_USER:"setUser",IS_REGIST_USER:"isRegistUser",UPDATE_LOGIN_DTTM:"updateLoginDttm",UPDATE_USER_AVAILABLE:"updateUserAvailable",GET_WBC_CLASS_LIST:"getWbcClassList",GET_WBC_CLASS_LIST_ALL:"getWbcClassListAll",GET_WBC_TOTAL_COUNT:"getWbcTotalCount",UPDATE_WBC_COUNT:"updateWbcCount",GET_WBC_COUNT:"getWbcCount",GET_TEST_TYPE:"getTestType",GET_MODIFIED_TEST_TYPE:"getModifiedTestType",GET_STITCH_COUNT:"getStitchCount",GET_RBC_COUNT:"getRbcCount",GET_RBC_COUNT_HIST:"getRbcCountHist",GET_RBC_COUNT_SKMC:"getRbcCountSkmc",UPDATE_DEGREE:"updateDegree",INIT_WBC_COUNT:"initWbcCount",INIT_RBC_DEGREE:"initRbcDegree",GET_WBC_INFO:"getWbcInfo",SET_WBC_IMAGE_HIST:"setWbcImageHist",GET_WBC_IMAGE_HIST:"getWbcImageHist",INIT_WBC_IMAGE_HIST:"initWbcImageHist",INSERT_WBC_CLASSIFICATION:"insertWbcClassification",SET_WBC_CUSTOM_LIST:"setWbcClassList",UPDATE_HOT_KEYS:"updateHotKeys",UPDATE_BF_HOT_KEYS:"updateBfHotKeys",UPDATE_ORDER:"updateOrder",UPDATE_ORDER_BF:"updateOrderBf",UPDATE_IMAGE_HIST:"updateImageHist",SET_CURRENT_WBC_RESULTS:"setCurrentWbcResults",GET_CURRENT_WBC_RESULTS:"getCurrentWbcResults",SET_BEFORE_WBC_RESULTS:"setBeforeWbcResults",GET_BEFORE_WBC_RESULTS:"getBeforeWbcResults",GET_WBC_MODIFY_LIST:"getWbcModifyList",GET_WBC_MODIFY_LIST_ALL:"getWbcModifyListAll",GET_BF_MODIFY_LIST:"getBfModifyList",GET_RBC_CLASS_LIST:"getRbcClassList",GET_MALARIA_COUNT:"getMalariaCount",UPDATE_MALARIA_COUNT:"updateMalariaCount",SET_CURRENT_RBC_RESULTS:"setCurrentRbcResults",GET_CURRENT_RBC_RESULTS:"getCurrentRbcResults",SET_CLASSIFICATION:"setClassification",GET_CLASSIFICATION_ITEM:"getClassificationItem",SET_CLASSIFICATION_ITEM:"setClassificationItem",UPDATE_RBC_CLASSIFICATION:"updateRbcClassificatin",UPDATE_RBC_CLASSIFICATION_SKMC:"updateRbcClassificatinSkmc",INSERT_WBC_SUCCESS:"insertWbcSuccess",SELECT_RBC_DEGREE:"selectRbcDegree",UPDATE_RBC_DEGREE:"updateRbcDegree",SET_TEST_LIST:"setTestList",GET_TEST_LIST:"getTestList",GET_TEST_RESULT:"getTestResult",GET_RBC_FIELDS:"getRbcFields",GET_WBC_FIELDS:"getWbcFields",GET_RBC_ITEMS:"getRbcItems",GET_WBC_ITEMS:"getWbcItems",INIT_OIL_COUNT:"initOilCount",UPDATE_RESULT:"updateResult",UPDATE_RUNNING_STATE:"updateRunningState",GET_ORDER_LIST:"getOrderList",SET_ORDER_LIST:"setOrderList",UPDATE_ORDER_LIST:"updateOrderList",INIT_ORDER_LIST:"initOrderList",GET_TEST_RESULT_ALL:"getTestResultAll",GET_SEARCH_OPTIONS:"getSearchOptions",UPDATE_SEARCH_OPTIONS:"updateSearchOption",SET_TEST_HISTORY:"setTestHistory",GET_TEST_HISTORY_LIST:"getTestHistoryList",ALL_TEST_HISTORY_LIST:"allTestHistoryList",SEARCH_TEST_HISTORY_LIST:"searchTestHistoryList",UPDATE_TEST_HISTORY:"updateTestHistory",GET_TEST_HISTORY:"getTestHistory",DELETE_TEST_HISTORY:"deleteTestHistory",UPDATE_SIGNED_STATE:"updatesubmitState",UPDATE_TEST_HISTORY_WBC_INFO:"updateTestHistoryWbcInfo",GET_RBC_COMMENT:"getRbcComment",GET_WBC_COMMENT:"getWbcComment",GET_RUNNING_INTERVAL_ID:"getRunningIntervalId",SET_RUNNING_INTERVAL_ID:"setRuningIntervalId",UPDATE_TIMER:"updateWorkingTimer",GET_TIMER:"getWorkingTimer",SET_TIMER:"setWorkingTimer",SET_WORKING_INTERVAL_ID:"setWorkingIntervalId",GET_WORKING_INTERVAL_ID:"getWorkingIntervalId",GET_RUNNING_STATE:"getRunningState",SET_SLIDE_TIMER:"setSlideTimer",UPDATE_SLIDE_TIMER:"updateSlideTimer",GET_SLIDE_TIME_COUNT:"getSlideTimeCount",SET_USER_STOP:"setUserStop",GET_USER_STOP:"getUserStop",SET_WBC_CELL_POSITION:"setWbcCellPosition",GET_WBC_CELL_POSITION:"getWbcCellPosition",GET_TEST_HISTORY_PREV:"getTestHistoryPrev",GET_TEST_HISTORY_NEXT:"getTestHistoryNext",SET_IS_RECOVERY_RUN:"setIsRecoveryRun",GET_IS_RECOVERY_RUN:"getIsRecoveryRun",SET_WORK_LIST:"setWorkList",GET_WORK_LIST:"getWorkList",INIT_WORK_LIST:"initWorkList",DELETE_WORK_LIST:"deleteWorkList",UPDATE_WORK_LIST:"updateWorkList",UPDATE_WORK_LIST_BM:"updateWorkListBm",UPDATE_SIGNED_WORK_LIST:"updateSignedWorkList",UPDATE_RBC_COMMENT:"updateRbcComment",UPDATE_WBC_COMMENT:"updateWbcComment",UPDATE_BM_COMMENT:"updateBmComment",UPDATE_SELECT_ORDER_ID:"updateSelectOrderId",GET_SELECT_ORDER_ID:"getSelectOrderId",ADD_WORK_LIST:"addWorkList",GET_TEST_BARCODES:"getTestBarcodes",ADD_DSP_LIST:"addDspList",GET_DSP_LIST:"getDspList",SET_LIS_HOT_KEY:"setLisHotKey",UPDATE_NEW_TEST_SET:"updateNewTestSet",UPDATE_EXEC_TEST_TYPE:"updateExecTestType",INITIALIZE_MOUNT_CNT:"initializeMountCnt",UPDATE_MOUNT_CNT:"updateMountCnt",GET_CURRENT_USER:"getCurrentUser",GET_SETTINGS:"getSettings",UPDATE_RUNNING_PATH:"updateRunningPath",UPDATE_RESULT_PATH_WBC:"updateResultPathWbc",UPDATE_RESULT_PATH_RBC:"updateResultPathRbc",UPDATE_BARCODE_PATH:"updateBarcodePath",GET_SYSTEM_TIME_ID:"getSystemTimeId",SET_SYSTEM_TIME_ID:"setSystemTimeId",GET_USER:"getUser",UPDATE_REMEMBER_STATE:"updateRememberState",SET_CURRENT_USER:"setCurrentUser",UPDATE_ROOT_PATH:"updateRootPath",GET_FILE_FILTER:"getFileFilter",GET_USER_LIST:"getUserList",UPDATE_ANALYSIS_TYPE:"updateAnalysisType",UPDATE_TEST_TYPE:"updateTestType",UPDATE_RUNNING_MODE:"updateRunningMode",UPDATE_USER:"updateUser",DELETE_USER:"deleteUser",UPDATE_MARKER_STATE:"updateMarkerState",GET_MARKER_STATE:"getMarkerState",SET_PAUSE_STATE:"setPauseState",GET_PAUSE_STATE:"getPauseState",GET_BF_WHOLE_SLIDE_PATH:"getBfWholeSlidePath",GET_BF_WBC_CLASS_LIST:"getBfWbcClassList",GET_SIZE_SLIDE_VALUE:"getSizeSlideValue",UPDATE_LIS_CODE:"updateLisCode",SELECT_LIS_CODE:"selectLisCode",SELECT_LIS_CODE_RBC:"selectLisCodeRbc",UPDATE_CBC_CODE:"updateCbcCode",SELECT_CBC_CODE:"selectCbcCode",UPDATE_LIS_CONN_PATH:"updateLisConnPath",SELECT_LIS_CONN_PATH:"selectLisConnPath",GET_BACKUP_LIST:"getBackupList",RESTORE_BACKUP_DATA:"restoreBackupData",DELETE_BACKUP_DATA:"deleteBackupData",RESET_RBC_DEGREE:"resetRbcDegree",GET_DEFAULT_RBC_DEGREE:"getDefaultRbcDegree",UPDATE_CHECKED_CELL:"updateCheckedCell",SET_LOCK_SLIDE:"setLockSlide",SET_HOST_IP:"setHostIp",GET_HOST_IP:"getHostIp",GET_NORMAL_RANGE:"getNormalRange",UPDATE_NORMAL_RANGE:"updateNormalRange",GET_LOCK_STATE:"getLockState",GET_KUMC_CBC_PATH:"getKumcCbcPath",SET_WBC_NORMAL_RANGE:"setWbcNormalRange",GET_WBC_NORMAL_RANGE:"getWbcNormalRange",GET_SKMC_RESULT_CD:"getSkmcResultCd",SET_SKMC_RESULT_CD:"setSkmcResultCd",REMOVE_SKMC_RESULT_CD:"removeSkmcResultCd",GET_SKMC_REMARK:"getSkmcRemark",SET_SKMC_REMARK:"setSkmcRemark",REMOVE_SKMC_REMARK:"removeSkmcRemark",SET_SKMC_FAVORITE:"setSkmcFavorite",GET_SKMC_FAVORITE:"getSkmcFavorite",GET_SKMC_LIS_RESULTS:"getSkmcLisResults",SET_SKMC_LIS_RESULTS:"setSkmcLisResults",SET_ALARM_COUNT:"setAlarmCount",SET_SORT_TYPE:"setSortType",GET_SORT_TYPE:"getSortType",SET_CUSTOM_CLASS:"setCustomClass",GET_CUSTOM_CLASS:"getCustomClass",SET_SYS_INFO:"setSysInfo",GET_SYS_INFO:"getSysInfo",SET_BACKEND_DATA:"setBackendData",GET_BACKEND_DATA:"getBackendData",SELECT_CBC_CODE_INHA:"selectCbcCodeInha",SELECT_LIS_CODE_INHA:"selectLisCodeInha",SELECT_LIS_CODE_RBC_INHA:"selectLisCodeRbcInha",SELECT_LIS_CONN_PATH_INHA:"selectLisConnPathInha",GET_RBC_COUNT_INHA:"getRbcCountInha",SELECT_WBC_RUNNING_COUNT:"selectWbcRunningCount",GET_BRIGHTNESS_SLIDE_VALUE:"getBrightnessSlideValue",GET_RED_VALUE:"getRedValue",GET_GREEN_VALUE:"getGreenValue",GET_BLUE_VALUE:"getBlueValue",GET_RGB_VALUE:"getRgbValue",SET_SIZE_SLIDE_VALUE:"setSizeSlideValue",SET_BRIGHTNESS_SLIDE_VALUE:"setBrightnessSlideValue",SET_RED_VALUE:"setRedValue",SET_GREEN_VALUE:"setGreenValue",SET_BLUE_VALUE:"setBlueValue",SET_RGB_VALUE:"setRgbValue",SET_ROLLBACK_LIST:"setRollbackList",GET_ROLLBACK_LIST:"getRollbackList",GET_IMAGE_ROLLBACK_LIST:"getImageRollbackList",SET_CLONED_WBC_INFO:"setClonedWbcInfo",GET_RBC_BRIGHTNESS_SLIDE_VALUE:"getRbcBrightnessSlideValue",GET_RBC_RED_VALUE:"getRbcRedValue",GET_RBC_GREEN_VALUE:"getRbcGreenValue",GET_RBC_BLUE_VALUE:"getRbcBlueValue",SET_RBC_BRIGHTNESS_SLIDE_VALUE:"setRbcBrightnessSlideValue",SET_RBC_RED_VALUE:"setRbcRedValue",SET_RBC_GREEN_VALUE:"setRbcGreenValue",SET_RBC_BLUE_VALUE:"setRbcBlueValue",SET_CLONED_RBC_INFO:"setClonedRbcInfo",UPDATE_OIL_COUNT:"updateOilCount",SET_RESULT_LIST:"setResultList",CLEAR_RESULT_LIST:"clearResultList",GET_RESULT_LIST:"getResultList",SET_WBC_REPORT_PRINT:"setWbcReportPrint",GET_WBC_REPORT_PRINT:"getWbcReportPrint",SET_RBC_REPORT_PRINT:"setRbcReportPrint",GET_RBC_REPORT_PRINT:"getRbcReportPrint",SET_RBC_SIZE:"setRbcSize",GET_RBC_SIZE:"getRbcSize",SET_RBC_CHROMIA:"setRbcChromia",GET_RBC_CHROMIA:"getRbcChromia",SET_RBC_SHAPE:"setRbcShape",GET_RBC_SHAPE:"getRbcShape",PUSH_RBC_SHAPE:"pushRbcShape",POP_RBC_SHAPE:"popRbcShape",SET_RBC_PLATELET:"setRbcPlatelet",GET_RBC_PLATELET:"getRbcPlatelet",PUSH_RBC_PLATELET:"pushRbcPlatelet",POP_RBC_PLATELET:"popRbcPlatelet",SET_RBC_INCLUSION:"setRbcInclusion",GET_RBC_INCLUSION:"getRbcInclusion",POP_RBC_INCLUSION:"popRbcInclusion",PUSH_RBC_INCLUSION:"pushRbcInclusion",SET_IS_SHOW_MODAL_BARCODE:"setIsShowModalBarcode",GET_IS_SHOW_MODAL_BARCODE:"getIsShowModalBarcode",SET_IS_NS_NB_INTEGRATION:"setIsNsNbIntegration",GET_IS_NS_NB_INTEGRATION:"getIsNsNbIntegration",SET_IS_ALARM:"setIsAlarm",GET_IS_ALARM:"getIsAlarm",SET_IS_CBC_SHOW:"setIsCbcShow",GET_IS_CBC_SHOW:"getIsCbcShow",SET_SITE_CD:"setSiteCd",GET_SITE_CD:"getSiteCd",SET_DEVICE_SERIALNUM:"setDeviceSerialNm",GET_DEVICE_SERIALNUM:"getDeviceSerialNm",SELECT_BF_HOT_KEY:"selectBfHotKey",SELECT_WBC_HOT_KEY:"selectWbcHotKey",SELECT_WBC_CUSTOM_CLASS:"selectWbcCustomClass",SELECT_EMP_NO:"selectEmpNo",INSERT_WBC_MODIFY_HIST:"insetWbcModifyHist",GET_WBC_MODIFY_HIST:"getWbcModifyHist",UPDATE_WBC_HIST_LIST:"updateWbcHistList",GET_WBC_HIST_LIST:"getWbcHistList",GET_COMMON_CODE_LIST:"getCommonCodeList",GET_COMMON_CODE:"getCommonCode",GET_CODE_LIST_USER_POSITION:"00",GET_CODE_LIST_USER_AUTHORIZATION:"01",GET_CODE_LIST_USER_CASSETE_STATE:"02",GET_CODE_LIST_PROCESSING_STATE:"03",GET_CODE_LIST_ANALYSIS_TYPE:"04",GET_CODE_LIST_CELL_COUNT:"05",GET_CODE_LIST_GENERAL_STAIN:"06",GET_CODE_LIST_SPECIAL_STAIN:"07",GET_CODE_LIST_IMMUNO_STAIN:"08",GET_CODE_LIST_SAMPLING_STAIN:"09",GET_CODE_LIST_GENDER:"10",GET_CODE_LIST_TEST_TYPE:"11",GET_CODE_SIGNED_STATE:"12",GET_CODE_LOG_TYPE:"13",GET_CODE_SLOT_STATE:"14",EVENT_TYPE_USER:"00",EVENT_TYPE_SYSTEM:"01",SET_EVENT_LOG:"setEventLog",GET_EVENT_LOG:"getEventLog",REMOVE_EVENT_LOG:"removeEventLog",REMEMBER_PWD_KEY:"uimdia190$^!00000000000000000000",REMEMBER_PWD_IV:"0000000000000000",RECEIVE_DATA_BROADCAST_CHAN:"RECEIVE_DATA_BROADCAST_CHAN",GET_PB_CLASSIFICATIONS:"getPbClassifications",GET_CLASSIFICATION_IMAGES:"getClassificationImages",GET_MARKER_POSITION:"getMarkerPosition",GET_PB_HOT_KEYS:"getPbHotKeys",UPDATE_CLASSIFICATION:"updateClassification",PB_IA_MOVE_IMAGE:"PbIaMoveImage",SET_WBC_IMAGE_LIST:"setWbcImageList",GET_PB_WBC_IMAGES:"getPbWbcImages",SET_SELECTED_ITEM:"setSelectedItem",GET_SELECTED_ITEM:"getSelectedItem",IA_SET_CUSTOM_CLASS:"iaSetCustomClass",IA_GET_CUSTOM_CLASS:"iaGetCustomClass",IDS_MSG_SUCCESS:"Success",IDS_MSG_FAILED:"Failed",IDS_MSG_OIL_REMAIN_COUNTER:"Reset Immersion oil counter after final test or changing the Oil",IDS_MSG_POWEROFF:"Shutdown the system.",IDS_MSG_INITALIZE:"Please execute after initialization.",IDS_MSG_SIGNING_COMPLETE:"Signing is complete.",IDS_MSG_DELETE_THE_SELECTED_ITEMS:"Delete the selected items?",IDS_MSG_ACCOUNT_CHANGED:"Account conversion is complete.",IDS_MSG_DELETE_ACCOUNT:"Are you sure you want to delete your account?",IDS_MSG_LOGOUT:"Are you sure you want to logout now?",IDS_MSG_DUPLICATE_KEY:"The %s key is a duplicate key.",IDS_MSG_HOTKEY_IN_ENGLISH:"Please recheck the key",IDS_ERROR_CHECK_ID:"The ID must be 5-20 letters or numbers starting with the alphabet.",IDS_ERROR_CHECK_PASSWORD:"The password is a combination of 6-30 digits in English, numbers.",IDS_ERROR_NOT_MATCHED_PASSWORD:"Passwords do not match.",IDS_ERROR_SIGINUP:"Please check the input field.",IDS_ERROR_SIGINUP_ALREADY_ID:"ID already registered.",IDS_ERROR_LOGIN_ERROR:"Please check your ID and password.",IDS_ERROR_LOGIN_ID:"Please check your Login ID.",IDS_ERROR_ALREADY_RUNNING:"Process is already running.",IDS_ERROR_STOP_PROCESS:"Process is terminating.",IDS_ERROR_INIT_ERROR:"Please initialize.",IDS_ERROR_CHECK_REQUIRED_FIELDS:"Please check required fields",IDS_ERROR_CHECK_SLOT_NO:"Please check the slot number.",IDS_ERROR_FAVORITE_MAX_REGIST:"Up to 5 favorites can be registered.",IDS_ERROR_FAVORITE_MAX_REGIST2:"Up to 12 favorites can be registered.",IDS_ERROR_ENTER_YOUR_ORDER_DETAILS:"Please enter your order details.",IDS_ERROR_SELECT_A_TARGET_ITEM:"Please select items",IDS_ERROR_PLEASE_SELECT_AN_IMAGE:"Please select an image.",IDS_ERROR_ALREADY_ADDED:"This item has already been added.",IDS_ERROR_ADD_A_WORKLIST:"Please add a worklist",IDS_ERROR_NO_TEST_RESULTS:"There are no test results.",IDS_ERROR_FILE_CLISSIFICATION:"File classification error",IDS_ERROR_ENTER_CLASS_INFO:"Please enter class information",IDS_ERROR_PLEASE_CONFIRM_YOUR_USER_ID:"Please confirm your user ID.",IDS_DOWNLOAD_COMPLETE:"Download Complete",IDS_SELECT_SLIDE:"Please select a slide.",IDS_SIGNED_ITEMS_CANNOT_BE_MODIFIED:"Signed items cannot be modified.",IDS_RECOVER_GRIPPER_CONDITION:"Would you like to recover the gripper condition?",IDS_PLEASE_ENTER_END_DATE:"Please enter the end date.",IDS_PLEASE_ENTER_START_DATE:"Please enter the start date.",IDS_THE_MAXIMUM_INQUIRY_DATE_IS_31_DAYS:"The maximum inquiry date is 31 days.",IDS_START_DATE_IS_NOT_GREATER_THEN_END_DATE:"Start date is not greater than end date.",IDS_RESTART_SYSTEM:"A new version has been downloaded. Please restart the application to apply the update.",IDS_PLEASE_ENTER_YOUR_BARCODE_NUMBER:"Please enter your barcode number",IDS_BARCODE_REGISTRATION_SUCCESSFUL:"Barcode registration successful",IDS_THIS_IS_A_DUPLICATION_ABBREVIATION:"This is a duplicate abbreviation.",IDS_THIS_CARD_HAS_ALREADY_BEEN_USED:"This card has already been used.",IDS_MSG_UPLOAD_LIS:"Upload current results to LIS",IDS_MSG_SUBMIT_SLIDE:"Submit slide",IDS_MSG_CONFIRM_SLIDE:"Confirm slide",IDS_PLEASE_SELECT_A_CLASS:"Please select a class",IDS_PLEASE_SELECT_A_BACKUP_DATE:"Please select a backup date.",IDS_PLEASE_SELECT_A_BACKUP_PATH:"Please select a backup path.",IDS_PLEASE_SELECT_A_BACKUP_FILE:"Please select a backup file.",IDS_NO_DATA_FOUND:"No data found.",IDS_MSG_DATA_BACKUP:"Data from that period will be deleted. Would you like to proceed?",IDS_MSG_DATA_RESTORE:"Do you want to recover your data?",IDS_MSG_SIZE_CHROMIA_LINKED_LIS:"Size and Chromia categories are linked with LIS data.",UPLOAD_PLEASE_LIS:"To upload the LIS, please enter the content in the LIS File Path field under the LIS(CBC) Hot Key & File Path tab in the settings page and save it.",UPLOAD_PLEASE_CBC:"To load CBC, please enter the content in the CBC File Path field under the LIS(CBC) Hot Key & File Path tab in the settings page and save it.",UPDATE_SUCCESSFULLY:"Update Successfully",TCP_DiSCONNECTED:"The TCP connection was disconnected.",alreadyInitialized:"It has already been initialized.",lockRow:"Deletion is not allowed when locked.",exit:"Are you sure you want to quit the program?",settingSaveSuccess:"Saved successfully",settingSaveFailure:"Save failed",settingUpdateSuccess:"Updated successfully",settingUpdateFailure:"Update failed",settingNotSaved:"Setting not saved",SAVE:"Save",LEAVE:"Leave",CANCEL:"Cancel",CLOSE:"Close",COPY:"Copy",MOVE:"Move",DELETE:"Delete",UPLOAD:"Upload",OK:"Ok",SETTING_INFO_DOWNLOAD_SAVE_PATH_EN:"Destination path for download and Origin path for upload",SETTING_INFO_DOWNLOAD_SAVE_PATH_KO:"다운로드 시 저장 경로 & 업로드 시 백업 파일 경로",SETTING_INFO_UPLOAD_EN:"",SETTING_INFO_UPLOAD_KO:"Download Save Path에서 업로드할 폴더 선택 & 데이터 업로드 폴더 경로 선택",SETTING_INFO_DOWNLOAD_EN:"",SETTING_INFO_DOWNLOAD_KO:"다운로드 받을 날짜 선택 & copy: 다른 컴퓨터로 이동시킬때 사용(데이터 복사)",SETTING_INFO_KEEP_PAGE_EN:"Keep page when moving in Database detail page by up, down arrows",SETTING_INFO_KEEP_PAGE_KO:"데이터베이스 상세 페이지에서 좌측 하단 위, 아래 화살표를 사용하여 검체 이동할 때 탭 유지",SETTING_INFO_ALARM_TIME_EN:"",SETTING_INFO_ALARM_TIME_KO:"알람 켜기/끄기 & 타이머(초) 선택",SETTING_INFO_NS_NB_INTEGRATION_EN:"",SETTING_INFO_NS_NB_INTEGRATION_KO:"ON일 경우 Neutrophil-Segment, Neutrophil-Band 를 Neutrophil로 합쳐서 검사",SETTING_INFO_IA_ROOT_PATH_EN:"",SETTING_INFO_IA_ROOT_PATH_KO:"검체 데이터 저장 경로 및 다운로드 진행 시 시작 경로",SETTING_INFO_COMMON:"",SETTING_INFO_BF_ANALYSIS_VALUES:"",SETTING_INFO_PBS_ANALYSIS_VALUES:"",SETTING_INFO_WBC_DIFF_ANALYSIS_VALUES:"",SETTING_INFO_ANALYSIS_TYPE:""};var H=a(5093),V=a.n(H);a(4743);function j(){const e=V()(),t=e.format("YYYYMMDDHHmm");return t}const Y=e=>{if(!e)return null;const t=V()(e,"YYYYMMDDHHmmssSSSSS");return t.format("YYYY-MM-DD HH:mm:ss")},q=e=>{const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=Math.floor(e%3600%60);return`${Q(t,2)}:${Q(a,2)}:${Q(l,2)}`},Q=(e,t)=>String(e).padStart(t,"0"),J=e=>{const t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0");return`${t}-${a}-${l}`},z=()=>{const e=j();return{embedStatus:{start:{jobCmd:"START",reqUserId:"",testType:"",wbcCount:"",reqDttm:e},startAction:{jobCmd:"START",reqUserId:"",testType:"01",wbcCount:"",stitchCount:"",runningMode:"00",positionMargin:"0",wbcPositionMargin:"0",pltPositionMargin:"0",reqDttm:e},init:{jobCmd:"INIT",reqUserId:"",reqDttm:e},restart:{jobCmd:"RESTART",reqUserId:"",reqDttm:e,bfSelectFiles:[]},stop:{jobCmd:"STOP",reqUserId:"",reqDttm:e,isEmergency:"N",isUserStop:"Y"},end:{jobCmd:"END",reqUserId:"",testType:"",wbcCount:"",reqDttm:e},runningInfo:{jobCmd:"RUNNING_INFO",reqUserId:"",reqDttm:e},sysInfo:{jobCmd:"SYSINFO",reqUserId:"",reqDttm:e},pause:{jobCmd:"PAUSE",reqUserId:"",reqDttm:e},runIngComp:{jobCmd:"RUNNING_COMP",reqUserId:"",reqDttm:e},recovery:{jobCmd:"RECOVERY",reqUserId:"",reqDttm:e},settings:{jobCmd:"SETTINGS",reqUserId:"",reqDttm:e,pbiaRootDir:"D:/IA_Proc",oilCount:"",isOilReset:"",deviceType:"01",isNsNbIntegration:""},oilPrime:{jobCmd:"OIL_PRIME",reqUserId:"",reqDttm:e},gripperOpen:{jobCmd:"GRIPPER_OPEN",reqUserId:"",reqDttm:e},cameraReset:{jobCmd:"CAMERA_RESET",reqUserId:"",reqDttm:e},exit:{jobCmd:"clientExit",reqUserId:"",reqDttm:e},searchCardCount:{jobCmd:"SEARCH_CARD_COUNT",reqUserId:"",reqDttm:e,testType:""}}}};var Z=a(4335);function ee(){let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const t=async(e,t,l,s)=>a(e.endpoint,t,l),a=async(t,a,l,s)=>{const o={headers:{"Content-Type":"application/json","Cache-Control":"public, max-age=3600"}};Z.A.defaults.withCredentials=!0;const n=a?l?"?":"/":"";a=a||"","viewer"===s&&(e=window.MAIN_API_IP);try{const l=await Z.A.get(`${e}/${t}${n}${a}`,o);return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},l=async(e,t,a,l=!1,o)=>s(e.endpoint,t,a,l,o),s=async(t,a,l,s=!1,o)=>{const n={headers:{"Content-Type":"application/json"}};"blob"===l&&(n.responseType="blob"),"text/plain"===l&&(n.headers={"Content-Type":"text/plain"}),s&&(n.headers={"Content-Type":"multipart/form-data"}),Z.A.defaults.withCredentials=!0,"viewer"===o&&(e=window.MAIN_API_IP);try{const l=await Z.A.post(`${e}/${t}`,a,n);return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},o=async(e,t,a,l)=>n(e.endpoint,t,a,l),n=async(t,a,l,s)=>{const o={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}};Z.A.defaults.withCredentials=!0;const n=l?s?"?":"/":"";l=l||"";try{const s=await Z.A.put(`${e}/${t}${n}${l}`,a,o);return Promise.resolve(s.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},i=async(e,t,a)=>r(e.endpoint,t,a),r=async(t,a,l)=>{const s={headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}};Z.A.defaults.withCredentials=!0;const o=l?"?":"/";try{const l=await Z.A.delete(`${e}/${t}${o}`,{...s,data:a});return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(n){return Promise.reject(n)}};return{httpGet:t,httpGetAct:a,httpPost:l,httpPostAct:s,httpPut:o,httpPutAct:n,httpDelete:i,httpDeleteAct:r}}const te={auth:{refresh:{endpoint:"/auth/refresh",requiresToken:!1}},processInfo:{list:{endpoint:"proinfo/getAllProcessInfo",requiresToken:!1}},rbcclassification:{list:{endpoint:"rbc/getAllRbc",requiresToken:!1}},wbcclassification:{list:{endpoint:"wbc/getAllWbc",requiresToken:!1}},user:{register:{endpoint:"user/register",requiresToken:!1},login:{endpoint:"user/login",requiresToken:!1},logout:{endpoint:"user/logout",requiresToken:!1},userCheck:{endpoint:"user",requiresToken:!1},getUsers:{endpoint:"user/getUsers",requiresToken:!1},userDataPut:{endpoint:"user/update",requiresToken:!1},deleteUser:{endpoint:"user/delete",requiresToken:!1}},settings:{cellImgAnalyzedPost:{cellImgAdd:{endpoint:"cellImgAnalyzed/cellImgAdd",requiresToken:!1},cellImgGet:{endpoint:"cellImgAnalyzed",requiresToken:!1},cellImgPut:{endpoint:"cellImgAnalyzed/update",requiresToken:!1}},rbcDegree:{rbcDegreeAdd:{endpoint:"rbcDegree/rbcDegreeAdd",requiresToken:!1},rbcDegree:{endpoint:"rbcDegree",requiresToken:!1}},wbcCustomClass:{create:{endpoint:"wbcCustomClass/create",requiresToken:!1},update:{endpoint:"wbcCustomClass/update",requiresToken:!1},get:{endpoint:"wbcCustomClass/get",requiresToken:!1}},wbcHotKeys:{create:{endpoint:"wbcHotKeys/create",requiresToken:!1},update:{endpoint:"wbcHotKeys/update",requiresToken:!1},get:{endpoint:"wbcHotKeys/get",requiresToken:!1}},bfHotKeys:{create:{endpoint:"bfHotKeys/create",requiresToken:!1},update:{endpoint:"bfHotKeys/update",requiresToken:!1},get:{endpoint:"bfHotKeys/get",requiresToken:!1}},normalRange:{create:{endpoint:"normalRange/create",requiresToken:!1},update:{endpoint:"normalRange/update",requiresToken:!1},get:{endpoint:"normalRange/get",requiresToken:!1}},imagePrint:{create:{endpoint:"imagePrint/create",requiresToken:!1},update:{endpoint:"imagePrint/update",requiresToken:!1},get:{endpoint:"imagePrint/get",requiresToken:!1}},lisCode:{create:{endpoint:"lisCode/create",requiresToken:!1},update:{endpoint:"lisCode/update",requiresToken:!1},get:{endpoint:"lisCode/get",requiresToken:!1}},lisCodeRbc:{create:{endpoint:"lisCodeRbc/create",requiresToken:!1},update:{endpoint:"lisCodeRbc/update",requiresToken:!1},get:{endpoint:"lisCodeRbc/get",requiresToken:!1}},cbcCode:{create:{endpoint:"cbcCode/create",requiresToken:!1},update:{endpoint:"cbcCode/update",requiresToken:!1},get:{endpoint:"cbcCode/get",requiresToken:!1}},filePathSet:{create:{endpoint:"filePathSet/create",requiresToken:!1},update:{endpoint:"filePathSet/update",requiresToken:!1},get:{endpoint:"filePathSet/get",requiresToken:!1}},runCount:{create:{endpoint:"runCount/create",requiresToken:!1},update:{endpoint:"runCount/update",requiresToken:!1},get:{endpoint:"runCount/get",requiresToken:!1}},minCount:{create:{endpoint:"minCount/create",requiresToken:!1},update:{endpoint:"minCount/update",requiresToken:!1},get:{endpoint:"minCount/get",requiresToken:!1}},runningInfo:{create:{endpoint:"runningInfo/create",requiresToken:!1},update:{endpoint:"runningInfo/update",requiresToken:!1},get:{endpoint:"runningInfo/getAll",requiresToken:!1},delete:{endpoint:"runningInfo/delete",requiresToken:!1},detail:{endpoint:"runningInfo/detail",requiresToken:!1},classInfoDetail:{endpoint:"runningInfo/classInfoDetail",requiresToken:!1},classInfoDetailSelectQuery:{endpoint:"runningInfo/classInfoDetailSelectQuery",requiresToken:!1},classInfoMenuDetailSelectQuery:{endpoint:"runningInfo/classInfoMenuDetailSelectQuery",requiresToken:!1},pageUpDown:{endpoint:"runningInfo/pageUpDown",requiresToken:!1},updatePcIpState:{endpoint:"runningInfo/updatePcIpState",requiresToken:!1},clearPcIpState:{endpoint:"runningInfo/clearPcIpState",requiresToken:!1},removePageAllData:{endpoint:"runningInfo/removePageAllData",requiresToken:!1}},folder:{get:{endpoint:"folder/drives",requiresToken:!1}},folders:{get:{endpoint:"folders",requiresToken:!1}},classOrder:{create:{endpoint:"classOrders/create",requiresToken:!1},update:{endpoint:"classOrders/update",requiresToken:!1},get:{endpoint:"classOrders/get",requiresToken:!1}},remainingCount:{get:{endpoint:"remaining-count/execute",requiresToken:!1}},qualityCheck:{get:{endpoint:"qualityCheck/execute",requiresToken:!1}}},images:{move:{endpoint:"images/move",requiresToken:!1},moveClassImage:{endpoint:"images/moveClassImage",requiresToken:!1}},jsonReader:{get:{endpoint:"jsonReader/send",requiresToken:!1},jsonCreate:{endpoint:"jsonReader/upload",requiresToken:!1}},dziReader:{get:{endpoint:"dzi/send",requiresToken:!1}},pdf:{post:{endpoint:"pdf/generate",requiresToken:!1}},filesystem:{post:{endpoint:"filesystem/create-folder",requiresToken:!1},delete:{endpoint:"filesystem/delete-folder",requiresToken:!1},readGetJpg:{endpoint:"file/check-file-exists",requiresToken:!1},createDirectory:{endpoint:"file/create-directory",requiresToken:!1},fileCreate:{endpoint:"file/createFile",requiresToken:!1},cbcSaveData:{endpoint:"file/cbcSaveData",requiresToken:!1}},fileTxtRead:{get:{endpoint:"file/read",requiresToken:!1}},H7Read:{post:{endpoint:"hl7/parse",requiresToken:!1}},H7Message:{post:{endpoint:"hl7/message",requiresToken:!1}},Hl7Create:{post:{endpoint:"hl7/hl7Create",requiresToken:!1}},device:{getDeviceInfo:{create:{endpoint:"device/create",requiresToken:!1},get:{endpoint:"device/get",requiresToken:!1},ip:{endpoint:"ip",requiresToken:!1}}},download:{backUpDate:{endpoint:"download/post",requiresToken:!1},checkIsPossibleToBackup:{endpoint:"download/check",requiresToken:!1},openDrive:{endpoint:"download/openDrive",requiresToken:!1}},upload:{restoreData:{endpoint:"upload/execute",requiresToken:!1},checkDuplicated:{endpoint:"upload/checkDuplicatedData",requiresToken:!1},checkPossibleUploadFile:{endpoint:"upload/checkPossibleUploadFile",requiresToken:!1}},excel:{execute:{endpoint:"excel/execute",requiresToken:!1}},browser:{exit:{endpoint:"browser/close-edge",requiresToken:!1}},img:{checkImageExists:{endpoint:"images/checkImageExists",requiresToken:!1}}},ae=ee(),le=async e=>ae.httpPost(te.settings.cellImgAnalyzedPost.cellImgAdd,e),se=async()=>ae.httpGet(te.settings.cellImgAnalyzedPost.cellImgGet),oe=async(e,t)=>ae.httpPut(te.settings.cellImgAnalyzedPost.cellImgPut,e,t),ne=async e=>ae.httpPost(te.settings.rbcDegree.rbcDegreeAdd,e),ie=async e=>ae.httpPut(te.settings.rbcDegree.rbcDegree,e),re=async()=>ae.httpGet(te.settings.rbcDegree.rbcDegree),ce=async e=>ae.httpPost(te.settings.wbcCustomClass.create,e),ue=async e=>ae.httpPut(te.settings.wbcCustomClass.update,e),de=async()=>ae.httpGet(te.settings.wbcCustomClass.get),me=async e=>ae.httpPost(te.settings.wbcHotKeys.create,e),ve=async e=>ae.httpPut(te.settings.wbcHotKeys.update,e),pe=async()=>ae.httpGet(te.settings.wbcHotKeys.get),ge=async e=>ae.httpPost(te.settings.bfHotKeys.create,e),fe=async e=>ae.httpPut(te.settings.bfHotKeys.update,e),Ie=async()=>ae.httpGet(te.settings.bfHotKeys.get),ye=async e=>ae.httpPost(te.settings.normalRange.create,e),be=async e=>ae.httpPut(te.settings.normalRange.update,e),Ce=async()=>ae.httpGet(te.settings.normalRange.get),he=async e=>ae.httpPost(te.settings.imagePrint.create,e),Se=async e=>ae.httpPut(te.settings.imagePrint.update,e),ke=async()=>ae.httpGet(te.settings.imagePrint.get),Ne=async e=>ae.httpPost(te.settings.lisCode.create,e),_e=async e=>ae.httpPut(te.settings.lisCode.update,e),Ee=async()=>ae.httpGet(te.settings.lisCode.get),we=async e=>ae.httpPost(te.settings.lisCodeRbc.create,e),Re=async e=>ae.httpPut(te.settings.lisCodeRbc.update,e),Le=async()=>ae.httpGet(te.settings.lisCodeRbc.get),Te=async e=>ae.httpPost(te.settings.cbcCode.create,e),Pe=async e=>ae.httpPut(te.settings.cbcCode.update,e),Ae=async()=>ae.httpGet(te.settings.cbcCode.get),De=async e=>ae.httpPost(te.settings.filePathSet.create,e),Me=async e=>ae.httpPut(te.settings.filePathSet.update,e),xe=async()=>ae.httpGet(te.settings.filePathSet.get),Ke=async e=>ae.httpPost(te.settings.runCount.create,e),Oe=async e=>ae.httpPut(te.settings.runCount.update,e),Be=async()=>ae.httpGet(te.settings.runCount.get),Fe=async e=>ae.httpPost(te.settings.minCount.create,e),Ue=async e=>ae.httpPut(te.settings.minCount.update,e),$e=async()=>ae.httpGet(te.settings.minCount.get),We=async()=>ae.httpGet(te.settings.lisCode.get),Xe=async()=>ae.httpGet(te.settings.folder.get),Ge=async e=>ae.httpPost(te.settings.classOrder.create,e),He=async()=>ae.httpGet(te.settings.classOrder.get),Ve=async e=>ae.httpPut(te.settings.classOrder.update,e),je=async()=>ae.httpGet(te.settings.remainingCount.get),Ye=async()=>ae.httpGet(te.settings.qualityCheck.get);var qe=a(3772);class Qe{constructor(){(0,qe.A)(this,"events",{})}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}publish(e,...t){const a=this.events[e];a&&a.forEach((e=>e(...t)))}unsubscribe(e,t){const a=this.events[e];a&&(this.events[e]=a.filter((e=>e!==t)))}}var Je=new Qe;const ze={key:0},Ze={class:"mb1 alertMessage"};var et={__name:"Alert",props:["isVisible","type","message"],emits:["update:hideAlert"],setup(e,{emit:t}){const a=e,l=(0,s.EW)((()=>`alert-${a.type}`)),o=t,i=()=>{o("hide")};return(t,o)=>{const r=(0,s.g2)("font-awesome-icon");return e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["alert",l.value])},["error"===a.type?((0,s.uX)(),(0,s.CE)("p",ze,[(0,s.bF)(r,{icon:["fas","circle-exclamation"],class:"bigFont"})])):(0,s.Q3)("",!0),(0,s.Lk)("p",Ze,(0,n.v_)(e.message),1),(0,s.Lk)("button",{class:"alertButton",onClick:i},"Close")],2)):(0,s.Q3)("",!0)}}};const tt=et;var at=tt;const lt=[{value:"01",text:"WBC Diff(Standard)"},{value:"04",text:"PBS(Premium)"}],st=[{value:"02",text:"BM wedge"},{value:"06",text:"BM squash"},{value:"03",text:"Touch print"},{value:"04",text:"BM biopsy"},{value:"05",text:"Clot section"}],ot=[{value:"100",text:"100"},{value:"150",text:"150"},{value:"200",text:"200"},{value:"250",text:"250"},{value:"300",text:"300"},{value:"350",text:"350"},{value:"400",text:"400"},{value:"450",text:"450"},{value:"500",text:"500"}],nt=[{value:"100",text:"100"},{value:"200",text:"200"},{value:"300",text:"300"},{value:"400",text:"400"},{value:"500",text:"500"},{value:"600",text:"600"},{value:"700",text:"700"},{value:"800",text:"800"},{value:"900",text:"900"},{value:"1000",text:"1000"},{value:"1100",text:"1100"},{value:"1200",text:"1200"},{value:"1300",text:"1300"},{value:"1400",text:"1400"},{value:"1500",text:"1500"}],it=[{value:"50",text:"50"},{value:"100",text:"100"},{value:"150",text:"150"},{value:"200",text:"200"},{value:"250",text:"250"},{value:"300",text:"300"},{value:"350",text:"350"},{value:"400",text:"400"},{value:"450",text:"450"},{value:"500",text:"500"}],rt=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],ct=[{value:"0",text:"None"},{value:"1",text:"Smear Top"},{value:"2",text:"Smear Top + Side"}],ut=[{value:"0",text:"0"},{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],dt=[{value:"0",text:"0"},{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],mt=[{cd:"01",classCd:"diff",fullNm:"WBC Diff. Count",isSelected:!0},{cd:"02",classCd:"seg",fullNm:"Seg.-neutrophils",isSelected:!0},{cd:"03",classCd:"band",fullNm:"Band-neutrophils",isSelected:!0},{cd:"04",classCd:"",fullNm:"Lymphocytes",isSelected:!0},{cd:"05",classCd:"",fullNm:"Monocytes",isSelected:!0},{cd:"06",classCd:"",fullNm:"Eosinophils",isSelected:!0},{cd:"07",classCd:"",fullNm:"Basophils",isSelected:!0},{cd:"08",classCd:"",fullNm:"Metamyelocytes",isSelected:!0},{cd:"09",classCd:"",fullNm:"Myelocytes",isSelected:!0},{cd:"10",classCd:"",fullNm:"Promyelocytes",isSelected:!0},{cd:"11",classCd:"",fullNm:"Blasts",isSelected:!0},{cd:"12",classCd:"",fullNm:"Immature cells",isSelected:!0},{cd:"13",classCd:"",fullNm:"Atypical cells",isSelected:!0},{cd:"14",classCd:"",fullNm:"Atypical lymphocyte",isSelected:!0},{cd:"15",classCd:"",fullNm:"Activated lymphocyte",isSelected:!0},{cd:"16",classCd:"",fullNm:"Prolymphocytes",isSelected:!0},{cd:"17",classCd:"",fullNm:"Promonocytes",isSelected:!0},{cd:"18",classCd:"",fullNm:"Plasma cells",isSelected:!0},{cd:"19",classCd:"",fullNm:"Nucleated RBC",isSelected:!0},{cd:"20",classCd:"",fullNm:"Others",isSelected:!0},{cd:"21",classCd:"",fullNm:"Atypical Lymphoid cells",isSelected:!0},{cd:"22",classCd:"",fullNm:"Leukemic cells",isSelected:!0},{cd:"23",classCd:"",fullNm:"Abnormal lymphocyte",isSelected:!0},{cd:"24",classCd:"",fullNm:"Reactive lymphocyte",isSelected:!0},{cd:"25",classCd:"",fullNm:"Plasmacytoid lymphocyte",isSelected:!0},{cd:"26",classCd:"",fullNm:"ANC calc",isSelected:!0},{cd:"27",classCd:"",fullNm:"WBC",isSelected:!0},{cd:"28",classCd:"",fullNm:"RBC",isSelected:!0},{cd:"29",classCd:"",fullNm:"HGB",isSelected:!0},{cd:"30",classCd:"",fullNm:"HCT",isSelected:!0},{cd:"31",classCd:"",fullNm:"MCV",isSelected:!0},{cd:"32",classCd:"",fullNm:"MCH",isSelected:!0},{cd:"33",classCd:"",fullNm:"MCHC",isSelected:!0},{cd:"34",classCd:"",fullNm:"RDW",isSelected:!0},{cd:"35",classCd:"",fullNm:"Platelet",isSelected:!0},{cd:"36",classCd:"",fullNm:"PCT",isSelected:!0},{cd:"37",classCd:"",fullNm:"MPV",isSelected:!0},{cd:"38",classCd:"",fullNm:"PDW",isSelected:!0},{cd:"39",classCd:"",fullNm:"ESR",isSelected:!0},{cd:"40",classCd:"",fullNm:"LUC",isSelected:!0}],vt=[{cd:"01",classCd:"diff",fullNm:"WBC Diff. Count",isSelected:!0},{cd:"02",classCd:"seg",fullNm:"Seg.-neutrophils",isSelected:!0},{cd:"03",classCd:"band",fullNm:"Band-neutrophils",isSelected:!0},{cd:"04",classCd:"",fullNm:"Lymphocytes",isSelected:!0},{cd:"05",classCd:"",fullNm:"Monocytes",isSelected:!0},{cd:"06",classCd:"",fullNm:"Eosinophils",isSelected:!0},{cd:"07",classCd:"",fullNm:"Basophils",isSelected:!0},{cd:"08",classCd:"",fullNm:"Metamyelocytes",isSelected:!0},{cd:"09",classCd:"",fullNm:"Myelocytes",isSelected:!0},{cd:"10",classCd:"",fullNm:"Promyelocytes",isSelected:!0},{cd:"11",classCd:"",fullNm:"Blasts",isSelected:!0},{cd:"12",classCd:"",fullNm:"Immature cells",isSelected:!0},{cd:"13",classCd:"",fullNm:"Atypical cells",isSelected:!0},{cd:"14",classCd:"",fullNm:"Atypical lymphocyte",isSelected:!0},{cd:"15",classCd:"",fullNm:"Activated lymphocyte",isSelected:!0},{cd:"16",classCd:"",fullNm:"Prolymphocytes",isSelected:!0},{cd:"17",classCd:"",fullNm:"Promonocytes",isSelected:!0},{cd:"18",classCd:"",fullNm:"Plasma cells",isSelected:!0},{cd:"19",classCd:"",fullNm:"Nucleated RBC",isSelected:!0},{cd:"20",classCd:"",fullNm:"Others",isSelected:!0},{cd:"21",classCd:"",fullNm:"Atypical Lymphoid cells",isSelected:!0},{cd:"22",classCd:"",fullNm:"Leukemic cells",isSelected:!0},{cd:"23",classCd:"",fullNm:"Abnormal lymphocyte",isSelected:!0},{cd:"24",classCd:"",fullNm:"Reactive lymphocyte",isSelected:!0},{cd:"25",classCd:"",fullNm:"Plasmacytoid lymphocyte",isSelected:!0},{cd:"26",classCd:"",fullNm:"ANC calc",isSelected:!0},{cd:"27",classCd:"",fullNm:"WBC",isSelected:!0},{cd:"28",classCd:"",fullNm:"RBC",isSelected:!0},{cd:"29",classCd:"",fullNm:"HGB",isSelected:!0},{cd:"30",classCd:"",fullNm:"HCT",isSelected:!0},{cd:"31",classCd:"",fullNm:"MCV",isSelected:!0},{cd:"32",classCd:"",fullNm:"MCH",isSelected:!0},{cd:"33",classCd:"",fullNm:"MCHC",isSelected:!0},{cd:"34",classCd:"",fullNm:"RDW",isSelected:!0},{cd:"35",classCd:"",fullNm:"Platelet",isSelected:!0},{cd:"36",classCd:"",fullNm:"PCT",isSelected:!0},{cd:"37",classCd:"",fullNm:"MPV",isSelected:!0},{cd:"38",classCd:"",fullNm:"PDW",isSelected:!0},{cd:"39",classCd:"",fullNm:"ESR",isSelected:!0}],pt={rbcClassList:[{categoryId:"01",categoryNm:"Size",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Macrocyte",degree:"0"},{classId:"03",classNm:"Microcyte",degree:"0"},{classId:"04",classNm:"Anisocytosis",degree:"0"}]},{categoryId:"02",categoryNm:"Chromia",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Hyperchromic",degree:"0"},{classId:"03",classNm:"Hypochromic",degree:"0"},{classId:"04",classNm:"Polychromia",degree:"0"}]},{categoryId:"03",categoryNm:"Shape",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Poikilocytosis",degree:"0"},{classId:"03",classNm:"Target Cell",degree:"0"},{classId:"04",classNm:"Burr Cell",degree:"0"},{classId:"05",classNm:"Acanthocyte",degree:"0"},{classId:"06",classNm:"Ovalocyte",degree:"0"},{classId:"07",classNm:"Schistocyte",degree:"0"},{classId:"08",classNm:"Sickle Cell",degree:"0"},{classId:"09",classNm:"Stomatocyte",degree:"0"},{classId:"10",classNm:"Tear Drop Cell",degree:"0"},{classId:"11",classNm:"Spherocyte",degree:"0"}]},{categoryId:"05",categoryNm:"Inclusion Body",classInfo:[{classId:"01",classNm:"Howell-Jolly Body",degree:"0"},{classId:"02",classNm:"Basophilic Stippling",degree:"0"}]}],malariaCount:0,currentRbcResults:null},gt=[{categoryId:"01",classId:"02",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"01",classId:"03",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"01",classId:"04",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"02",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"03",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"04",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"03",classId:"03",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"04",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"05",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"06",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"07",degree1:"0.5",degree2:"1",degree3:"2"},{categoryId:"03",classId:"08",degree1:"0.5",degree2:"1",degree3:"2"},{categoryId:"03",classId:"09",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"10",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"11",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"05",classId:"01",degree1:"1",degree2:"2",degree3:"3"},{categoryId:"05",classId:"02",degree1:"2.5",degree2:"5",degree3:"20"}],ft=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:10},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:11},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:12},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:13},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:14},{id:"12",abbreviation:"NR",fullNm:"nRBC",key:"",orderIdx:15},{id:"13",abbreviation:"GP",fullNm:"Giant platelet",key:"",orderIdx:16},{id:"14",abbreviation:"PA",fullNm:"Platelet aggregation",key:"",orderIdx:17},{id:"15",abbreviation:"AR",fullNm:"Artifact(Smudge)",key:"",orderIdx:19},{id:"16",abbreviation:"MA",fullNm:"Malaria",key:"",orderIdx:18},{id:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",key:"",orderIdx:8},{id:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:9},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3}],It=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:8},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:9},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:10},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:11},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:12},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:13},{id:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",key:"",orderIdx:14},{id:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",key:"",orderIdx:15},{id:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",key:"",orderIdx:16},{id:"15",abbreviation:"PE",fullNm:"Proerythroblast",key:"",orderIdx:17},{id:"16",abbreviation:"HC",fullNm:"Histiocyte",key:"",orderIdx:18},{id:"17",abbreviation:"OT",fullNm:"Others",key:"",orderIdx:19}],yt=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"02",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:2},{id:"03",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:3},{id:"04",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:4},{id:"05",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:5},{id:"06",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:6},{id:"07",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:7},{id:"08",abbreviation:"NR",fullNm:"NRBC",key:"",orderIdx:8},{id:"09",abbreviation:"AR",fullNm:"Artifact(Smudge)",key:"",orderIdx:9},{id:"10",abbreviation:"MC",fullNm:"Malignant cell",key:"",orderIdx:10},{id:"11",abbreviation:"MT",fullNm:"Mesothelial cell",key:"",orderIdx:11}],bt=[{abbreviation:"NE",fullNm:"Neutrophil",classId:"01",min:42,max:85,unit:"%"},{abbreviation:"ME",fullNm:"Metamyelocyte",classId:"02",min:0,max:100,unit:"%"},{abbreviation:"MY",fullNm:"Myelocyte",classId:"03",min:0,max:100,unit:"%"},{abbreviation:"PR",fullNm:"Promyelocyte",classId:"04",min:0,max:100,unit:"%"},{abbreviation:"LY",fullNm:"Lymphocyte",classId:"05",min:11,max:49,unit:"%"},{abbreviation:"MO",fullNm:"Monocyte",classId:"07",min:0,max:9,unit:"%"},{abbreviation:"EO",fullNm:"Eosinophil",classId:"08",min:0,max:6,unit:"%"},{abbreviation:"BA",fullNm:"Basophil",classId:"09",min:0,max:2,unit:"%"},{abbreviation:"BL",fullNm:"Blast",classId:"10",min:0,max:100,unit:"%"},{abbreviation:"PC",fullNm:"Plasma cell",classId:"11",min:0,max:100,unit:"%"},{abbreviation:"NR",fullNm:"nRBC",classId:"12",min:0,max:100,unit:"Count"},{abbreviation:"GP",fullNm:"Giant platelet",classId:"13",min:0,max:100,unit:"Count"},{abbreviation:"PA",fullNm:"Platelet aggregation",classId:"14",min:0,max:100,unit:"Count"},{abbreviation:"AR",fullNm:"Artifact(Smudge)",classId:"15",min:0,max:100,unit:"Count"},{abbreviation:"MA",fullNm:"Malaria",classId:"16",min:0,max:100,unit:"Count"},{abbreviation:"LR",fullNm:"Reactive lymphocyte",classId:"61",min:0,max:100,unit:"%"},{abbreviation:"LA",fullNm:"Abnormal lymphocyte",classId:"62",min:0,max:100,unit:"%"}],Ct=[{fullNm:"Neutrophil",classId:"01",checked:!1},{fullNm:"Neutrophil-Segmented",classId:"71",checked:!1},{fullNm:"Neutrophil-Band",classId:"72",checked:!1},{fullNm:"Metamyelocyte",classId:"02",checked:!1},{fullNm:"Myelocyte",classId:"03",checked:!1},{fullNm:"Promyelocyte",classId:"04",checked:!1},{fullNm:"Lymphocyte",classId:"05",checked:!1},{fullNm:"Reactive lymphocyte",classId:"61",checked:!1},{fullNm:"Abnormal lymphocyte",classId:"62",checked:!1},{fullNm:"Monocyte",classId:"07",checked:!1},{fullNm:"Eosinophil",classId:"08",checked:!1},{fullNm:"Basophil",classId:"09",checked:!1},{fullNm:"Blast",classId:"10",checked:!1},{fullNm:"Plasma cell",classId:"11",checked:!1},{fullNm:"nRBC",classId:"12",checked:!1},{fullNm:"Giant platelet",classId:"13",checked:!1},{fullNm:"Platelet aggregation",classId:"14",checked:!1},{fullNm:"Malaria",classId:"16",checked:!1},{fullNm:"Artifact(Smudge)",classId:"15",checked:!1},{fullNm:"rbcPrintModel",classId:"99999",checked:!1}],ht=[{fullNm:"Neutrophil",classId:"01",checked:!1},{fullNm:"Neutrophil-Segmented",classId:"71",checked:!1},{fullNm:"Neutrophil-Band",classId:"72",checked:!1},{fullNm:"Metamyelocyte",classId:"02",checked:!1},{fullNm:"Myelocyte",classId:"03",checked:!1},{fullNm:"Promyelocyte",classId:"04",checked:!1},{fullNm:"Lymphocyte",classId:"05",checked:!1},{fullNm:"Abnormal lymphocyte",classId:"06",checked:!1},{fullNm:"Monocyte",classId:"07",checked:!1},{fullNm:"Eosinophil",classId:"08",checked:!1},{fullNm:"Basophil",classId:"09",checked:!1},{fullNm:"Blast",classId:"10",checked:!1},{fullNm:"Plasma cell",classId:"11",checked:!1},{fullNm:"Orthochromic Normoblast",classId:"12",checked:!1},{fullNm:"Polychromic Normoblast",classId:"13",checked:!1},{fullNm:"Basophilic Normoblast",classId:"14",checked:!1},{fullNm:"Proerythroblast",classId:"15",checked:!1},{fullNm:"Histiocyte",classId:"16",checked:!1},{fullNm:"Others",classId:"17",checked:!1}],St=[{fullNm:"Neutrophil",classId:"01",key:"NE"},{fullNm:"Neutrophil-Segmented",classId:"71",key:"NS"},{fullNm:"Neutrophil-Band",classId:"72",key:"NB"},{fullNm:"Metamyelocyte",classId:"02",key:"ME"},{fullNm:"Myelocyte",classId:"03",key:"MY"},{fullNm:"Promyelocyte",classId:"04",key:"PR"},{fullNm:"Lymphocyte",classId:"05",key:"LY"},{fullNm:"Reactive lymphocyte",classId:"61",key:"LR"},{fullNm:"Abnormal lymphocyte",classId:"62",key:"LA"},{fullNm:"Monocyte",classId:"07",key:"MO"},{fullNm:"Eosinophil",classId:"08",key:"EO"},{fullNm:"Basophil",classId:"09",key:"BA"},{fullNm:"Blast",classId:"10",key:"BL"},{fullNm:"Plasma cell",classId:"11",key:"PC"},{fullNm:"nRBC",classId:"12",key:"NR"},{fullNm:"Giant platelet",classId:"13",key:"GP"},{fullNm:"Platelet aggregation",classId:"14",key:"PA"},{fullNm:"Malaria",classId:"16",key:"MA"},{fullNm:"Artifact(Smudge)",classId:"15",key:"AR"},{fullNm:"rbcPrintModel",classId:"99999",key:""}],kt=[{categoryId:"01",categoryNm:"Size",classId:"01",fullNm:"Normal",key:"SIZN"},{categoryId:"01",categoryNm:"Size",classId:"02",fullNm:"Macrocyte",key:"SIZMA"},{categoryId:"01",categoryNm:"Size",classId:"03",fullNm:"Microcyte",key:"SIZMI"},{categoryId:"01",categoryNm:"Size",classId:"04",fullNm:"Anisocytosis",key:""},{categoryId:"02",categoryNm:"Chromia",classId:"01",fullNm:"Normal",key:"CHRN"},{categoryId:"02",categoryNm:"Chromia",classId:"02",fullNm:"Hyperchromic",key:"CHRHYPER"},{categoryId:"02",categoryNm:"Chromia",classId:"03",fullNm:"Hypochromic",key:"CHRHYPO"},{categoryId:"02",categoryNm:"Chromia",classId:"04",fullNm:"Polychromia",key:""},{categoryId:"03",categoryNm:"Shape",classId:"01",fullNm:"Normal",key:"SHAPN"},{categoryId:"03",categoryNm:"Shape",classId:"02",fullNm:"Poikilocytosis",key:"SHAPPO"},{categoryId:"03",categoryNm:"Shape",classId:"03",fullNm:"Target Cell",key:""},{categoryId:"03",categoryNm:"Shape",classId:"04",fullNm:"Burr Cell",key:""},{categoryId:"03",categoryNm:"Shape",classId:"05",fullNm:"Acanthocyte",key:""},{categoryId:"03",categoryNm:"Shape",classId:"06",fullNm:"Ovalocyte",key:""},{categoryId:"03",categoryNm:"Shape",classId:"07",fullNm:"Schistocyte",key:""},{categoryId:"03",categoryNm:"Shape",classId:"08",fullNm:"Sickle Cell",key:""},{categoryId:"03",categoryNm:"Shape",classId:"09",fullNm:"Stomatocyte",key:""},{categoryId:"03",categoryNm:"Shape",classId:"10",fullNm:"Tear Drop Cell",key:""},{categoryId:"03",categoryNm:"Shape",classId:"11",fullNm:"Spherocyte",key:""},{categoryId:"05",categoryNm:"Inclusion Body",classId:"01",fullNm:"Howell-Jolly Body",key:""},{categoryId:"05",categoryNm:"Inclusion Body",classId:"02",fullNm:"Basophilic Stippling",key:""}],Nt=[{minGPCount:0,minPACount:0}],_t=[{min:0,max:700,wbcTargetCount:50},{min:701,max:1e3,wbcTargetCount:100},{min:1001,max:2e3,wbcTargetCount:150},{min:2001,max:3e3,wbcTargetCount:250}],Et=[{lisHotKey:"",lisFilePath:"",cbcFilePath:""}],wt={barcodeDirName:"00_Barcode_Image"},Rt={howellJollyDirName:"19_Howell_jolly",malariaDirName:"43_InclusionBody_Malaria",noMalariaDirName:"44_InclusionBody_NoMalaria",rbcClassDirName:"03_RBC_Classification",rbcImageDirName:"02_RBC_Image",barcodeDirName:"00_Barcode_Image",wbcClassDirName:"01_WBC_Classification",bfDirName:"02_LowPower_Image",bfHighDirName:"03_HighPower_Image",bfClassDirName:"05_BF_Classification",iaRootPath:"D:/ia_proc"},Lt={cellImageAnalyzed:"cellImageAnalyzed",rbcDegree:"rbcDegree",wbcRunningCount:"wbcRunningCount",wbcCustomClass:"wbcCustomClass",wbcHotKeys:"wbcHotKeys",bfHotKeys:"bfHotKeys",normalRange:"normalRange",classOrder:"classOrder",imagePrint:"imagePrint",lisCode:"lisCode",cbcCode:"cbcCode",filePathSet:"filePathSet"},Tt={class:"mb1"};var Pt={__name:"Confirm",props:["isVisible","type","message","confirmText","closeText"],emits:["okConfirm"],setup(e,{emit:t}){const a=e,l=(0,s.EW)((()=>`confirm-${a.type}`)),o=t,i=()=>{o("hide")},r=()=>{o("okConfirm")};return(t,a)=>e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["alert",l.value])},[(0,s.Lk)("p",Tt,(0,n.v_)(e.message),1),(0,s.Lk)("button",{class:"alertButton",onClick:r},(0,n.v_)(e.confirmText||"OK"),1),(0,s.Lk)("button",{class:"alertCloseButton",onClick:i},(0,n.v_)(e.closeText||"CLOSE"),1)],2)):(0,s.Q3)("",!0)}};const At=Pt;var Dt=At;const Mt=ee(),xt=async e=>Mt.httpPost(te.device.getDeviceInfo.create,e),Kt=async()=>Mt.httpGet(te.device.getDeviceInfo.get),Ot=async()=>Mt.httpGet(te.device.getDeviceInfo.ip),Bt={class:"execute"},Ft={class:"startDiv"},Ut=["disabled"],$t=["value"],Wt={class:"stopDiv"},Xt=["disabled"],Gt=["value"],Ht=["disabled"],Vt=["value"],jt=(0,s.Lk)("span",null," INITIALIZING ",-1);var Yt=(0,s.pM)({__name:"execute",setup(e,{emit:t}){const a=(0,c.Pj)(),i=(0,s.EW)((()=>a.state.embeddedStatusModule)),r=(0,s.EW)((()=>a.state.userModule)),u=(0,o.KR)("pb"),d=(0,o.KR)([]),m=(0,s.EW)((()=>a.state.commonModule)),v=(0,s.EW)((()=>a.state.executeModule)),p=(0,o.KR)(m.value?.isPause),g=(0,o.KR)(v.value?.isRunningState),f=(0,o.KR)(i.value?.userStop),I=(0,o.KR)(i.value?.isRecoveryRun),y=(0,o.KR)(i.value?.isInit),b=(0,o.KR)(""),C=(0,o.KR)(),h=(0,o.KR)(),S=(0,o.KR)(),k=(0,o.KR)([]),N=(0,s.EW)((()=>a.state.commonModule)),_=(0,o.KR)(!1),E=(0,o.KR)(""),w=(0,o.KR)(!1),R=(0,o.KR)(""),L=(0,o.KR)(""),T=(0,o.KR)([]),P=t,A=(0,o.KR)(!1),D=(0,o.KR)(""),M=(0,o.KR)(""),x=(0,o.KR)(""),K=(0,o.KR)();(0,o.KR)(!1);(0,s.wB)(r.value,(async(e,t)=>{""!==e.id&&(b.value=e.id,await O())})),(0,s.sV)((async()=>{await O()}));const O=async()=>{u.value="bm"===window.PROJECT_TYPE?"bm":"pb",T.value="bm"===window.PROJECT_TYPE?st:lt,d.value="bm"===window.PROJECT_TYPE?U:F,await(0,s.dY)(),await Z(),await te(),await ee(),await J(),g.value?(E.value="isRunning",_.value=!1):(E.value="start",_.value=!0)};(0,s.wB)(N.value,(e=>{""===e.loginSetData&&(O(),a.dispatch("commonModule/setCommonInfo",{loginSetData:"nn"})),e.resetAnalyzing&&(Z(),a.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!1}))}),{deep:!0}),(0,s.wB)([m.value],(async e=>{await(0,s.dY)();const[t]=e,{isRunningState:a,bfSelectFiles:l}=t||{};g.value=a,k.value=l,g.value?(E.value="isRunning",_.value=!1):_.value=!0})),(0,s.wB)([i.value,v.value],(async e=>{const[t]=e;await(0,s.dY)();const{isPause:a,userStop:l,isRecoveryRun:o,isInit:n}=t||{};p.value=a,f.value=l,I.value=o,y.value=n,p.value?E.value="isPause":f.value&&!I.value?E.value="onRecover":"N"===y.value||""===y.value?E.value="isInit":E.value="start"}));const B=async(e,t)=>{Je.publish("childEmitSocketData",t)},W=()=>{const e=j(),t={jobCmd:"SEARCH_CARD_COUNT",reqUserId:b.value,reqDttm:e,testType:C.value};z().embedStatus.searchCardCount.reqUserId=b.value,z().embedStatus.searchCardCount.testType=C.value,Je.publish("childEmitSocketData",t)},X=e=>{if("start"===e){if(p.value)return z().embedStatus.restart.bfSelectFiles=k.value,z().embedStatus.restart.reqUserId=b.value,void B("SEND_DATA",z().embedStatus.restart);if(g.value)return void H(G.IDS_ERROR_ALREADY_RUNNING);if(f.value)return M.value=G.IDS_RECOVER_GRIPPER_CONDITION,void(A.value=!0);const e=sessionStorage.getItem("rbcPositionMargin"),t=sessionStorage.getItem("wbcPositionMargin"),l=sessionStorage.getItem("pltPositionMargin"),s=sessionStorage.getItem("edgeShotType")||"0";let o=z().embedStatus.startAction;if(Object.assign(o,{testType:C.value,wbcCount:K.value||h.value,stitchCount:S.value,reqUserId:b.value,rbcPositionMargin:e||"0",wbcPositionMargin:t||"0",pltPositionMargin:l||"0",edgeShotType:s||"0"}),"bm"===window.PROJECT_TYPE&&(o={jobCmd:"START",reqUserId:b.value,reqDttm:z().embedStatus.startAction.reqDttm,orderInfo:[{orderId:"1",cassetNo:"",slotNo:"1",bmNo:"1",patientId:"",patientNm:"",age:"1",gender:"01",testType:"02",stainType:"01",userInputStainType:"",analysisType:C.value,bmSamplingSide:"01",cellCount:h.value,department:"s",stitchCount:S.value}],runningMode:"00",positionMargin:"0"}),"Y"===y.value){B("SEND_DATA",o);const e={startEmbedded:!0};a.dispatch("commonModule/setCommonInfo",e)}}else{if(!g.value)return void H(G.IDS_ERROR_STOP_PROCESS);a.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{userStop:!0}),z().embedStatus.stop.reqUserId=b.value,B("SEND_DATA",z().embedStatus.stop)}},H=e=>{w.value=!0,R.value="success",L.value=e},V=()=>{w.value=!1},Y=()=>{A.value=!1},q=()=>{A.value=!1,z().embedStatus.recovery.reqUserId=b.value,B("SEND_DATA",z().embedStatus.recovery)},Q=()=>{z().embedStatus.init.reqUserId=b.value,B("SEND_DATA",z().embedStatus.init),P("initDataChangeText",!0)},J=async()=>{const e={...i.value},t={...m.value};y.value=e.isInit,p.value=e.isPause,f.value=e.userStop,I.value=e.isRecoveryRun,g.value=t.isRunningState,_.value=("N"===y.value||""===y.value)&&!g.value},Z=async()=>{try{const e=await se();if(e&&e?.data){const t=e.data;if(C.value=t.analysisType,await a.dispatch("commonModule/setCommonInfo",{analysisType:C.value}),"bm"===window.PROJECT_TYPE)h.value=t.diffCellAnalyzingCount;else switch(C.value){case"01":h.value=t.diffCellAnalyzingCount;break;case"04":h.value=t.pbsCellAnalyzingCount;break;default:h.value=t.bfCellAnalyzingCount}S.value=t.stitchCount}}catch(e){console.log(e)}},ee=async()=>{if("pb"===window.PROJECT_TYPE&&"0011"===x.value)try{const e=await Be();if(e&&e.data){const t=e.data;if(t&&t?.length>0){const e=t.filter((e=>e.min<=h.value&&h.value<=e.max))[0];e.wbcTargetCount&&(K.value=e.wbcTargetCount)}}}catch(e){console.log(e)}},te=async()=>{try{const e=await Kt();x.value=e.data.siteCd}catch(e){console.log(e)}};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Bt,[(0,s.Lk)("div",Ft,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),disabled:g.value,onChange:W},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,$t)))),128))],40,Ut),[[l.u1,C.value]]),_.value?((0,s.uX)(),(0,s.CE)("p",{key:0,class:"startStopP",onClick:t[1]||(t[1]=e=>"Y"===y.value&&X("start"))},[(0,s.bF)(a,{icon:["fas","circle-play"],class:(0,n.C4)({startBtn:!0,[E.value]:!0})},null,8,["class"])])):((0,s.uX)(),(0,s.CE)("p",{key:1,class:"startStopP",onClick:t[2]||(t[2]=e=>X("stop"))},[(0,s.bF)(a,{icon:["fas","circle-stop"],class:"stopBtn"})]))]),(0,s.Lk)("div",Wt,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e),disabled:g.value},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Gt)))),128))],8,Xt),[[l.u1,h.value]]),(0,s.bo)((0,s.Lk)("select",{class:"stopDivSelect","onUpdate:modelValue":t[4]||(t[4]=e=>S.value=e),disabled:g.value},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)($),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Vt)))),128))],8,Ht),[[l.u1,S.value]]),(0,s.Lk)("div",{class:(0,n.C4)(["initBtn",{isInitDisabled:"Y"===y.value}]),onClick:Q},[(0,s.bF)(a,{icon:["fas","rotate-right"],style:{"font-size":"0.9rem"},class:(0,n.C4)({disabled:"N"!==y.value})},null,8,["class"]),jt],2)])]),w.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":w.value,type:R.value,message:L.value,onHide:V,"onUpdate:hideAlert":V},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),A.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:1,"is-visible":A.value,type:D.value,message:M.value,onHide:Y,onOkConfirm:q},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const qt=Yt;var Qt=qt;const Jt=(0,s.Lk)("h3",{class:"titleText"},"Working View",-1),zt={class:"circular-progress-bar mt2"},Zt={class:"progress-ring",width:"120",height:"120"},ea=["cx","cy","r","stroke-width"],ta=["cx","cy","r","stroke-width","stroke","stroke-dasharray","stroke-dashoffset"],aa={class:"slideTime"},la=(0,s.Lk)("p",{class:"slideTime1 mt2"},"Total Time",-1),sa={key:0,class:"slideCardWrap"},oa={class:"slideContent"},na=(0,s.Lk)("p",{class:"mt1"},"INPUT",-1),ia={class:"slideContent"},ra=(0,s.Lk)("p",{class:"mt1"},"OUTPUT",-1),ca={key:1,class:"slideCardWrap"},ua={class:"slideContent pb100a"},da={class:"mt1"};var ma=(0,s.pM)({__name:"workingView",props:["parsedData","pb100aCassette"],setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.runningInfoModule)),l=(0,s.EW)((()=>t.state.commonModule)),i=(0,s.EW)((()=>t.state.commonModule.initValData)),r=(0,s.EW)((()=>t.state.timeModule)),u=e,d=(0,o.KR)(0),m=(0,o.KR)(120),v=(0,o.KR)(6),p=(0,o.KR)("#00c2ff"),g=(0,o.KR)(m.value/2),f=(0,o.KR)(2*Math.PI*(g.value-v.value/2)),I=(0,o.KR)(f.value),y=(0,o.KR)(0),b=(0,o.KR)(0),C=(0,o.KR)(""),h=(0,o.KR)(""),S=(0,o.KR)("");let k=null,N=null;const _=(0,o.KR)(W);let E=(0,o.KR)(0),w=(0,o.KR)(0);const R=(0,o.KR)(!1);let L=(0,o.KR)(null);const T=(0,o.KR)(!1),P=(0,o.KR)(!1),A=(0,o.KR)(""),D=(0,o.KR)("0"),M=(0,o.KR)("0");(0,s.wB)((()=>t.state.embeddedStatusModule),(e=>{const t=e.sysInfo;"02"===t.eqStatCd&&(P.value=!1),P.value||(C.value=e.sysInfo.eqStatCd),l.value.isRunningState?(x(t.iCasStat,_.value.input),x(t.oCasStat,_.value.output)):(F(),B());const a=/[1,2,9]/g,s=String(t?.iCasStat);"999999999999"!==String(t?.iCasStat)&&(s.search(a)<0||"111111111111"===t?.oCasStat)&&(x(t.iCasStat,_.value.input),x(t.oCasStat,_.value.output))}),{deep:!0}),(0,s.wB)([l.value],(async e=>{const t=JSON.parse(JSON.stringify(e));t[0].startEmbedded?""===t[0].runningSlotId&&t[0].startEmbedded&&O():B(),t[0].isRunningState||(F(),B(),I.value=f.value)})),(0,s.wB)([a.value],(e=>{const t=JSON.parse(JSON.stringify(e));if(D.value=t[0]?.runningInfo?.iCasExist,M.value=t[0]?.runningInfo?.oCasExist,"start"===t[0].changeSlideState?.changeSlide.value&&!0===t[0].slideBooleanState?.slideIs.value?K():"stop"===t[0].changeSlideState?.changeSlide.value&&null!==k&&(clearInterval(k),k=null),"afterChange"===t[0].changeSlideState?.changeSlide.value&&(B(),K()),t[0].runningInfo){const e=t[0].runningInfo.slotInfo;if(e&&"03"===e?.stateCd){y.value=Number(e.wbcCount),b.value=Number(e.maxWbcCount),y.value>b.value&&(y.value=b.value);const t=y.value/b.value*100;I.value=f.value*(1-t/100)}}})),(0,s.wB)((()=>C.value),(e=>{"05"===e?L.value=setInterval((()=>{R.value=!R.value}),1e3):(R.value=!1,clearInterval(L.value))})),(0,s.wB)((()=>i.value),(e=>{e&&(C.value="05"),P.value=e})),(0,s.wB)((()=>u.pb100aCassette),(e=>{"reset"===e&&(F(),O(),B())}),{deep:!0}),(0,s.KC)((()=>{A.value=window.PB_VERSION,_.value="100a"===A.value?X:W})),(0,s.sV)((()=>{C.value="01",_.value.input.forEach((e=>{e.slotState="0"})),_.value.output.forEach((e=>{e.slotState="0"})),T.value="bm"===window.PROJECT_TYPE}));const x=(e,t)=>{t.forEach(((t,a)=>{t.slotState=e.charAt(a)}))},K=()=>{k||(k=setInterval((()=>{l.value.isRunningState&&(w.value+=1,d.value=w.value%60,sessionStorage.setItem("elapsedTimeCount",String(w.value)),t.dispatch("timeModule/setTimeInfo",{slideTime:q(w.value)}))}),1e3))};(0,s.xo)((()=>{k&&(clearInterval(k),k=null),N&&(clearInterval(N),N=null)}));const O=()=>{N||(N=setInterval((()=>{l.value.isRunningState&&(E.value+=1,sessionStorage.setItem("totalElapsedTimeCount",String(E.value)),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:q(E.value)}))}),1e3))},B=()=>{clearInterval(k),k=null,w.value=0,h.value=q(0),sessionStorage.removeItem("elapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"})},F=()=>{clearInterval(N),N=null,E.value=0,S.value=q(0),sessionStorage.removeItem("totalElapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"})},U=()=>{switch(C.value){case"01":return"IDLE";case"02":return"READY";case"03":return"ERROR";case"04":return"RUNNING";case"05":return"INITIALIZATION";default:return"UNKNOWN"}},$=(e,t)=>{if("input"===t)switch(e){case"0":return"class-for-state-0";case"1":return"class-for-state-1";case"2":return"class-for-state-2";case"3":return"class-for-state-3";case"4":return"class-for-state-4";default:return""}else switch(e){case"0":return"out-for-state-0";case"1":return"out-for-state-1";default:return"outClassDefault"}},G=e=>{switch(e){case"0":return"EMPTY";case"1":return"EXIST";case"2":return"FULL"}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[Jt,(0,s.Lk)("div",null,[(0,s.Lk)("p",{class:(0,n.C4)({blinkColor:R.value})},(0,n.v_)(U()),3),(0,s.Lk)("p",null,(0,n.v_)(y.value),1),(0,s.Lk)("div",zt,[((0,s.uX)(),(0,s.CE)("svg",Zt,[(0,s.Lk)("circle",{cx:g.value,cy:g.value,r:g.value-v.value/2,"stroke-width":v.value,stroke:"#ccc",fill:"none"},null,8,ea),(0,s.Lk)("circle",{cx:g.value,cy:g.value,r:g.value-v.value/2,"stroke-width":v.value,stroke:p.value,fill:"none","stroke-dasharray":f.value,"stroke-dashoffset":I.value},null,8,ta)])),(0,s.Lk)("p",aa,(0,n.v_)(r.value.slideTime),1)]),la,(0,s.Lk)("p",null,(0,n.v_)(r.value.totalSlideTime),1)]),"12a"===A.value?((0,s.uX)(),(0,s.CE)("div",sa,[(0,s.Lk)("ul",oa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(_.value.input,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)($(e.slotState,"input"))},null,2)))),128)),na]),(0,s.Lk)("ul",ia,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(_.value.output,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)($(e.slotState,"output"))},null,2)))),128)),ra])])):((0,s.uX)(),(0,s.CE)("div",ca,[(0,s.Lk)("ul",ua,[(0,s.Lk)("p",null,"INPUT : "+(0,n.v_)(G(D.value)),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([..._.value.input].reverse(),(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)($(e.slotState,"input"))},null,2)))),128)),(0,s.Lk)("p",da,"OUTPUT : "+(0,n.v_)(G(M.value)),1)])]))]))}});const va=ma;var pa=va;const ga={class:"orderListTableContainer"},fa=(0,s.Lk)("h3",{class:"titleText"},"Order List",-1),Ia={class:"orderListTable"},ya=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Barcode ID"),(0,s.Lk)("th",null,"Patient Name"),(0,s.Lk)("th",null,"Order Date"),(0,s.Lk)("th",null,"State")])],-1),ba={key:0},Ca={key:1},ha=(0,s.Lk)("tr",null,[(0,s.Lk)("td",{colspan:"4"},"Data is empty.")],-1),Sa=[ha];var ka=(0,s.pM)({__name:"orderList",props:["parsedData","startStatus","pb100aCassette"],setup(e){const t=e,a=(0,o.KR)([]);(0,s.wB)((()=>t.parsedData),(e=>{l(e)}),{deep:!0}),(0,s.wB)((()=>t.pb100aCassette),(e=>{"reset"===e&&(a.value=[],console.log("pb100aCassette 초기화",a.value))}),{deep:!0}),(0,s.wB)((()=>t.startStatus),(e=>{!0===e&&(a.value=[])}),{deep:!0});const l=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const e=t?.slotInfo;if(e){const t=e.barcodeNo,l=a.value.findIndex((e=>e.barcodeId===t));-1===l&&""!==t?(a.value.length>10&&(a.value=[]),a.value.push({barcodeId:t,patientName:e.patientNm,orderDate:p(e.orderDttm),analyzedDttm:p(e.analyzedDttm),state:e.stateCd})):a.value[l]={barcodeId:t,patientName:e.patientNm,orderDate:p(e.orderDttm),analyzedDttm:p(e.analyzedDttm),state:e.stateCd}}}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",ga,[fa,(0,s.Lk)("table",Ia,[ya,a.value.length>0?((0,s.uX)(),(0,s.CE)("tbody",ba,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,n.v_)(e?.barcodeId),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientName),1),(0,s.Lk)("td",null,(0,n.v_)(e?.analyzedDttm?(0,o.R1)(Y)(e?.analyzedDttm):(0,o.R1)(Y)(e?.orderDate)),1),(0,s.Lk)("td",null,(0,n.v_)((0,o.R1)(v)("14",e?.state)),1)])))),128))])):((0,s.uX)(),(0,s.CE)("tbody",Ca,Sa))])]))}});const Na=ka;var _a=Na;const Ea=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",key:"",orderIdx:8},{id:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:9},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:10},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:11},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:12},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:13},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:14},{id:"12",abbreviation:"NR",fullNm:"nRBC",key:"",orderIdx:15},{id:"13",abbreviation:"GP",fullNm:"Giant platelet",key:"",orderIdx:16},{id:"14",abbreviation:"PA",fullNm:"Platelet aggregation",key:"",orderIdx:17},{id:"16",abbreviation:"MA",fullNm:"Malaria",key:"",orderIdx:18},{id:"15",abbreviation:"AR",fullNm:"Artifact",key:"",orderIdx:19},{id:"17",abbreviation:"SM",fullNm:"Smudge",key:"",orderIdx:20}],wa=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:8},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:9},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:10},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:11},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:12},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:13},{id:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",key:"",orderIdx:14},{id:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",key:"",orderIdx:15},{id:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",key:"",orderIdx:16},{id:"15",abbreviation:"PE",fullNm:"Proerythroblast",key:"",orderIdx:17},{id:"16",abbreviation:"HC",fullNm:"Histiocyte",key:"",orderIdx:18},{id:"17",abbreviation:"OT",fullNm:"Others",key:"",orderIdx:19}],Ra=[{classId:"01",abbreviation:"NE",fullNm:"Neutrophil",orderIdx:1},{classId:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",orderIdx:2},{classId:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",orderIdx:3},{classId:"02",abbreviation:"ME",fullNm:"Metamyelocyte",orderIdx:4},{classId:"03",abbreviation:"MY",fullNm:"Myelocyte",orderIdx:5},{classId:"04",abbreviation:"PR",fullNm:"Promyelocyte",orderIdx:6},{classId:"05",abbreviation:"LY",fullNm:"Lymphocyte",orderIdx:7},{classId:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",orderIdx:8},{classId:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",orderIdx:9},{classId:"07",abbreviation:"MO",fullNm:"Monocyte",orderIdx:10},{classId:"08",abbreviation:"EO",fullNm:"Eosinophil",orderIdx:11},{classId:"09",abbreviation:"BA",fullNm:"Basophil",orderIdx:12},{classId:"10",abbreviation:"BL",fullNm:"Blast",orderIdx:13},{classId:"11",abbreviation:"PC",fullNm:"Plasma cell",orderIdx:14},{classId:"12",abbreviation:"NR",fullNm:"nRBC",orderIdx:15},{classId:"13",abbreviation:"GP",fullNm:"Giant platelet",orderIdx:16},{classId:"14",abbreviation:"PA",fullNm:"Platelet aggregation",orderIdx:17},{classId:"16",abbreviation:"MA",fullNm:"Malaria",orderIdx:18},{classId:"15",abbreviation:"AR",fullNm:"Artifact",orderIdx:19},{classId:"17",abbreviation:"SM",fullNm:"Smudge",orderIdx:20}],La=[{classId:"01",abbreviation:"NE",fullNm:"Neutrophil",orderIdx:1},{classId:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",orderIdx:2},{classId:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",orderIdx:3},{classId:"02",abbreviation:"ME",fullNm:"Metamyelocyte",orderIdx:4},{classId:"03",abbreviation:"MY",fullNm:"Myelocyte",orderIdx:5},{classId:"04",abbreviation:"PR",fullNm:"Promyelocyte",orderIdx:6},{classId:"05",abbreviation:"LY",fullNm:"Lymphocyte",orderIdx:7},{classId:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",orderIdx:8},{classId:"07",abbreviation:"MO",fullNm:"Monocyte",orderIdx:9},{classId:"08",abbreviation:"EO",fullNm:"Eosinophil",orderIdx:10},{classId:"09",abbreviation:"BA",fullNm:"Basophil",orderIdx:11},{classId:"10",abbreviation:"BL",fullNm:"Blast",orderIdx:12},{classId:"11",abbreviation:"PC",fullNm:"Plasma cell",orderIdx:13},{classId:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",orderIdx:14},{classId:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",orderIdx:15},{classId:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",orderIdx:16},{classId:"15",abbreviation:"PE",fullNm:"Proerythroblast",orderIdx:17},{classId:"16",abbreviation:"HC",fullNm:"Histiocyte",orderIdx:18},{classId:"17",abbreviation:"OT",fullNm:"Others",orderIdx:19}],Ta=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,key:"",order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,key:"",order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,key:"",order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,key:"",order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,key:"",order:7},{id:"61",title:"LR",name:"Reactive lymphocyte",count:0,percent:0,key:"",order:8},{id:"62",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,key:"",order:9},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,key:"",order:10},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,key:"",order:11},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,key:"",order:12},{id:"10",title:"BL",name:"Blast",count:0,percent:0,key:"",order:13},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,key:"",order:14},{id:"12",title:"NR",name:"nRBC",count:0,percent:0,key:"",order:15},{id:"13",title:"GP",name:"Giant platelet",count:0,percent:0,key:"",order:16},{id:"14",title:"PA",name:"Platelet aggregation",count:0,percent:0,key:"",order:17},{id:"16",title:"MA",name:"Malaria",count:0,percent:0,key:"",order:18},{id:"15",title:"AR",name:"Artifact",count:0,percent:0,key:"",order:19},{id:"17",title:"SM",name:"Smudge",count:0,percent:0,key:"",order:20}],Pa=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,order:7},{id:"06",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,order:8},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,order:9},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,order:10},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,order:11},{id:"10",title:"BL",name:"Blast",count:0,percent:0,order:12},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,order:13},{id:"12",title:"ON",name:"Orthochromic Normoblast",count:0,percent:0,order:14},{id:"13",title:"PN",name:"Polychromic Normoblast",count:0,percent:0,order:15},{id:"14",title:"BN",name:"Basophilic Normoblast",count:0,percent:0,order:16},{id:"15",title:"PE",name:"Proerythroblast",count:0,percent:0,order:17},{id:"16",title:"HC",name:"Histiocyte",count:0,percent:0,order:18},{id:"17",title:"OT",name:"Others",count:0,percent:0,order:19}],Aa={class:"titleText"},Da=(0,s.Lk)("span",{class:"greenColor"},"BM",-1),Ma=(0,s.Lk)("span",{class:"greenColor"},"WBC",-1),xa={class:"analysisWbc"},Ka={key:0,class:"categories"},Oa={class:"categoryNm"},Ba={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Fa={style:{cursor:"default"}},Ua={class:"classNm"},$a={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Wa={style:{"text-align":"center",cursor:"default"}},Xa={class:"degree"},Ga={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Ha={style:{cursor:"default"}},Va={class:"categories"},ja=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",{style:{cursor:"default"}}," Total ")],-1),Ya={class:"classNm"},qa={style:{cursor:"default"}},Qa=(0,s.Lk)("ul",{class:"degree"},[(0,s.Lk)("li",{style:{cursor:"default"}}," 100.00 ")],-1),Ja={key:0,class:"categories mt1"},za={class:"categoryNm"},Za={key:0,class:"mb1 liTitle"},el={class:"classNm"},tl={key:0,class:"mb1 liTitle"},al={style:{"text-align":"center"}},ll={class:"degree"},sl={key:0,class:"mb1 liTitle"},ol={class:"mt1"},nl={class:"categoryNm",style:{cursor:"default"}},il={key:0,class:"mb1 liTitle",style:{cursor:"default"}},rl={style:{cursor:"default"}},cl={class:"classNm"},ul={key:0,class:"mb1 liTitle"},dl={style:{cursor:"default"}},ml={key:0},vl={class:"degree"},pl={key:0,class:"mb1 liTitle"},gl=(0,s.Lk)("li",{style:{cursor:"default"}},"-",-1);var fl=(0,s.pM)({__name:"classInfoification",props:["bmIsBoolen","parsedData"],setup(e,{emit:t}){const a=e,l=(0,c.Pj)(),i=(0,s.EW)((()=>l.state.commonModule.siteCd)),r=((0,o.KR)(!1),(0,o.KR)([])),u=(0,o.KR)([]),d=(0,o.KR)(""),m=(0,o.KR)("0"),v=(0,o.KR)(""),p=t;sessionStorage.getItem("isNsNbIntegration");(0,s.sV)((()=>{f(wa,null,!0)})),(0,s.wB)((()=>a.parsedData),((e,t)=>{g(e)}),{deep:!0});const g=async e=>{const t=e;"RUNNING_INFO"===t.jobCmd&&await f({wbcInfo:t.slotInfo},t)},f=async(e,t,l)=>{const s=JSON.parse(JSON.stringify(e));if(s.wbcInfo){d.value=s?.wbcInfo?.testType;const e=a.bmIsBoolen?[s.wbcInfo.bmInfo]:[s.wbcInfo.wbcInfo],t=e,l=a.bmIsBoolen?[Pa]:[Ta];r.value=t[0].length>0?t:l;const o=e=>e.every((e=>e.every((e=>"0"===e.count)))),n=o(r.value);n&&(m.value="0"),u.value=r.value.flat()}else{const e=a.bmIsBoolen?[Pa]:[Ta];r.value=e,u.value=r.value.flat()}if(s&&s.wbcInfo){const e=s.wbcInfo;e&&"03"===e?.stateCd&&(await C(e),v.value=e.maxWbcCount)}const o=t?.iCasStat??"",n=[...o];if(-1!==n.lastIndexOf("2")){const e={classInfo:{wbcInfo:r.value,totalCount:m.value,maxWbcCount:v.value,slotId:t.slotInfo.slotId},iCasStatArr:n.lastIndexOf("2")};p("classInfoUpdate",e)}},I=e=>e.flat().filter((e=>["NR","AR","GP","PA","MC","MA","GP","PA","SM"].includes(e?.title))),y=(e,t)=>{e&&""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},b=(e,t)=>{const a=y(i.value,d.value);let l=0;for(let s of e)a.includes(s.title)||(l+=Number(s.count));return l},C=async e=>{const t=a.bmIsBoolen?e.bmInfo:e.wbcInfo,l=t;let s="0";s="01"===d.value||"04"===d.value?b(r.value.flat(),l).toFixed(0):b(u.value,l).toFixed(0),m.value=s,await k()},h=e=>{const t=S(i.value,d.value);return!t.includes(e.title)},S=(e,t)=>{const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},k=async()=>{const e=r.value.map((e=>e.map((e=>{const t=m.value&&"0"!==m.value?(Number(e.count)/Number(m.value)*100).toFixed(1):"0",a=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t;return{...e,percent:a}}))));r.value=e},N=e=>e?.name;return(t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,n.C4)([e.bmIsBoolen?"bmclass":""])},[(0,s.Lk)("h3",Aa,[e.bmIsBoolen?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[Da,(0,s.eW)("Classification ")],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[Ma,(0,s.eW)(" Classification")],64))]),(0,s.Lk)("div",xa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[h(e)?((0,s.uX)(),(0,s.CE)("div",Ka,[(0,s.Lk)("ul",Oa,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",Ba,"Class")):(0,s.Q3)("",!0),(0,s.Lk)("li",Fa,(0,n.v_)(N(e)),1)]),(0,s.Lk)("ul",Ua,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",$a,"Count")):(0,s.Q3)("",!0),(0,s.Lk)("li",Wa,(0,n.v_)(e?.count),1)]),(0,s.Lk)("ul",Xa,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",Ga,"%")):(0,s.Q3)("",!0),(0,s.Lk)("li",Ha,(0,n.v_)(m.value&&"0"!==m.value?(Number(e?.count)/Number(m.value)*100).toFixed(Number(e?.count)/Number(m.value)===0?0:1):"0"),1)])])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("div",Va,[ja,(0,s.Lk)("ul",Ya,[(0,s.Lk)("li",qa,(0,n.v_)(m.value||0),1)]),Qa]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},["OT"===e.title?((0,s.uX)(),(0,s.CE)("div",Ja,[(0,s.Lk)("ul",za,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",Za,"Class")):(0,s.Q3)("",!0),(0,s.Lk)("li",null,(0,n.v_)(N(e)),1)]),(0,s.Lk)("ul",el,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",tl,"Count")):(0,s.Q3)("",!0),(0,s.Lk)("li",al,(0,n.v_)(e?.count),1)]),(0,s.Lk)("ul",ll,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",sl,"-")):(0,s.Q3)("",!0),(0,s.Lk)("li",null,(0,n.v_)(m.value&&"0"!==m.value?(Number(e?.count)/Number(m.value)*100).toFixed(0):"0"),1)])])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("div",ol,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I(r.value),((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories"},[(0,s.Lk)("ul",nl,[0===t?((0,s.uX)(),(0,s.CE)("li",il,"non-WBC")):(0,s.Q3)("",!0),(0,s.Lk)("li",rl,(0,n.v_)(N(e)),1)]),(0,s.Lk)("ul",cl,[0===t?((0,s.uX)(),(0,s.CE)("li",ul)):(0,s.Q3)("",!0),(0,s.Lk)("li",dl,[(0,s.eW)((0,n.v_)(e?.count)+" ",1),"NR"===e.title||"GP"===e.title?((0,s.uX)(),(0,s.CE)("span",ml," / "+(0,n.v_)(v.value)+" WBC",1)):(0,s.Q3)("",!0)])]),(0,s.Lk)("ul",vl,[0===t?((0,s.uX)(),(0,s.CE)("li",pl)):(0,s.Q3)("",!0),gl])])))),128))])])],2))}});const Il=fl;var yl=Il;const bl=[{categoryId:"01",categoryNm:"Size",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Macrocyte",degree:"0"},{classId:"03",classNm:"Microcyte",degree:"0"},{classId:"04",classNm:"Anisocytosis",degree:"0"}]},{categoryId:"02",categoryNm:"Chromia",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Hyperchromic",degree:"0"},{classId:"03",classNm:"Hypochromic",degree:"0"},{classId:"04",classNm:"Polychromia",degree:"0"}]},{categoryId:"03",categoryNm:"Shape",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Poikilocytosis",degree:"0"},{classId:"03",classNm:"Target Cell",degree:"0"},{classId:"04",classNm:"Burr Cell",degree:"0"},{classId:"05",classNm:"Acanthocyte",degree:"0"},{classId:"06",classNm:"Ovalocyte",degree:"0"},{classId:"07",classNm:"Schistocyte",degree:"0"},{classId:"08",classNm:"Sickle Cell",degree:"0"},{classId:"09",classNm:"Stomatocyte",degree:"0"},{classId:"10",classNm:"Tear Drop Cell",degree:"0"},{classId:"11",classNm:"Spherocyte",degree:"0"}]},{categoryId:"05",categoryNm:"Inclusion Body",classInfo:[{classId:"01",classNm:"Howell-Jolly Body",degree:"0"},{classId:"02",classNm:"Basophilic Stippling",degree:"0"}]}],Cl={key:0},hl=(0,s.Lk)("h3",{class:"titleText"},[(0,s.Lk)("span",{class:"greenColor"},"Whole"),(0,s.eW)(" Slide Image ")],-1),Sl={class:"row"},kl=["src","id","onClick"],Nl={key:0,class:"mt-3 row"},_l=(0,s.Lk)("div",{class:"col"},[(0,s.Lk)("div",{style:{color:"#2798DC"}},"Select Interest Area")],-1),El={class:"col"},wl={key:1},Rl=(0,s.Lk)("h3",{class:"titleText"},[(0,s.Lk)("span",{class:"greenColor"},"RBC"),(0,s.eW)(),(0,s.Lk)("span",{class:"greenColor"},"C"),(0,s.eW)("lassification ")],-1),Ll={class:"categoryNm"},Tl={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Pl={style:{cursor:"default"}},Al={class:"classNmRbc"},Dl={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Ml={style:{cursor:"default"}},xl={key:0,style:{cursor:"default"}},Kl={class:"degree analysis"},Ol={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Bl={key:0,style:{cursor:"default"}},Fl={key:1,style:{cursor:"default"}},Ul={key:0},$l={key:1},Wl={key:2,style:{"font-size":"0.7rem",cursor:"default"}},Xl={class:"categories"},Gl=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",{style:{cursor:"default"}},"Others")],-1),Hl=(0,s.Lk)("ul",{class:"classNmRbc"},[(0,s.Lk)("li",{style:{cursor:"default"}},"Platelets")],-1),Vl={class:"degree analysis"},jl={style:{"font-size":"0.7rem",cursor:"default"}};var Yl=(0,s.pM)({__name:"rbcclassification",props:["bmIsBoolen","parsedData"],setup(e,{emit:t}){const a=e,l=(0,o.KR)([]),i=(0,o.KR)(""),r=(0,o.KR)(""),c=(0,o.KR)(""),u=(0,o.KR)("01"),d=(0,o.KR)([]),m=(0,o.KR)([]),v=t;(0,s.sV)((async()=>{await C(),await f({rbcInfo:a.parsedData.slotInfo},"")})),(0,s.wB)((()=>a.parsedData),((e,t)=>{p(e)}),{deep:!0});const p=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const a=e?.slotInfo;a&&"03"===a?.stateCd&&(i.value=a.malariaCount,r.value=a.maxRbcCount,c.value=a.pltCount),await f({rbcInfo:t.slotInfo},t)}},g=(0,o.KR)([]),f=async(e,t)=>{const a=JSON.parse(JSON.stringify(e));if(Array.isArray(a.rbcInfo)){if(u.value=a.rbcInfo[0].testType,!a.rbcInfo[0])return;const e=[a.rbcInfo[0].rbcInfo],l=e[0].length>0?e:[bl];I(l[0],t),a.rbcInfo[0].lowPowerPath?g.value=a.rbcInfo[0].lowPowerPath.sort((function(e,t){return e.seqNo-t.seqNo})):g.value=[]}else I([bl][0],t)},I=(e,t)=>{let a=0,s=0,o=0;const n=0!==t.length&&t?JSON.parse(JSON.stringify(t?.slotInfo?.rbcInfo)):JSON.parse(JSON.stringify(e)),i=0!==t.length&&t?JSON.parse(JSON.stringify(t?.slotInfo?.rbcInfo)):JSON.parse(JSON.stringify(e));i.forEach((e=>{e.classInfo.forEach((t=>{"01"===e.categoryId?"04"!==t.classId&&(s+=Number(t.degree)):"02"===e.categoryId?"04"!==t.classId&&(o+=Number(t.degree)):a+=Number(t.degree)}))})),i.forEach(((e,t)=>{e.classInfo.forEach(((l,i)=>{m.value&&m.value.forEach((r=>{if(l.originalDegree=n[t].classInfo[i].degree,r.categoryId===e.categoryId&&r.classId===l.classId){const e=Number(l.degree);let t=0;t="01"===r.categoryId?Number((e/s*100).toFixed(2)):"02"===r.categoryId?Number((e/o*100).toFixed(2)):Number((e/a*100).toFixed(2)),isNaN(t)&&(t=0);const n=e=>l.degree=e;t<Number(r.degree1)?n("0"):t<Number(r.degree2)?n("1"):t<Number(r.degree3)?n("2"):n("3")}}))}))})),i.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})),l.value[0]=i,0===i.length&&(l.value[0]=bl);const r=t?.iCasStat??"",c=[...r];if(-1!==c.lastIndexOf("2")){const e={rbc:{rbcInfo:i,slotId:t.slotInfo.slotId},iCasStatArr:c.lastIndexOf("2")};v("rbcUpdate",e)}},y=e=>e?.categoryNm,b=(e,t)=>{if("03"===u.value){const e=d.value.findIndex((e=>e.seqNo===t.seqNo));-1!==e?d.value.splice(e,1):d.value.push(t)}},C=async()=>{try{const e=await re(),t=e.data;m.value=t}catch(e){console.log(e)}};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",null,["01"!==u.value&&"04"!==u.value?((0,s.uX)(),(0,s.CE)("div",Cl,[hl,(0,s.Lk)("div",null,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)([0,6,12,18,24,30],((e,t)=>(0,s.Lk)("div",{key:t,class:"pl-2"},[(0,s.Lk)("div",Sl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value.slice(e,e+6),((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"col-2 p-1"},[(0,s.Lk)("img",{src:e.path,id:e.seqNo,ref_for:!0,ref:"wholeSlideImg",class:"wholeSlideImg",onClick:t=>b(t,e),style:{width:"75px"}},null,8,kl)])))),128))])]))),64)),"03"===u.value?((0,s.uX)(),(0,s.CE)("div",Nl,[_l,(0,s.Lk)("div",El,[(0,s.Lk)("div",null,(0,n.v_)(d.value.length),1)])])):(0,s.Q3)("",!0)])])):((0,s.uX)(),(0,s.CE)("div",wl,[Rl,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories"},[(0,s.Lk)("ul",Ll,[0===t?((0,s.uX)(),(0,s.CE)("li",Tl,"Category")):(0,s.Q3)("",!0),(0,s.Lk)("li",Pl,(0,n.v_)(y(e)),1)]),(0,s.Lk)("ul",Al,[0===t?((0,s.uX)(),(0,s.CE)("li",Dl,"Class")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[(0,s.Lk)("li",Ml,(0,n.v_)(e?.classNm),1),"Basophilic Stippling"===e.classNm?((0,s.uX)(),(0,s.CE)("li",xl,"Malaria")):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",Kl,[0===t?((0,s.uX)(),(0,s.CE)("li",Ol,"Degree")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((t,l)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:l},["01"!==t.classId||"05"===e.categoryId?((0,s.uX)(),(0,s.CE)("li",Bl,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(e=>(0,s.bF)(a,{icon:["fas","circle"],key:e,class:(0,n.C4)({degreeActive:e<Number(t?.degree)+2||0,"degree0-img":e>=Number(t?.degree)+1||0}),style:{cursor:"default"}},null,8,["class"]))),64))])):((0,s.uX)(),(0,s.CE)("li",Fl,["0"===t.degree?((0,s.uX)(),(0,s.CE)("div",Ul,[(0,s.bF)(a,{icon:["fas","circle"]})])):((0,s.uX)(),(0,s.CE)("div",$l,[(0,s.bF)(a,{icon:["fas","circle"],class:"degreeActive"})]))])),"Basophilic Stippling"===t.classNm?((0,s.uX)(),(0,s.CE)("li",Wl,(0,n.v_)(i.value||0)+" / "+(0,n.v_)(r.value||0)+" RBC",1)):(0,s.Q3)("",!0)],64)))),128))])])))),128))],64)))),128))])),(0,s.Lk)("div",null,[(0,s.Lk)("div",Xl,[Gl,Hl,(0,s.Lk)("ul",Vl,[(0,s.Lk)("li",jl,(0,n.v_)(c.value||0)+" PLT / 1000 RBC",1)])])])])}}});const ql=Yl;var Ql=ql;const Jl={class:"mt1"},zl={key:0,class:"slider-found"},Zl=["src"];var es=(0,s.pM)({__name:"foundingCells",props:["parsedData","pb100aCassette"],setup(e){const t=window.APP_API_BASE_URL||"http://192.168.0.131:3002",a=e,n=(0,o.KR)([]);function i(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function r(e){if(!e||0===e.length)return"";const a=e?.path.match(/^(.*\\)\d+_Real_Time\\/)?.[0],l=e?.path.match(/[^\\]*$/)[0],s=`${t}/images/getImageRealTime?folder=${a}&imageName=${l}`;return s}return(0,s.wB)((()=>a.pb100aCassette),(e=>{console.log("IMAGE_RESET - should be 'reset'",e),"reset"===e&&(n.value=[])}),{deep:!0}),(0,s.wB)((()=>a.parsedData),((e,t)=>{const a=e?.slotInfo;if(a&&"03"===a.stateCd&&a.runningPath&&a.runningPath.length>0){const e=a.runningPath.map((e=>({...e,path:e.path,id:i()})));for(const t of e)n.value.unshift(t)}}),{deep:!0}),(e,t)=>((0,s.uX)(),(0,s.CE)("div",Jl,[(0,s.bF)(l.eB,{name:"fade",mode:"out-in"},{default:(0,s.k6)((()=>[n.value.length>0?((0,s.uX)(),(0,s.CE)("div",zl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[r(e)?((0,s.uX)(),(0,s.CE)("img",{key:0,style:{width:"150px",height:"150px"},src:r(e),alt:"Slide"},null,8,Zl)):(0,s.Q3)("",!0)],64)))),128))])):(0,s.Q3)("",!0)])),_:1})]))}});const ts=es;var as=ts;const ls={class:"contentLeft"},ss={class:"contentRight"},os={class:"contentBottom"};var ns=(0,s.pM)({__name:"index",props:["parsedData","isClass","startStatus","pb100aCassette"],setup(e,{emit:t}){const a=t,n=(0,c.Pj)(),i=(0,o.KR)(!1),r=e,u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,s.EW)((()=>n.state.commonModule.viewerCheck));(0,s.KC)((async()=>{"viewer"===m.value&&VC.push("/database"),u.value=window.PB_VERSION,i.value="bm"===window.PROJECT_TYPE}));const v=e=>{a("rbcAppUpdate",e)},p=e=>{a("classAppUpdateLast",e)},g=e=>{n.dispatch("commonModule/setCommonInfo",{initValData:e})};return(t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",ls,[(0,s.bF)(Qt,{onInitDataChangeText:g}),(0,s.bF)(B,{parsedData:r.parsedData,pb100aCassette:e.pb100aCassette},null,8,["parsedData","pb100aCassette"]),(0,s.bF)(_a,{parsedData:r.parsedData,startStatus:r.startStatus,pb100aCassette:e.pb100aCassette},null,8,["parsedData","startStatus","pb100aCassette"])],512),[[l.aG,r.isClass]]),(0,s.bo)((0,s.Lk)("div",ss,[(0,s.bF)(pa,{initValData:d.value,parsedData:r.parsedData,pb100aCassette:e.pb100aCassette,class:"contentRightChild"},null,8,["initValData","parsedData","pb100aCassette"]),i.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(Ql,{key:0,onRbcUpdate:v,parsedData:r.parsedData,class:"contentRightChild"},null,8,["parsedData"])),(0,s.bF)(yl,{onClassInfoUpdate:p,parsedData:r.parsedData,bmIsBoolen:i.value,class:"contentRightChild"},null,8,["parsedData","bmIsBoolen"]),(0,s.Lk)("div",os,[(0,s.bF)(as,{parsedData:r.parsedData,pb100aCassette:e.pb100aCassette},null,8,["parsedData","pb100aCassette"])])],512),[[l.aG,r.isClass]])],64))}}),is=a(6262);const rs=(0,is.A)(ns,[["__scopeId","data-v-6ea27ac8"]]);var cs=rs,us=(0,s.pM)({__name:"HomeView",setup(e){return(e,t)=>{const a=(0,s.g2)("Fragment");return(0,s.uX)(),(0,s.Wv)(a,null,{default:(0,s.k6)((()=>[(0,s.bF)(cs)])),_:1})}}});const ds=us;var ms=ds;const vs=ee(),ps=async e=>vs.httpPost(te.user.register,e),gs=async e=>vs.httpPost(te.user.login,e),fs=async e=>vs.httpPost(te.user.logout,e),Is=async e=>vs.httpGet(te.user.getUsers,e),ys=async e=>vs.httpGet(te.user.userCheck,e),bs=async(e,t)=>vs.httpPut(te.user.userDataPut,e,t),Cs=async e=>vs.httpDelete(te.user.deleteUser,e,!0),hs={class:"joinContent"},Ss=(0,s.Lk)("p",{class:"mt2 mb4"},"CREATE ACCOUNT",-1),ks={class:"joinWrapper"},Ns=(0,s.Lk)("span",{class:"loginTitle"},"ID",-1),_s=(0,s.Lk)("span",{class:"loginTitle"},"password",-1),Es=(0,s.Lk)("span",{class:"loginTitle"},"Repeat password",-1),ws=(0,s.Lk)("span",{class:"loginTitle"},"name",-1),Rs=(0,s.Lk)("span",{class:"loginTitle"},"Employee No",-1),Ls=(0,s.Lk)("span",{class:"loginTitle"},"user Type",-1),Ts=(0,s.Lk)("option",{value:"admin"},"Admin",-1),Ps=(0,s.Lk)("option",{value:"normal"},"Normal",-1),As=[Ts,Ps];var Ds=(0,s.pM)({__name:"index",setup(e){const t=(0,o.KR)(""),a=(0,o.KR)(""),n=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(""),c=(0,o.KR)("admin"),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(""),v=()=>{VC.push("/user/login")},p=async()=>{const e=new Date;if(""===a.value)return void await f("Please enter id");if(a.value.includes("_"))return void await f("UserId is not available");if(""===r.value)return void await f("Please enter password");if(""===n.value)return void await f("Please enter name");if(""===t.value)return void await f("Please enter Employee No");if(""===i.value)return void await f("Please enter repeat password");if(r.value!==i.value)return void await f("Please check if the password and password are the same");const l={userId:a.value,password:r.value,name:n.value,employeeNo:t.value,userType:c.value,subscriptionDate:e};try{const e=await ps(l);e.data?.userId?(await g("registration successful"),await VC.push("/user/login")):e.data.includes("Duplicate")&&await f("Duplicated user id")}catch(s){console.log(s),await f("Signin fail")}},g=async e=>{u.value=!0,d.value="success",m.value=e},f=e=>{u.value=!0,d.value="error",m.value=e},I=()=>{u.value=!1};return(e,o)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",hs,[Ss,(0,s.Lk)("div",null,[(0,s.Lk)("ul",ks,[(0,s.Lk)("li",null,[Ns,(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e)},null,512),[[l.Jo,a.value]])]),(0,s.Lk)("li",null,[_s,(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>r.value=e)},null,512),[[l.Jo,r.value]])]),(0,s.Lk)("li",null,[Es,(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e)},null,512),[[l.Jo,i.value]])]),(0,s.Lk)("li",null,[ws,(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>n.value=e)},null,512),[[l.Jo,n.value]])]),(0,s.Lk)("li",null,[Rs,(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[4]||(o[4]=e=>t.value=e)},null,512),[[l.Jo,t.value]])]),(0,s.Lk)("li",null,[Ls,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>c.value=e)},As,512),[[l.u1,c.value]])])]),(0,s.Lk)("div",{class:"joinBtn"},[(0,s.Lk)("button",{class:"defaultBtn",type:"button",onClick:p},"Create Account"),(0,s.Lk)("button",{class:"defaultBtn",type:"button",onClick:v},"Back")])])]),u.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":u.value,type:d.value,message:m.value,onHide:I,"onUpdate:hideAlert":I},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Ms=Ds;var xs=Ms;const Ks=(0,o.Kh)({value:[]}),Os="bm"===window.PROJECT_TYPE,Bs={testTypeCd:Os?"02":"01",diffCellAnalyzingCount:Os?"500":"100",diffWbcPositionMargin:"0",diffRbcPositionMargin:"0",diffPltPositionMargin:"0",pbsCellAnalyzingCount:"100",stitchCount:"1",edgeShotType:"0",bfCellAnalyzingCount:"100",iaRootPath:Os?"D:\\BMIA_proc":"D:\\PBIA_proc",isNsNbIntegration:!1,isAlarm:!1,alarmCount:"5",keepPage:!1,backupPath:"",backupStartDate:new Date,backupEndDate:new Date,userId:""},Fs=(0,o.KR)({lisCodeWbc:{sendingForm:"lisCodeItems",defaultItem:St,getRequest:Ee,createRequest:Ne},lisCodeRbc:{sendingForm:"lisCodeItems",defaultItem:kt,getRequest:Le,createRequest:we},cbcCode:{sendingForm:"cbcCodeItems",defaultItem:vt,getRequest:Ae,createRequest:Te},cellImage:{getRequest:se,createRequest:le},normalRange:{sendingForm:"normalRangeItems",defaultItem:bt,getRequest:Ce,createRequest:ye},orderClass:{getRequest:He,createRequest:Ge},rbcDegree:{getRequest:re,createRequest:ne}}),Us=async()=>{await $s("cellImage"),await $s("orderClass"),await $s("rbcDegree"),await $s("lisCodeWbc"),await $s("lisCodeRbc"),await $s("cbcCode"),await $s("normalRange")},$s=async e=>{const t=Fs.value[e].getRequest;try{const{data:a}=await t()||{};if(!a||0===a.length){const t=Fs.value[e]?.sendingForm,a=Fs.value[e].defaultItem,l=Fs.value[e].createRequest,s=await Ws(e);t?await l({[t]:s||a}):await l(s||a),Xs(e)}}catch(a){console.log(`${e} Error - ${a}`)}},Ws=async e=>{switch(e){case"cellImage":const e={analysisType:Bs.testTypeCd,diffCellAnalyzingCount:Bs.diffCellAnalyzingCount,diffWbcPositionMargin:Bs.diffWbcPositionMargin,diffRbcPositionMargin:Bs.diffRbcPositionMargin,diffPltPositionMargin:Bs.diffPltPositionMargin,pbsCellAnalyzingCount:Bs.pbsCellAnalyzingCount,stitchCount:Bs.stitchCount,edgeShotType:Bs.edgeShotType,bfCellAnalyzingCount:Bs.bfCellAnalyzingCount,iaRootPath:Bs.iaRootPath,isNsNbIntegration:Bs.isNsNbIntegration?"Y":"N",isAlarm:Bs.isAlarm,alarmCount:Bs.alarmCount,keepPage:Bs.keepPage,backupPath:Bs.backupPath,backupStartDate:Bs.backupStartDate.toISOString().split("T")[0],backupEndDate:Bs.backupEndDate.toISOString().split("T")[0],autoBackUpMonth:"Not selected",autoBackUpStartDate:null};return e;case"orderClass":const t="bm"===window.PROJECT_TYPE?La:Ra;for(const l in t)t[l].orderIdx=l;return t;case"rbcDegree":await Gs();const a=[];return Ks.value.forEach((e=>{e.classInfo.forEach((t=>{a.push({categoryId:e.categoryId,categoryNm:e.categoryNm,classId:t.classId,classNm:t.classNm,degree1:t.degree1,degree2:t.degree2,degree3:t.degree3})}))})),a;default:return null}},Xs=e=>{switch(e){case"cellImage":sessionStorage.setItem("isNsNbIntegration",Bs.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",String(Bs?.diffWbcPositionMargin)),sessionStorage.setItem("rbcPositionMargin",String(Bs?.diffRbcPositionMargin)),sessionStorage.setItem("pltPositionMargin",String(Bs?.diffPltPositionMargin)),sessionStorage.setItem("edgeShotType",String(Bs?.edgeShotType)),sessionStorage.setItem("iaRootPath",String(Bs?.iaRootPath)),sessionStorage.setItem("keepPage",String(Bs?.keepPage));break;default:break}},Gs=async()=>{Ks.value=pt.rbcClassList.map((e=>({...e,classInfo:e.classInfo.map((t=>{const a=gt.find((a=>a.categoryId===e.categoryId&&a.classId===t.classId));return{...t,degree1:a?.degree1||0,degree2:a?.degree2||0,degree3:a?.degree3||0}}))})))},Hs={key:0,class:"loaderBackgroundForLogin"},Vs=(0,s.Lk)("div",{class:"loaderForLogin"},null,-1),js=(0,s.Lk)("p",{class:"loadingTextLogin"},"Loading...",-1),Ys=[Vs,js],qs={class:"uimdLogin"},Qs={class:"loginContent"},Js=(0,s.Lk)("p",{class:"loginTitle"},[(0,s.Lk)("span",{class:"loginColorSpan"},"U"),(0,s.eW)("IMD")],-1),zs=(0,s.Lk)("p",{class:"loginP mt2"},"Unique Idea Medical Device",-1),Zs={class:"mt3 loginDiv"},eo={class:"loginUl"};var to=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)(""),n=(0,o.KR)(""),i=((0,s.nI)(),(0,o.KR)(!1)),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,s.EW)((()=>t.state.commonModule.isTcpConnected)),v=(0,o.KR)(!1),p=(0,o.KR)("");(0,s.sV)((async()=>{p.value=window.FORCE_VIEWER,await y(),g()}));const g=()=>{const e=JSON.parse(localStorage.getItem("user")||"{}");e.userId&&e.password&&(n.value=e.userId,a.value=e.password,I())},f=()=>{VC.push("/user/join")},I=async()=>{const e={userId:n.value,password:a.value};if(""!==e.userId&&""!==e.password)try{const a=await gs(e);a?.data?.user?(await Us(),await t.dispatch("userModule/setUserAction",a.data?.user),sessionStorage.setItem("user",JSON.stringify(a.data.user)),d.value&&localStorage.setItem("user",JSON.stringify(a.data.user)),await b(a?.data?.user.userId)):h("Login failed.")}catch(l){h("server Err."),console.log(l)}else h("Login failed.")},y=async()=>{try{const e=await Ot();"1"===e.data||window.APP_API_BASE_URL&&window.APP_API_BASE_URL.includes(e.data)?v.value=!1:v.value=!0}catch(e){console.log(e)}},b=async e=>{try{const e=await Ot();("1"===e.data||window.APP_API_BASE_URL&&window.APP_API_BASE_URL.includes(e.data))&&"viewer"!==window.FORCE_VIEWER?(await t.dispatch("commonModule/setCommonInfo",{viewerCheck:"main"}),await C("main"),sessionStorage.setItem("viewerCheck","main"),sessionStorage.setItem("pcIp",JSON.stringify(e.data))):(await t.dispatch("commonModule/setCommonInfo",{viewerCheck:"viewer"}),await C("viewer"),sessionStorage.setItem("viewerCheck","viewer"),sessionStorage.setItem("pcIp",JSON.stringify(e.data)))}catch(a){console.log(a)}},C=async e=>{h("login successful."),"main"===e?(await VC.push("/"),await document.documentElement.requestFullscreen()):(await VC.push("/dataBase"),await document.documentElement.requestFullscreen()),await t.dispatch("commonModule/setCommonInfo",{loginSetData:""}),await t.dispatch("commonModule/setCommonInfo",{resFlag:!1})},h=e=>{i.value=!0,r.value="success",u.value=e},S=()=>{i.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,["main"!==p.value||v.value||m.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Hs,Ys)),(0,s.Lk)("div",qs,[(0,s.Lk)("div",Qs,[Js,zs,(0,s.Lk)("div",Zs,[(0,s.Lk)("ul",eo,[(0,s.Lk)("li",null,[(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"ID"},null,512),[[l.Jo,n.value]])]),(0,s.Lk)("li",null,[(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.value=e),placeholder:"password"},null,512),[[l.Jo,a.value]])])]),(0,s.Lk)("div",{class:"loginBtn"},[(0,s.Lk)("button",{type:"button",onClick:I},"Login"),(0,s.Lk)("button",{type:"button",onClick:f},"Add User")])])])]),i.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":i.value,type:r.value,message:u.value,onHide:S,"onUpdate:hideAlert":S},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const ao=to;var lo=ao,so=a(2903);const oo=ee(),no=async e=>oo.httpPost(te.download.backUpDate,e),io=async e=>oo.httpPost(te.download.checkIsPossibleToBackup,e),ro=async e=>oo.httpPost(te.download.openDrive,e),co=async e=>oo.httpPost(te.upload.restoreData,e),uo=async e=>oo.httpPost(te.upload.checkDuplicated,e),mo=async e=>oo.httpPost(te.upload.checkPossibleUploadFile,e),vo={class:"loadingBackground"},po={class:"progressContainer"},go={class:"loadingProgressBarText"},fo={key:0,class:"loadingBackground"},Io=(0,s.Lk)("div",{class:"loaderForLogin"},null,-1),yo=(0,s.Lk)("p",{class:"loadingTextLogin"},"Loading...",-1),bo=[Io,yo],Co={class:"settingCellImgAnalyzedContainer"},ho={class:"settingTable"},So={key:0},ko=(0,s.Lk)("th",null,"Analysis Type",-1),No={colspan:"2"},_o=["value"],Eo={key:1},wo={key:0,rowspan:"1"},Ro={key:1},Lo=(0,s.Lk)("th",null,"Cell Analyzing Count",-1),To=["value"],Po={key:2},Ao=["rowspan"],Do=(0,s.Lk)("th",null," Cell Analyzing Count ",-1),Mo=["value"],xo={key:3},Ko={key:0},Oo=(0,s.Lk)("th",null,"Stitch Count",-1),Bo=["value"],Fo=(0,s.Lk)("th",null,"Edge Shot Type",-1),Uo=["value"],$o={key:4},Wo=(0,s.Lk)("th",null,"BF Analysis Values",-1),Xo=(0,s.Lk)("th",null,"Cell Analyzing Count",-1),Go=["value"],Ho={key:5},Vo=(0,s.Lk)("th",{rowspan:"3"},"Common",-1),jo=(0,s.Lk)("th",null,"Wbc Position Margin",-1),Yo=["value"],qo={key:6},Qo=(0,s.Lk)("th",null,"Rbc Position Margin",-1),Jo=["value"],zo={key:7},Zo=(0,s.Lk)("th",null,"Plt Position Margin",-1),en=["value"],tn={colspan:"2"},an=["value"],ln={key:8},sn={key:9},on={key:10},nn={class:"settingTable auto"},rn=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"90"}),(0,s.Lk)("col",{width:"10"})],-1),cn={class:"downloadSavePathContainer"},un=["value"],dn={title:"Download data from start to end date"},mn={class:"backupDatePickers"},vn={colspan:"2"},pn={class:"settingUploadContainer"},gn=["value"],fn={key:0,class:"fs12",style:{top:"0"}},In={key:1,class:"fs12"},yn=(0,s.Lk)("span",{style:{color:"red"}},"duplicated",-1),bn={key:2,class:"uploadDuplicatedSlotContainer"},Cn=(0,s.Lk)("p",{style:{color:"black"}},"Duplicated Barcode Numbers",-1),hn={class:"uploadDuplicatedSlotWrapper"},Sn={class:"uploadModalBtnContainer"},kn=(0,s.Lk)("p",{class:"fs12",style:{top:"0"}},"Upload file list",-1),Nn={class:"downloadDeleteContainer"},_n=(0,s.Lk)("p",{class:"downloadDeleteSemiTitle"},"Select upload file",-1),En={class:"downloadDeleteWrapper"},wn={style:{"font-size":"0.8rem"}},Rn=["value"],Ln={class:"mt4"},Tn={class:"uploadModalBtnContainer"};var Pn=(0,s.pM)({__name:"cellImageAnalyzed",setup(e){const t=(0,s.nI)(),a=(0,c.Pj)(),i=(0,r.rd)(),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,o.KR)([]),g=(0,o.KR)("01"),f=(0,o.KR)("100"),I=(0,o.KR)("0"),y=(0,o.KR)("0"),b=(0,o.KR)("0"),C=(0,o.KR)("100"),h=(0,o.KR)("1"),S=(0,o.KR)("0"),k=(0,o.KR)("100"),N=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\BMIA_proc":"D:\\PBIA_proc"),_=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\UIMD_BM_backup":"D:\\UIMD_PB_backup"),E=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\BMIA_proc":"D:\\PBIA_proc"),w=(0,o.KR)(!1),R=(0,o.KR)(!1),L=(0,o.KR)("5"),T=(0,o.KR)(!1),P=(0,o.KR)(V()().local().toDate()),A=(0,o.KR)(V()().local().toDate()),D=((0,o.KR)([{value:"Not selected"},{value:1},{value:2},{value:3},{value:4},{value:5},{value:6},{value:7},{value:8},{value:9},{value:10},{value:11},{value:12}]),(0,o.KR)("Not selected")),M=(0,o.KR)(""),x=(0,o.KR)([]),K=(0,o.KR)([]),O=(0,o.KR)(""),B=(0,o.KR)("pb"),F=(0,o.KR)([]),U=(0,o.KR)({duplicated:[],nonDuplicated:[]}),$=(0,s.EW)((()=>U.value?.nonDuplicated&&U.value?.nonDuplicated.length)),W=(0,s.EW)((()=>U.value?.duplicated&&U.value?.duplicated.length)),X=(0,o.KR)(!1),H=(0,o.KR)(""),j=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),Y=(0,s.EW)((()=>a.state.commonModule.enteringRouterPath)),q=(0,s.EW)((()=>a.state.commonModule.settingChangedChecker)),Q=(0,s.EW)((()=>a.state.commonModule.settingType)),J=(0,o.KR)(!1),z=(0,o.KR)(!1),Z=(0,o.KR)(!1),ee=(0,o.KR)(!1),te=(0,o.KR)(""),ae=(0,o.KR)({}),ne=(0,o.KR)(1),ie=(0,o.KR)(0),re=(0,o.KR)("copy"),ce=(0,o.KR)(null),ue=(0,o.KR)({}),de=(0,o.KR)(""),me=(0,o.KR)(!1),ve=(0,o.KR)([]),pe=(0,o.KR)("");(0,s.sV)((async()=>{await(0,s.dY)(),g.value="bm"===window.PROJECT_TYPE?"02":"01",B.value="bm"===window.PROJECT_TYPE?"bm":"pb",F.value="bm"===window.PROJECT_TYPE?st:lt,p.value="bm"===window.PROJECT_TYPE?nt:ot,await a.dispatch("commonModule/setCommonInfo",{settingType:Lt.cellImageAnalyzed}),await ye(),await fe()})),(0,s.wB)([g,f,f,I,y,b,C,S,h,k,N,w,R,L,T],(async()=>{const e={id:O.value,analysisType:g.value,diffCellAnalyzingCount:f.value,diffWbcPositionMargin:I.value,diffRbcPositionMargin:y.value,diffPltPositionMargin:b.value,pbsCellAnalyzingCount:C.value,stitchCount:h.value,edgeShotType:S.value,bfCellAnalyzingCount:k.value,iaRootPath:N.value,isNsNbIntegration:w.value,isAlarm:R.value,alarmCount:L.value,keepPage:T.value};await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),Q.value!==Lt.cellImageAnalyzed&&await a.dispatch("commonModule/setCommonInfo",{settingType:Lt.cellImageAnalyzed})})),(0,s.wB)((()=>q.value),(()=>{Ie()}));const ge=e=>{const t=e.target,a=t.value.replace(/[^0-9]/g,"");L.value=a.trim()},fe=async()=>{try{const e=await Xe();if(e)if(e?.data){const t=e.data,a=JSON.parse(JSON.stringify(t)),l=JSON.parse(JSON.stringify(t)),s="bm"===window.PROJECT_TYPE?"BMIA_proc":"PBIA_proc",o="bm"===window.PROJECT_TYPE?"UIMD_BM_backup":"UIMD_PB_backup";for(const e in t)a[e]=a[e]+`\\${s}`,l[e]=l[e]+`\\${o}`;x.value=a,K.value=l}else;}catch(e){console.log(e)}},Ie=()=>{X.value=!0,H.value=`${Q.value} ${G.settingNotSaved}`},ye=async()=>{try{const e=await se();if(e)if(e?.data){M.value="put";const t=e.data;O.value=String(t.id),g.value=t.analysisType,f.value=t.diffCellAnalyzingCount,I.value=t.diffWbcPositionMargin,y.value=t.diffRbcPositionMargin,b.value=t.diffPltPositionMargin,C.value=t.pbsCellAnalyzingCount,h.value=t.stitchCount,k.value=t.bfCellAnalyzingCount,S.value=String(t?.edgeShotType),N.value=t.iaRootPath,_.value=t.backupPath||("bm"===window.PROJECT_TYPE?"D:\\UIMD_BM_backup":"D:\\UIMD_PB_backup"),w.value=t.isNsNbIntegration,R.value=t.isAlarm,L.value=t.alarmCount,T.value=t.keepPage,P.value=V()(t.backupStartDate).local().toDate(),A.value=V()(t.backupEndDate).local().toDate(),D.value=t?.autoBackUpMonth;const l={id:O.value,analysisType:t?.analysisType,diffCellAnalyzingCount:t?.diffCellAnalyzingCount,diffWbcPositionMargin:t?.diffWbcPositionMargin,diffRbcPositionMargin:t?.diffRbcPositionMargin,diffPltPositionMargin:t?.diffPltPositionMargin,pbsCellAnalyzingCount:t?.pbsCellAnalyzingCount,stitchCount:t?.stitchCount,edgeShotType:t?.edgeShotType,bfCellAnalyzingCount:t?.bfCellAnalyzingCount,iaRootPath:t?.iaRootPath,isNsNbIntegration:t?.isNsNbIntegration,isAlarm:t?.isAlarm,alarmCount:t?.alarmCount,keepPage:t?.keepPage};await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(l)}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(l)})}else M.value="post"}catch(e){console.log(e)}},be=async()=>{const e={analysisType:g.value,diffCellAnalyzingCount:f.value,diffWbcPositionMargin:I.value,diffRbcPositionMargin:y.value,diffPltPositionMargin:b.value,pbsCellAnalyzingCount:C.value,edgeShotType:S.value,stitchCount:h.value,bfCellAnalyzingCount:k.value,iaRootPath:N.value,isNsNbIntegration:w.value,isAlarm:R.value,alarmCount:L.value,keepPage:T.value,backupPath:_.value,backupStartDate:V()(P.value).add(1,"day").local().toDate().toISOString().split("T")[0],backupEndDate:V()(A.value).add(1,"day").local().toDate().toISOString().split("T")[0],autoBackUpMonth:D.value,autoBackUpStartDate:"Not selected"!==D.value?V()(new Date).local().toDate().toISOString().split("T")[0]:null};try{let t={};if(t="post"===M.value?await le(e):await oe(e,O.value),t){const e="post"===M.value?G.settingSaveSuccess:G.UPDATE_SUCCESSFULLY;_e(e);const l=t?.data;await a.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:l?.isNsNbIntegration?"Y":"N"}),await a.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:l?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",l.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",l?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",l?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",l?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(l?.edgeShotType)),sessionStorage.setItem("iaRootPath",l?.iaRootPath);const s="pb"===B.value?"keepPage":"bmKeepPage";sessionStorage.setItem(s,String(l?.keepPage)),await a.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!0})}await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}catch(t){console.log(t)}},Ce=()=>{w.value=!w.value},he=()=>{R.value=!R.value},Se=()=>{T.value=!T.value},ke=async e=>{m.value=!1,ne.value=$.value;try{Z.value=!0;const t=localStorage.getItem("lastSearchParams")||"",{startDate:l,endDate:s,page:o,searchText:n,nrCount:i,testType:r,wbcInfo:c,wbcTotal:u}=JSON.parse(t),d=l+s+o+n+i+r+c+u,m={fileName:pe.value,destinationUploadPath:E.value,originUploadPath:_.value,dayQuery:d,projectType:B.value,uploadType:e};re.value=e,de.value="move"===e?"moved":"copied",ie.value=0,await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Ae(!0),Pe();const v=await co(m);"string"===typeof v.data?Ee(v.data):_e("Upload completed successfully")}catch(t){console.log(t)}finally{ie.value=ne.value,clearInterval(ce.value),Ae(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1})}await Me("Upload")},Ne=async()=>{m.value=!1},_e=e=>{u.value=!0,d.value="success",v.value=e},Ee=e=>{u.value=!0,d.value="error",v.value=e},we=()=>{u.value=!1},Re=async()=>{await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),X.value=!1,await i.push(Y.value)},Le=async()=>{await be(),X.value=!1},Te=()=>{ee.value=!1},Pe=async()=>{const e=String(ne.value).length;ce.value=setInterval((async()=>{ie.value+=1,ie.value===ne.value-1&&clearInterval(ce.value)}),1500*e)},Ae=e=>{t?.appContext.config.globalProperties.$socket.emit("isDownloadUploading",{type:"SEND_DATA",payload:e})},De=async e=>{const t=xe(e);await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Ae(!0),de.value="move"===e?"moved":"copied",ie.value=0;try{Pe(),await no(t)}catch(l){console.log(l)}finally{clearInterval(ce.value),ie.value=ne.value,Ae(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1})}await Me("Download")},Me=async e=>{ie.value=ne.value,setTimeout((async()=>{ne.value=0,ie.value=0,Z.value=!1}),2e3),await _e(`${e} Success`)},xe=e=>{re.value=e,ee.value=!1;const t=localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(t),u=a+l+s+o+n+i+r+c,d=V()(P.value).add(1,"day").local().toDate().toISOString().split("T")[0],m=V()(A.value).add(1,"day").local().toDate().toISOString().split("T")[0],v={startDate:d,endDate:m,originDownloadPath:`${N.value}`,destinationDownloadPath:_.value,projectType:B.value,dayQuery:u,downloadType:e};return Z.value=!0,v},Ke=async()=>{if(""===_.value)return void Ee("Please select a download save path");const e=V()(P.value).add(1,"day").local().toDate().toISOString().split("T")[0],t=V()(A.value).add(1,"day").local().toDate().toISOString().split("T")[0];if(V()(e).isSameOrBefore(t)){ae.value={startDate:e,endDate:t,originDownloadPath:`${N.value}`,destinationDownloadPath:_.value,projectType:B.value};try{await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Ae(!0),z.value=!0;const e=await io(ae.value);e.data.success?(ne.value=Number(e.data.message.split(" ")[1]),ee.value=!0,te.value="Would you like to copy files?"):Ee(e.data.message)}catch(l){console.log(l)}finally{z.value=!1,Ae(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1})}}else Ee("Please check the date")},Oe=async()=>{const e={originUploadPath:_.value};try{const t=await mo(e);t.success&&(ve.value=t.data)}catch(t){console.log(t),ve.value=[]}finally{me.value=!0}},Be=async()=>{const e={originDownloadPath:_.value};try{await ro(e)}catch(t){ue.value=[],console.log(t)}},Fe=async()=>{try{J.value=!0;const e={fileName:pe.value,destinationUploadPath:E.value,originUploadPath:_.value,projectType:B.value};await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Ae(!0);const t=await uo(e);"string"===typeof t.data?Ee(t.data):(ne.value=t.data.totalMove,ie.value=t.data.successMove,m.value=!0,U.value=t.data)}catch(e){console.log(e)}finally{Ae(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1}),J.value=!1}me.value=!1},Ue=()=>{me.value=!1,pe.value=""};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",vo,[(0,s.Lk)("div",po,[(0,s.Lk)("p",go,(0,n.v_)(ie.value)+" / "+(0,n.v_)(ne.value)+" files "+(0,n.v_)(de.value)+"...",1),(0,s.Lk)("div",{class:"progressBar",style:(0,n.Tr)({width:ie.value/ne.value*100+"%"})},null,4)])],512),[[l.aG,Z.value]]),J.value||z.value?((0,s.uX)(),(0,s.CE)("div",fo,bo)):(0,s.Q3)("",!0),(0,s.Lk)("div",Co,[(0,s.Lk)("table",ho,[(0,s.Lk)("tbody",null,["viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",So,[ko,(0,s.Lk)("td",No,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(F.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,_o)))),128))],512),[[l.u1,g.value]])])])):(0,s.Q3)("",!0),"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",Eo,["pb"===B.value?((0,s.uX)(),(0,s.CE)("th",wo,"WBC Diff Analysis Values")):(0,s.Q3)("",!0),"bm"===B.value?((0,s.uX)(),(0,s.CE)("th",Ro,"BM Diff Analysis Values")):(0,s.Q3)("",!0),Lo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,To)))),128))],512),[[l.u1,f.value]])])])):(0,s.Q3)("",!0),"pb"===B.value&&"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",Po,[(0,s.Lk)("th",{rowspan:"pb"===B.value&&"04"===g.value?3:2},"PBS Analysis Values",8,Ao),Do,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>C.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(ot),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Mo)))),128))],512),[[l.u1,C.value]])])])):(0,s.Q3)("",!0),"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",xo,["bm"===B.value?((0,s.uX)(),(0,s.CE)("th",Ko)):(0,s.Q3)("",!0),Oo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(rt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Bo)))),128))],512),[[l.u1,h.value]])])])):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("tr",null,[Fo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>S.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(ct),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Uo)))),128))],512),[[l.u1,S.value]])])],512),[[l.aG,"pb"===B.value&&"04"===g.value&&"viewer"!==j.value]]),"pb"===B.value&&"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",$o,[Wo,Xo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(ot),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Go)))),128))],512),[[l.u1,k.value]])])])):(0,s.Q3)("",!0),"pb"===B.value&&"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",Ho,[Vo,jo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>I.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(dt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Yo)))),128))],512),[[l.u1,I.value]])])])):(0,s.Q3)("",!0),"pb"===B.value&&"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",qo,[Qo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>y.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(ut),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Jo)))),128))],512),[[l.u1,y.value]])])])):(0,s.Q3)("",!0),"pb"===B.value&&"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",zo,[Zo,(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>b.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(ut),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,en)))),128))],512),[[l.u1,b.value]])])])):(0,s.Q3)("",!0),(0,s.Lk)("tr",null,[(0,s.Lk)("th",{style:(0,n.Tr)("viewer"===j.value&&"width: 214px;")},[(0,s.eW)(" IA Root Path "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_IA_ROOT_PATH_KO},null,8,["title"])],4),(0,s.Lk)("td",tn,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>N.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,an)))),128))],512),[[l.u1,N.value]])])]),"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",ln,[(0,s.Lk)("th",null,[(0,s.eW)(" NS/NB Integration "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_NS_NB_INTEGRATION_KO},null,8,["title"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:w.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:Ce},null,8,["icon"])])])):(0,s.Q3)("",!0),"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",sn,[(0,s.Lk)("th",null,[(0,s.eW)(" Alarm Timer (sec) "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_ALARM_TIME_KO},null,8,["title"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:R.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:he},null,8,["icon"])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>L.value=e),class:"alarmInput",onInput:t[11]||(t[11]=e=>ge(e))},null,544),[[l.Jo,L.value]])])])):(0,s.Q3)("",!0),"viewer"!==j.value?((0,s.uX)(),(0,s.CE)("tr",on,[(0,s.Lk)("th",null,[(0,s.eW)(" Keep Page "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_KEEP_PAGE_KO},null,8,["title"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:T.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:Se},null,8,["icon"])])])):(0,s.Q3)("",!0)])]),(0,s.Lk)("table",nn,[rn,(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,[(0,s.eW)(" Download Save Path "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_DOWNLOAD_SAVE_PATH_KO},null,8,["title"])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",cn,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>_.value=e),class:"downloadPath"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(K.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,un)))),128))],512),[[l.u1,_.value]]),(0,s.bF)(a,{icon:["fas","folder-open"],onClick:Be,class:"openDriveIcon"})])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("th",dn,[(0,s.eW)(" Download "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_DOWNLOAD_KO},null,8,["title"])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",mn,[(0,s.bF)((0,o.R1)(so.A),{modelValue:P.value,"onUpdate:modelValue":t[13]||(t[13]=e=>P.value=e)},null,8,["modelValue"]),(0,s.bF)((0,o.R1)(so.A),{modelValue:A.value,"onUpdate:modelValue":t[14]||(t[14]=e=>A.value=e)},null,8,["modelValue"]),(0,s.Lk)("button",{class:"backupBtn",onClick:Ke},"Download")])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,[(0,s.eW)(" Upload "),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(G).SETTING_INFO_UPLOAD_KO},null,8,["title"])]),(0,s.Lk)("td",vn,[(0,s.Lk)("div",pn,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[15]||(t[15]=e=>E.value=e),class:"uploadSavePath"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,gn)))),128))],512),[[l.u1,E.value]]),(0,s.Lk)("button",{class:"uploadBtn",onClick:Oe},"Upload")])])])])]),(0,s.Lk)("button",{class:"saveBtn mb2",type:"button",onClick:t[16]||(t[16]=e=>be())},"Save")]),m.value?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,n.C4)(0===W.value?"uploadModalSmall":"uploadModal")},[0===W.value?((0,s.uX)(),(0,s.CE)("p",fn,"Would you like to upload?")):W.value>0?((0,s.uX)(),(0,s.CE)("pre",In,[(0,s.eW)("      There are "),yn,(0,s.eW)(" items\n      Would you like to upload possible items?\n    ")])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)(0===W.value&&"uploadModalCountWrapperSmall")},[(0,s.Lk)("p",null,"Movable Items Count: "+(0,n.v_)($.value),1),(0,s.Lk)("p",null,"Duplicated Count: "+(0,n.v_)(W.value),1)],2),W.value>0?((0,s.uX)(),(0,s.CE)("div",bn,[Cn,(0,s.Lk)("ul",hn,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(U.value?.duplicated,(e=>((0,s.uX)(),(0,s.CE)("li",{class:"userSelectText",key:e},(0,n.v_)(e),1)))),128))])])):(0,s.Q3)("",!0),(0,s.Lk)("div",Sn,[(0,s.bo)((0,s.Lk)("button",{class:"memoModalBtn",onClick:t[17]||(t[17]=e=>ke("copy"))},(0,n.v_)((0,o.R1)(G).COPY),513),[[l.aG,$.value>0]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Ne},(0,n.v_)(0===W.value?(0,o.R1)(G).CANCEL:(0,o.R1)(G).CLOSE),1)])],2)):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",{class:(0,n.C4)(0===ve.value.length?"downloadDeleteSmallModal":"downloadDeleteModal")},[kn,(0,s.bo)((0,s.Lk)("div",Nn,[_n,(0,s.Lk)("ul",En,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ve.value,(e=>((0,s.uX)(),(0,s.CE)("li",{class:"userSelectText flexSpaceBetween",key:e},[(0,s.Lk)("p",wn,(0,n.v_)(e),1),(0,s.bo)((0,s.Lk)("input",{style:{margin:"0"},"onUpdate:modelValue":t[18]||(t[18]=e=>pe.value=e),type:"radio",value:e},null,8,Rn),[[l.XL,pe.value]])])))),128))])],512),[[l.aG,ve.value.length>0]]),(0,s.bo)((0,s.Lk)("p",Ln,"No files",512),[[l.aG,0===ve.value.length]]),(0,s.Lk)("div",Tn,[ve.value.length>0?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("button",{class:"memoModalBtn",onClick:Fe},(0,n.v_)((0,o.R1)(G).UPLOAD),1),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Ue},(0,n.v_)((0,o.R1)(G).CANCEL),1)],64)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"memoModalBtn",onClick:Ue},(0,n.v_)((0,o.R1)(G).CLOSE),1))])],2),[[l.aG,me.value]]),X.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:2,"is-visible":X.value,message:H.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:Re,onOkConfirm:Le},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),ee.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:3,"is-visible":ee.value,message:te.value,confirmText:(0,o.R1)(G).COPY,closeText:(0,o.R1)(G).CLOSE,onHide:Te,onOkConfirm:t[19]||(t[19]=e=>De("copy"))},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),u.value?((0,s.uX)(),(0,s.Wv)(at,{key:4,"is-visible":u.value,type:d.value,message:v.value,onHide:we,"onUpdate:hideAlert":we},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const An=Pn;var Dn=An;const Mn={class:"mb1 fs12"},xn={class:"mb1"},Kn={class:"mt1"},On={class:"degreeInput mb1"},Bn=["onUpdate:modelValue"],Fn=["onUpdate:modelValue"],Un=["onUpdate:modelValue"];var $n=(0,s.pM)({__name:"rbcDegree",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.Kh)({value:[]}),u=(0,o.KR)("post"),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),y=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await k(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.rbcDegree})})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),y.value!==Lt.rbcDegree&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.rbcDegree})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{b()}));const b=()=>{p.value=!0,g.value=`${y.value} ${G.settingNotSaved}`},C=async()=>{i.value=pt.rbcClassList.map((e=>({...e,classInfo:e.classInfo.map((t=>{const a=gt.find((a=>a.categoryId===e.categoryId&&a.classId===t.classId));return{...t,degree1:a?.degree1||0,degree2:a?.degree2||0,degree3:a?.degree3||0}}))})))},h=()=>{C()},S=async()=>{const e=[];i.value.forEach((t=>{t.classInfo.forEach((a=>{e.push({categoryId:t.categoryId,categoryNm:t.categoryNm,classId:a.classId,classNm:a.classNm,degree1:a.degree1,degree2:a.degree2,degree3:a.degree3})}))}));try{let t={};t="post"===u.value?await ne(e):await ie(e),t&&(_(G.settingSaveSuccess),u.value="put")}catch(a){E(G.settingSaveFailure),console.error(a)}finally{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}},k=async()=>{try{const e=await re();u.value="put";const t=e.data;N(t)}catch(e){u.value="post",await C()}await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(i.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)})},N=e=>{const t=new Map;e.forEach((e=>{const a=e.categoryId,l=e.classId;if(t.has(a)){const s=t.get(a),o=s.classInfo.findIndex((e=>e.classId===l));-1===o?s.classInfo.push({classId:l,classNm:e.classNm,degree1:e.degree1,degree2:e.degree2,degree3:e.degree3}):s.classInfo[o].degree=e.degree}else{const s={categoryId:a,categoryNm:e.categoryNm,classInfo:[{classId:l,classNm:e.classNm,degree1:e.degree1,degree2:e.degree2,degree3:e.degree3}]};t.set(a,s)}})),i.value=Array.from(t.values())},_=e=>{d.value=!0,m.value="success",v.value=e},E=e=>{d.value=!0,m.value="error",v.value=e},w=()=>{d.value=!1},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},L=async()=>{await S(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{class:"mt2 mb4 rbcClassListArr",key:"rbc"+t},[(0,s.Lk)("div",Mn,(0,n.v_)(e?.categoryNm),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.classInfo,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},["Normal"!==e.classNm?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("span",null,(0,n.v_)(e.classNm),1),(0,s.Lk)("div",xn," [ "+(0,n.v_)(`${e.degree1} , ${e.degree2} , ${e.degree3}`)+" ] ",1),(0,s.Lk)("div",Kn,[(0,s.Lk)("div",On,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.degree1=t},null,8,Bn),[[l.Jo,e.degree1]]),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.degree2=t},null,8,Fn),[[l.Jo,e.degree2]]),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.degree3=t},null,8,Un),[[l.Jo,e.degree3]])])])],64)):(0,s.Q3)("",!0)])))),128))])))),128))]),(0,s.Lk)("div",{class:"mt-2 degreeDiv"},[(0,s.Lk)("button",{class:"saveBtn mb2",onClick:h},"Reset"),(0,s.Lk)("button",{class:"saveBtn mb2",type:"button",onClick:S},"Save")])]),p.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":p.value,message:g.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:R,onOkConfirm:L},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Wn=$n;var Xn=Wn;const Gn={class:"customSettingContainer"},Hn=(0,s.Lk)("p",{class:"mb1"},"Gripper Open",-1),Vn={class:"mt2"},jn=(0,s.Lk)("p",{class:"mb1"},"Camera Reset",-1),Yn=(0,s.Lk)("p",{class:"mb1"},"Charge Remaining Count",-1);var qn=(0,s.pM)({__name:"deviceControls",setup(e){const t=(0,o.KR)(!1),a=(0,o.KR)(""),l=(0,o.KR)(""),i=(0,c.Pj)(),r=(0,o.KR)(""),u=(0,s.EW)((()=>i.state.userModule)),d=(0,s.EW)((()=>i.state.commonModule)),m=(0,o.KR)(!1),v=(0,o.KR)(!1),p=(0,o.KR)(!1);let g=null,f=null;(0,s.sV)((async()=>{const e=JSON.parse(JSON.stringify(u.value));r.value=e.userId})),(0,s.wB)([d.value],(async e=>{await(0,s.dY)();const[t]=e,{isRunningState:a}=t||{};m.value=a}));const I=async()=>{await je()},y=()=>{null!==g&&clearTimeout(g),v.value=!0,z().embedStatus.gripperOpen.reqUserId=r.value,Je.publish("childEmitSocketData",z().embedStatus.gripperOpen),g=setTimeout((()=>{v.value=!1,g=null}),500)},b=()=>{null!==f&&clearTimeout(f),p.value=!0,z().embedStatus.gripperOpen.reqUserId=r.value,Je.publish("childEmitSocketData",z().embedStatus.cameraReset),f=setTimeout((()=>{p.value=!1,f=null}),500)},C=()=>{t.value=!1};return(e,o)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Gn,[(0,s.Lk)("li",null,[Hn,(0,s.Lk)("button",{onClick:y,class:(0,n.C4)({defaultBtn:!0,blinkGripper:v.value})},"OK",2)]),(0,s.Lk)("li",Vn,[jn,(0,s.Lk)("button",{type:"button",class:(0,n.C4)(["defaultBtn",{defaultBtn:!0,blinkGripper:p.value}]),onClick:b},"OK ",2)]),(0,s.Lk)("li",{class:"mt2"},[Yn,(0,s.Lk)("button",{type:"button",class:"defaultBtn",onClick:I},"Scan")])])]),t.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":t.value,type:a.value,message:l.value,onHide:C,"onUpdate:hideAlert":C},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Qn=qn;var Jn=Qn;const zn={class:"customClass customSettingContainer"},Zn=["onUpdate:modelValue","onInput"],ei=["onUpdate:modelValue","onInput"];var ti=(0,s.pM)({__name:"customClass",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=[{customNum:90,abbreviation:"",fullNm:""},{customNum:91,abbreviation:"",fullNm:""},{customNum:92,abbreviation:"",fullNm:""},{customNum:93,abbreviation:"",fullNm:""},{customNum:94,abbreviation:"",fullNm:""}],d=(0,o.KR)([]),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,o.KR)(""),g=(0,o.KR)(!1),f=(0,o.KR)(!1),I=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),C=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.KC)((()=>{g.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{await N(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcCustomClass})})),(0,s.wB)((()=>d.value),(async e=>{_()&&await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),C.value!==Lt.wbcCustomClass&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcCustomClass})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{h()}));const h=()=>{f.value=!0,I.value=`${C.value} ${G.settingNotSaved}`},S=async()=>{if(_())try{let e;if("post"!==i.value){const e=await ue({classArr:d.value});return e.data?(E(G.UPDATE_SUCCESSFULLY),await N()):w(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await ce({classArr:d.value}),e&&(E(G.settingSaveSuccess),i.value="put",await N(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.log(e)}},k=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9]/g,"");t[a]=s.trim()},N=async()=>{try{const e=await de();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",d.value=u):(i.value="put",d.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(d.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(d.value)}))}catch(e){console.log(e)}},_=()=>{let e,t;g.value?(e=wa.map((e=>e.fullNm)),t=wa.map((e=>e.abbreviation))):(e=Ea.map((e=>e.fullNm)),t=Ea.map((e=>e.abbreviation)));for(const a of d.value){if(""===a.fullNm&&""!==a.abbreviation)return w("You should enter abbreviation"),!1;if(""!==a.fullNm&&""===a.abbreviation)return w("You should enter class name"),!1;if(t.includes(a.abbreviation))return w(`${a.abbreviation} is existing abbreviation`),!1;if(e.includes(a.fullNm))return w(`${a.fullNm} is existing class name`),!1;if("OT"===a.abbreviation)return w("Can't use OT abbreviation!"),!1}return!0},E=e=>{m.value=!0,v.value="success",p.value=e},w=e=>{m.value=!0,v.value="error",p.value=e},R=()=>{m.value=!1},L=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),f.value=!1,await a.push(y.value)},T=async()=>{await S(),f.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",zn,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,"ID: "+(0,n.v_)(e.customNum),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.abbreviation=t,type:"text",maxlength:"3",placeholder:"abbreviation",onInput:t=>k(t,e,"abbreviation")},null,40,Zn),[[l.Jo,e.abbreviation]])]),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.fullNm=t,type:"text",maxlength:"25",placeholder:"class name",onInput:t=>k(t,e,"fullNm")},null,40,ei),[[l.Jo,e.fullNm]])])])))),128))]),(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:S},"Save")]),f.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":f.value,message:I.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:L,onOkConfirm:T},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),m.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":m.value,type:v.value,message:p.value,onHide:R,"onUpdate:hideAlert":R},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const ai=ti;var li=ai;const si={class:"wbcHotKeysItems"},oi=["onUpdate:modelValue","onInput"];var ni=(0,s.pM)({__name:"wbcHotKeys",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)("pb"),g=(0,o.KR)(!1),f=(0,o.KR)(""),I=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.KC)((()=>{p.value="bm"===window.PROJECT_TYPE?"bm":"pb"})),(0,s.sV)((async()=>{await k(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcHotKeys})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==Lt.wbcHotKeys&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcHotKeys})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{C()}));const C=()=>{g.value=!0,f.value=`${b.value} ${G.settingNotSaved}`},h=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9]/g,"");t[a]=s.trim()},S=async()=>{try{let e;if("post"!==i.value){const e=await ve({wbcHotKeysItems:u.value});return e.data?(N(G.UPDATE_SUCCESSFULLY),await k()):_(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await me({wbcHotKeysItems:u.value}),e&&(N(G.settingSaveSuccess),i.value="put",await k(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.log(e)}},k=async()=>{try{const e=await pe();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value="bm"===p.value?It:ft):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.log(e)}},N=e=>{d.value=!0,m.value="success",v.value=e},_=e=>{d.value=!0,m.value="error",v.value=e},E=()=>{d.value=!1},w=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),g.value=!1,await a.push(I.value)},R=async()=>{await S(),g.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",si,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,(0,n.v_)(e.abbreviation),1),(0,s.Lk)("span",null,(0,n.v_)(e.fullNm),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",maxlength:"1",placeholder:"hot key",onInput:t=>h(t,e,"key")},null,40,oi),[[l.Jo,e.key]])])])))),128))]),(0,s.Lk)("button",{onClick:S,class:"saveBtn",type:"button"},"Save")]),g.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":g.value,message:f.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:w,onOkConfirm:R},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const ii=ni;var ri=ii;const ci={class:"wbcHotKeysItems"},ui=["onUpdate:modelValue","onInput"];var di=(0,s.pM)({__name:"bfHotKeys",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),y=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.bfHotKeys})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),y.value!==Lt.bfHotKeys&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.bfHotKeys})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{b()}));const b=()=>{p.value=!0,g.value=`${y.value} ${G.settingNotSaved}`},C=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9]/g,"");t[a]=s.trim()},h=async()=>{try{let e;if("post"!==i.value){const e=await fe({bfHotKeysItems:u.value});return e.data?(k(G.UPDATE_SUCCESSFULLY),await S()):N(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await ge({bfHotKeysItems:u.value}),e&&(k(G.settingSaveSuccess),i.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.log(e)}},S=async()=>{try{const e=await Ie();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value=yt):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.log(e)}},k=e=>{d.value=!0,m.value="success",v.value=e},N=e=>{d.value=!0,m.value="error",v.value=e},_=()=>{d.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},w=async()=>{await h(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",ci,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,(0,n.v_)(e?.abbreviation),1),(0,s.Lk)("span",null,(0,n.v_)(e?.fullNm),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",maxlength:"1",placeholder:"hot key",onInput:t=>C(t,e,"key")},null,40,ui),[[l.Jo,e.key]])])])))),128))]),(0,s.Lk)("button",{onClick:h,class:"saveBtn",type:"button"},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":p.value,message:g.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:E,onOkConfirm:w},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:_,"onUpdate:hideAlert":_},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const mi=di;var vi=mi;const pi={class:"normalItems"},gi={class:"mt1"},fi=["onUpdate:modelValue","onInput"],Ii=["onInput","onUpdate:modelValue"];var yi=(0,s.pM)({__name:"normalRange",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),y=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.normalRange})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),y.value!==Lt.normalRange&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.normalRange})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{b()}));const b=()=>{p.value=!0,g.value=`${y.value} ${G.settingNotSaved}`},C=async()=>{try{let e;if("post"!==i.value){const e=await be({normalRangeItems:u.value});return e.data?(k(G.UPDATE_SUCCESSFULLY),await S()):N("update failed"),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await ye({normalRangeItems:u.value}),e&&(k(G.settingSaveSuccess),i.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.log(e)}},h=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^0-9]/g,"");t[a]=s.trim()},S=async()=>{try{const e=await Ce();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value=bt):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.log(e)}},k=e=>{d.value=!0,m.value="success",v.value=e},N=e=>{d.value=!0,m.value="error",v.value=e},_=()=>{d.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},w=async()=>{await C(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",pi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("div",null,(0,n.v_)(e.abbreviation)+" - "+(0,n.v_)(e.fullNm),1),(0,s.Lk)("div",gi,[(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.min=t,type:"text",maxlength:"25",placeholder:"class name",onInput:t=>h(t,e,"min")},null,40,fi),[[l.Jo,e.min]])]),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{onInput:t=>h(t,e,"max"),"onUpdate:modelValue":t=>e.max=t,type:"text",maxlength:"25",placeholder:"class name"},null,40,Ii),[[l.Jo,e.max]])]),(0,s.Lk)("span",null,(0,n.v_)(e.unit),1)])])))),128))]),(0,s.Lk)("button",{onClick:C,class:"saveBtn",type:"button"},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":p.value,message:g.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:E,onOkConfirm:w},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:_,"onUpdate:hideAlert":_},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const bi=yi;var Ci=bi;const hi={class:"wbcClassScroll"},Si=(0,s.Lk)("h1",{class:"classTitle"},"Class",-1),ki=["onDragstart","onDrop"],Ni={class:"nth1ChildOrder"};var _i=(0,s.pM)({__name:"classOrder",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)(-1),d=(0,o.KR)(0),m=(0,o.KR)(""),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(!1),I=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),C=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{i.value="bm"===window.PROJECT_TYPE?La:Ra,await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.classOrder}),await S()})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),C.value!==Lt.classOrder&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.classOrder})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{h()}));const h=()=>{f.value=!0,I.value=`${C.value} ${G.settingNotSaved}`},S=async()=>{try{const e=await He();if(e){0===e?.data.length?m.value="post":(m.value="put",i.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))));const a=i.value;await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(a)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(a)})}}catch(e){console.log(e)}},k=async()=>{let e=i.value;for(const t in e)e[t].orderIdx=t;try{let a={};if(a="post"===m.value?await Ge(e):await Ve(e),a){const e="post"===m.value?G.settingSaveSuccess:G.UPDATE_SUCCESSFULLY;E(e)}await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}catch(a){console.log(a)}},N=(e,t)=>{u.value=e,d.value=t.clientY-t.target.getBoundingClientRect().top},_=(e,t)=>{if(t.preventDefault(),-1!==u.value){const t=i.value.splice(u.value,1)[0];i.value.splice(e,0,t),u.value=-1}},E=e=>{v.value=!0,p.value="success",g.value=e},w=()=>{v.value=!1},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),f.value=!1,await a.push(y.value)},L=async()=>{await k(),f.value=!1,await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",hi,[Si,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv",draggable:"true",onDragstart:e=>N(a,e),onDragover:t[0]||(t[0]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>_(a,e)},[(0,s.Lk)("ul",Ni,[(0,s.Lk)("li",null,(0,n.v_)(e?.fullNm),1)])],40,ki)))),128))]),(0,s.Lk)("button",{onClick:k,class:"saveBtn",type:"button"},"Save"),f.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":f.value,message:I.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:R,onOkConfirm:L},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":v.value,type:p.value,message:g.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Ei=_i;var wi=Ei;const Ri={class:"alignDiv"},Li={class:"defaultTable",style:{margin:"auto"}},Ti=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"WBC min"),(0,s.Lk)("th",null,"WBC max"),(0,s.Lk)("th",null,"count")])],-1),Pi=["onUpdate:modelValue"],Ai=["onUpdate:modelValue"],Di=["onUpdate:modelValue"],Mi=["value"],xi={class:"mt1"};var Ki=(0,s.pM)({__name:"wbcRunningCount",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),y=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await C(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcRunningCount})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),y.value!==Lt.wbcRunningCount&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.wbcRunningCount})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{b()}));const b=()=>{p.value=!0,g.value=`${y.value} ${G.settingNotSaved}`},C=async()=>{try{const e=await Be();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(console.log(null),i.value="post",u.value=_t):(i.value="put",u.value=a),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)})}}catch(e){console.error(e)}},h=async()=>{try{let e;if("post"!==i.value){const e=await Oe({wbcRunCountItems:u.value});return e.data?(S(G.UPDATE_SUCCESSFULLY),await C()):k(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Ke({wbcRunCountItems:u.value}),e&&(S(G.settingSaveSuccess),i.value="put",await C(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},S=e=>{d.value=!0,m.value="success",v.value=e},k=e=>{d.value=!0,m.value="error",v.value=e},N=()=>{d.value=!1},_=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},E=async()=>{await h(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Ri,[(0,s.Lk)("table",Li,[Ti,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.min=t,class:"form-control form-control-sm"},null,8,Pi),[[l.Jo,e.min]])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.max=t,class:"form-control form-control-sm"},null,8,Ai),[[l.Jo,e.max]])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t=>e.wbcTargetCount=t,class:"form-select form-select-sm"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(it),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:+e.value},(0,n.v_)(e.text),9,Mi)))),128))],8,Di),[[l.u1,e.wbcTargetCount]])])])))),128))])])]),(0,s.Lk)("div",xi,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[0]||(t[0]=e=>h())},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":p.value,message:g.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:_,onOkConfirm:E},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:N,"onUpdate:hideAlert":N},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Oi=Ki;var Bi=Oi;const Fi={namespaced:!0,state:()=>({id:0,userId:"",password:"",name:"",employeeNo:"",userType:"",subscriptionDate:"",latestDate:""}),mutations:{setUserMutation(e,t){Object.assign(e,t)}},actions:{setUserAction({commit:e},t){e("setUserMutation",t)}}},Ui={namespaced:!0,state:()=>({analysisType:"",wbcDiffVal:"100",stitchCount:""}),mutations:{analysisTypeSet(e,t){e.analysisType=t},wbcDiffValSet(e,t){e.analysisType=t},stitchCountSet(e,t){e.analysisType=t}},actions:{setAnalysisType({commit:e},t){e("analysisTypeSet",t)},setWbcDiffValSet({commit:e},t){e("wbcDiffValSet",t)},setStitchCountSet({commit:e},t){e("stitchCountSet",t)}}},$i={namespaced:!0,state:()=>({equipmentStatusCode:"",wbcCount:"",slideTime:"",time:"",slotInfo:{input:[],output:[]}}),mutations:{setEquipmentStatusCode(e,t){e.equipmentStatusCode=t},setWbcCount(e,t){e.wbcCount=t},setSlideTime(e,t){e.slideTime=t},setTime(e,t){e.time=t},setSlotInfo(e,t){e.slotInfo=t}},actions:{setWorkingViewInfo({commit:e},t){e("setEquipmentStatusCode",t.equipmentStatusCode),e("setWbcCount",t.wbcCount),e("setSlideTime",t.slideTime),e("setTime",t.time),e("setSlotInfo",t.slotInfo)}}},Wi={namespaced:!0,state:()=>({embeddedStatusJobCmd:"",userStop:!1,isRecoveryRun:!1,isPause:!1,sysInfo:{eqStatCd:"",iCasStat:"",oCasStat:"",jobCmd:"",isDoorOpen:"",oilCount:"",storageSize:"",currentCardCount:"",currentCardName:""},isInit:""}),mutations:{setEmbeddedStatusJobCmd(e,t){e.embeddedStatusJobCmd=t},setUserStop(e,t){e.userStop=t},setIsRecoveryRun(e,t){e.isRecoveryRun=t},setIsPause(e,t){e.isPause=t},setSysInfo(e,t){e.sysInfo=t},setIsInit(e,t){e.isInit=t}},actions:{setEmbeddedStatusInfo({commit:e},t){Object.keys(t).forEach((a=>{"embeddedStatusJobCmd"===a?e("setEmbeddedStatusJobCmd",t[a]):"userStop"===a?e("setUserStop",t[a]):"isRecoveryRun"===a?e("setIsRecoveryRun",t[a]):"isPause"===a?e("setIsPause",t[a]):"sysInfo"===a?e("setSysInfo",t[a]):"isInit"===a&&e("setIsInit",t[a])}))}}},Xi={namespaced:!0,state:()=>({slotInfo:[]}),mutations:{setSlotInfo(e,t){e.slotInfo=t}},actions:{setSlotInfo({commit:e},t){e("setSlotInfo",t)}}},Gi={namespaced:!0,state:()=>({runningInfo:null,changeSlideState:null,slideBooleanState:null}),mutations:{setRunningInfo(e,t){t&&(e.runningInfo=t)},setChangeSlide(e,t){e.changeSlideState?e.changeSlideState.changeSlide=t:e.changeSlideState={changeSlide:t}},setSlideBoolean(e,t){e.slideBooleanState?e.slideBooleanState.slideIs=t:e.slideBooleanState={slideIs:t}}},actions:{setRunningInfo({commit:e},t){e("setRunningInfo",t)},updateRunningInfo({commit:e},t){t&&t.key&&void 0!==t.value&&e(`set${t.key.charAt(0).toUpperCase()+t.key.slice(1)}`,t.value)},setChangeSlide({commit:e},t){e("setChangeSlide",t)},setSlideBoolean({commit:e},t){e("setSlideBoolean",t)}}},Hi={namespaced:!0,state:()=>({startEmbedded:!1,eqStatCd:0,isRunningState:!1,totalCount:"",embeddedNumber:"",isAlarm:!1,bfSelectFiles:[],slideProceeding:"",totalSlideTime:"00:00:00",iaRootPath:"",runningSlotId:"",isRequestInProgress:!1,startInfoBoolen:!1,runningInfoBoolen:!1,runningInfoStop:!1,reqArr:[],resFlag:!0,firstLoading:!1,slotIndex:0,viewerCheck:"",runningArr:[],classArr:[{},{},{},{},{},{},{},{},{},{},{},{}],rbcArr:[{},{},{},{},{},{},{},{},{},{},{},{}],processInfo:[{},{},{},{},{},{},{},{},{},{},{},{}],orderList:[{},{},{},{},{},{},{},{},{},{},{},{}],loginSetData:"",siteCd:"",deviceSerialNm:"",clonedWbcInfo:[],clonedRbcInfo:[],moveImgIsBool:!1,classInfoSort:[],chatRunningData:[],cbcLayer:!1,inhaTestCode:"",rbcReData:!1,rbcReDataClass:!1,rbcInfoAfterData:[],resetRbcArr:!1,selectedSampleId:"",classInfoArr:[],rbcReDataCheck:!1,appAlertOpen:!1,dataBasePageReset:!1,resetAnalyzing:!1,testType:"",isNsNbIntegration:"N",analysisType:"",beforeSettingFormattedString:"",afterSettingFormattedString:"",settingChangedChecker:!1,dbListDataFirstNum:0,dbListDataLastNum:0,isTcpConnected:!1,initValData:!1,enteringRouterPath:"",settingType:"",isDownloadOrUploading:!1}),mutations:{setStartEmbedded(e,t){e.startEmbedded=t},setEqStatCd(e,t){e.eqStatCd=t},setIsRunningState(e,t){e.isRunningState=t},setTotalCount(e,t){e.totalCount=t},setEmbeddedNumber(e,t){e.embeddedNumber=t},setIsAlarm(e,t){e.isAlarm=t},setBfSelectFiles(e,t){e.bfSelectFiles=t},setSlideProceeding(e,t){e.slideProceeding=t},setTotalSlideTime(e,t){e.totalSlideTime=t},setIaRootPath(e,t){e.iaRootPath=t},setRunningSlotId(e,t){e.runningSlotId=t},setIsRequestInProgress(e,t){e.isRequestInProgress=t},setStartInfoBoolen(e,t){e.startInfoBoolen=t},setRunningInfoBoolen(e,t){e.runningInfoBoolen=t},setRunningInfoStop(e,t){e.runningInfoStop=t},setReqArr(e,t){e.reqArr||(e.reqArr=[]),e.reqArr.push(t)},shiftReqArr(e){e.reqArr.shift()},setReqArrPaste(e,t){e.reqArr=t},setResFlag(e,t){e.resFlag=t},setFirstLoading(e,t){e.firstLoading=t},setSlotIndex(e,t){e.slotIndex=t},setViewerCheck(e,t){e.viewerCheck=t},setRunningArr(e,t){e.runningArr=t},setClassArr(e,t){e.classArr=t},setRbcArr(e,t){e.rbcArr=t},setProcessInfo(e,t){e.processInfo=t},setOrderList(e,t){e.orderList=t},setLoginSetData(e,t){e.loginSetData=t},setDeviceSerialNm(e,t){e.deviceSerialNm=t},setSiteCd(e,t){e.siteCd=t},setClonedWbcInfo(e,t){e.clonedWbcInfo=t},setClonedRbcInfo(e,t){e.clonedRbcInfo=t},setMoveImgIsBool(e,t){e.moveImgIsBool=t},setClassInfoSort(e,t){e.classInfoSort=t},setChatRunningData(e,t){e.chatRunningData=t},setSelectedSampleId(e,t){e.selectedSampleId=t},setCbcLayer(e,t){e.cbcLayer=t},setInhaTestCode(e,t){e.inhaTestCode=t},setRbcReData(e,t){e.rbcReData=t},setRbcReDataClass(e,t){e.rbcReDataClass=t},setResetRbcArr(e,t){e.resetRbcArr=t},setRbcInfoAfterData(e,t){e.rbcInfoAfterData=t},setClassInfoArr(e,t){e.classInfoArr=t},setRbcReDataCheck(e,t){e.rbcReDataCheck=t},setAppAlertOpen(e,t){e.appAlertOpen=t},setDataBasePageReset(e,t){e.dataBasePageReset=t},setResetAnalyzing(e,t){e.resetAnalyzing=t},setTestType(e,t){e.testType=t},setIsNsNbIntegration(e,t){e.isNsNbIntegration=t},setAnalysisType(e,t){e.analysisType=t},setBeforeSettingFormattedString(e,t){e.beforeSettingFormattedString=t},setAfterSettingFormattedString(e,t){e.afterSettingFormattedString=t},setSettingChangedChecker(e,t){e.settingChangedChecker=t},setDbListDataFirstNum(e,t){e.dbListDataFirstNum=t},setDbListDataLastNum(e,t){e.dbListDataLastNum=t},setIsTcpConnected(e,t){e.isTcpConnected=t},setInitValData(e,t){e.initValData=t},setEnteringRouterPath(e,t){e.enteringRouterPath=t},setSettingType(e,t){e.settingType=t},setIsDownloadOrUploading(e,t){e.isDownloadOrUploading=t}},actions:{setCommonInfo({commit:e},t){t.hasOwnProperty("startEmbedded")&&e("setStartEmbedded",t.startEmbedded),t.hasOwnProperty("eqStatCd")&&e("setEqStatCd",t.eqStatCd),t.hasOwnProperty("isRunningState")&&e("setIsRunningState",t.isRunningState),t.hasOwnProperty("totalCount")&&e("setTotalCount",t.totalCount),t.hasOwnProperty("embeddedNumber")&&e("setEmbeddedNumber",t.embeddedNumber),t.hasOwnProperty("isAlarm")&&e("setIsAlarm",t.isAlarm),t.hasOwnProperty("bfSelectFiles")&&e("setBfSelectFiles",t.bfSelectFiles),t.hasOwnProperty("slideProceeding")&&e("setSlideProceeding",t.slideProceeding),t.hasOwnProperty("totalSlideTime")&&e("setTotalSlideTime",t.totalSlideTime),t.hasOwnProperty("iaRootPath")&&e("setIaRootPath",t.iaRootPath),t.hasOwnProperty("runningSlotId")&&e("setRunningSlotId",t.runningSlotId),t.hasOwnProperty("isRequestInProgress")&&e("setIsRequestInProgress",t.isRequestInProgress),t.hasOwnProperty("startInfoBoolen")&&e("setStartInfoBoolen",t.startInfoBoolen),t.hasOwnProperty("runningInfoBoolen")&&e("setRunningInfoBoolen",t.runningInfoBoolen),t.hasOwnProperty("runningInfoStop")&&e("setRunningInfoStop",t.runningInfoStop),t.hasOwnProperty("reqArr")&&e("setReqArr",t.reqArr),t.hasOwnProperty("shiftReqArr")&&e("shiftReqArr"),t.hasOwnProperty("reqArrPaste")&&e("setReqArrPaste",t.reqArr),t.hasOwnProperty("resFlag")&&e("setResFlag",t.resFlag),t.hasOwnProperty("firstLoading")&&e("setFirstLoading",t.firstLoading),t.hasOwnProperty("slotIndex")&&e("setSlotIndex",t.slotIndex),t.hasOwnProperty("viewerCheck")&&e("setViewerCheck",t.viewerCheck),t.hasOwnProperty("runningArr")&&e("setRunningArr",t.runningArr),t.hasOwnProperty("classArr")&&e("setClassArr",t.classArr),t.hasOwnProperty("rbcArr")&&e("setRbcArr",t.rbcArr),t.hasOwnProperty("processInfo")&&e("setProcessInfo",t.processInfo),t.hasOwnProperty("orderList")&&e("setOrderList",t.orderList),t.hasOwnProperty("loginSetData")&&e("setLoginSetData",t.loginSetData),t.hasOwnProperty("siteCd")&&e("setSiteCd",t.siteCd),t.hasOwnProperty("deviceSerialNm")&&e("setDeviceSerialNm",t.deviceSerialNm),t.hasOwnProperty("clonedWbcInfo")&&e("setClonedWbcInfo",t.clonedWbcInfo),t.hasOwnProperty("clonedRbcInfo")&&e("setClonedRbcInfo",t.clonedRbcInfo),t.hasOwnProperty("moveImgIsBool")&&e("setMoveImgIsBool",t.moveImgIsBool),t.hasOwnProperty("classInfoSort")&&e("setClassInfoSort",t.classInfoSort),t.hasOwnProperty("chatRunningData")&&e("setChatRunningData",t.chatRunningData),t.hasOwnProperty("selectedSampleId")&&e("setSelectedSampleId",t.selectedSampleId),t.hasOwnProperty("cbcLayer")&&e("setCbcLayer",t.cbcLayer),t.hasOwnProperty("inhaTestCode")&&e("setInhaTestCode",t.inhaTestCode),t.hasOwnProperty("rbcReData")&&e("setRbcReData",t.rbcReData),t.hasOwnProperty("rbcReDataClass")&&e("setRbcReDataClass",t.rbcReDataClass),t.hasOwnProperty("rbcInfoAfterData")&&e("setRbcInfoAfterData",t.rbcInfoAfterData),t.hasOwnProperty("resetRbcArr")&&e("setResetRbcArr",t.resetRbcArr),t.hasOwnProperty("classInfoArr")&&e("setClassInfoArr",t.classInfoArr),t.hasOwnProperty("rbcReDataCheck")&&e("setRbcReDataCheck",t.rbcReDataCheck),t.hasOwnProperty("appAlertOpen")&&e("setAppAlertOpen",t.appAlertOpen),t.hasOwnProperty("dataBasePageReset")&&e("setDataBasePageReset",t.dataBasePageReset),t.hasOwnProperty("resetAnalyzing")&&e("setResetAnalyzing",t.resetAnalyzing),t.hasOwnProperty("testType")&&e("setTestType",t.testType),t.hasOwnProperty("isNsNbIntegration")&&e("setIsNsNbIntegration",t.isNsNbIntegration),t.hasOwnProperty("analysisType")&&e("setAnalysisType",t.analysisType),t.hasOwnProperty("beforeSettingFormattedString")&&e("setBeforeSettingFormattedString",t.beforeSettingFormattedString),t.hasOwnProperty("afterSettingFormattedString")&&e("setAfterSettingFormattedString",t.afterSettingFormattedString),t.hasOwnProperty("settingChangedChecker")&&e("setSettingChangedChecker",t.settingChangedChecker),t.hasOwnProperty("dbListDataFirstNum")&&e("setDbListDataFirstNum",t.dbListDataFirstNum),t.hasOwnProperty("dbListDataLastNum")&&e("setDbListDataLastNum",t.dbListDataLastNum),t.hasOwnProperty("isTcpConnected")&&e("setIsTcpConnected",t.isTcpConnected),t.hasOwnProperty("initValData")&&e("setInitValData",t.initValData),t.hasOwnProperty("enteringRouterPath")&&e("setEnteringRouterPath",t.enteringRouterPath),t.hasOwnProperty("settingType")&&e("setSettingType",t.settingType),t.hasOwnProperty("isDownloadOrUploading")&&e("setIsDownloadOrUploading",t.isDownloadOrUploading)}}},Vi={namespaced:!0,state:()=>({dataBaseSetData:null}),mutations:{setDataBaseSetData(e,t){t&&(e.dataBaseSetData={...e.dataBaseSetData,changeSlide:t.changeSlide??e.dataBaseSetData?.changeSlide,resultCode:t.resultCode??e.dataBaseSetData?.resultCode,resultMsg:t.resultMsg??e.dataBaseSetData?.resultMsg,errorLevel:t.errorLevel??e.dataBaseSetData?.errorLevel,jobCmd:t.jobCmd??e.dataBaseSetData?.jobCmd,processingCode:t.processingCode??e.dataBaseSetData?.processingCode,iCasStat:t.iCasStat??e.dataBaseSetData?.iCasStat,oCasStat:t.oCasStat??e.dataBaseSetData?.oCasStat,cassetId:t.cassetId??e.dataBaseSetData?.cassetId,isRunningState:t.isRunningState??e.dataBaseSetData?.isRunningState,slotInfo:t.slotInfo?t.slotInfo.map((t=>{const a=e.dataBaseSetData?.slotInfo?.find((e=>e?.slotId===t?.slotId));return a?{...a,...t}:t})):e.dataBaseSetData?.slotInfo??[]})}},actions:{setDataBaseSetData({commit:e},t){e("setDataBaseSetData",t)}}},ji={namespaced:!0,state:()=>({totalSlideTime:"00:00:00",slideTime:"00:00:00"}),mutations:{setTotalSlideTime(e,t){e.totalSlideTime=t},setSlideTime(e,t){e.slideTime=t}},actions:{setTimeInfo({commit:e},t){t.hasOwnProperty("totalSlideTime")&&e("setTotalSlideTime",t.totalSlideTime),t.hasOwnProperty("slideTime")&&e("setSlideTime",t.slideTime)}}},Yi=(0,c.y$)({modules:{userModule:Fi,executeModule:Ui,workingViewModule:$i,embeddedStatusModule:Wi,orderListModule:Xi,runningInfoModule:Gi,commonModule:Hi,dataBaseSetDataModule:Vi,timeModule:ji}});var qi=Yi;const Qi=async(e,t)=>{if(e&&t){switch(e){case Lt.cellImageAnalyzed:const e=t,l=e.id;e?.id&&delete e.id;try{const t=await oe(e,l);if(t){const e=t?.data;await qi.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:e?.isNsNbIntegration?"Y":"N"}),await qi.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:e?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",e.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",e?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",e?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",e?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(e?.edgeShotType)),sessionStorage.setItem("iaRootPath",e?.iaRootPath),sessionStorage.setItem("keepPage",String(e?.keepPage));const a="pb"===window.PROJECT_TYPE?"keepPage":"bmKeepPage";sessionStorage.setItem(a,String(e?.keepPage)),await qi.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!0})}}catch(a){console.log(a)}break;case Lt.rbcDegree:try{const e=[];t.forEach((t=>{t.classInfo.forEach((a=>{e.push({categoryId:t.categoryId,categoryNm:t.categoryNm,classId:a.classId,classNm:a.classNm,degree1:a.degree1,degree2:a.degree2,degree3:a.degree3})}))})),await ie(e)}catch(a){console.log(a)}break;case Lt.wbcRunningCount:try{await Oe({wbcRunCountItems:t})}catch(a){console.log(a)}break;case Lt.wbcCustomClass:try{await ue({classArr:t})}catch(a){console.log(a)}break;case Lt.wbcHotKeys:try{await ve({wbcHotKeysItems:t})}catch(a){console.log(a)}break;case Lt.bfHotKeys:try{await fe({bfHotKeysItems:t})}catch(a){console.log(a)}break;case Lt.normalRange:try{await be({normalRangeItems:t})}catch(a){console.log(a)}break;case Lt.classOrder:for(const a in t)t[a].orderIdx=a;try{await Ve(t)}catch(a){console.log(a)}break;case Lt.imagePrint:try{await Se({imagePrintItems:t})}catch(a){console.log(a)}break;case Lt.lisCode:await _e({lisCodeItems:t.lisCodeWbcArr}),await Re({lisCodeItems:t.lisCodeRbcArr}),await Ue({minCountItems:t.minCountArr});break;case Lt.cbcCode:try{await Pe({cbcCodeItems:t})}catch(a){console.log(a)}break;case Lt.filePathSet:try{await Me({filePathSetItems:t})}catch(a){console.log(a)}break;default:break}await qi.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await qi.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}},Ji={class:"settingTabSubButtons"},zi={class:"tab-content"};var Zi=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)("cellImageAnalyzed"),l=(0,o.KR)(""),i=(0,o.KR)(!1),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),g=(0,s.EW)((()=>t.state.commonModule.settingType)),f=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),I=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString));(0,s.sV)((async()=>{l.value="bm"===window.PROJECT_TYPE?"bm":"pb"}));const y=e=>{a.value!==e&&(v.value=e,f.value!==I.value?(d.value=!0,m.value=`${g.value} ${G.settingNotSaved}`):a.value=v.value)},b=async e=>{i.value=!0,r.value="success",u.value=e},C=async e=>{i.value=!0,r.value="error",u.value=e},h=()=>{i.value=!1},S=(0,s.EW)((()=>{switch(a.value){case"cellImageAnalyzed":return Dn;case"rbcDegree":return Xn;case"deviceControls":return Jn;case"wbcCustomClass":return li;case"wbcHotKeys":return ri;case"bfHotKeys":return vi;case"normalRange":return Ci;case"wbcOrder":return wi;case"wbcRunningCount":return Bi;default:return null}})),k=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),a.value=v.value,d.value=!1},N=async()=>{d.value=!1;try{console.log(g.value),await Qi(g.value,JSON.parse(I.value)),await b(G.settingSaveSuccess)}catch(e){await C(G.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Ji,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>y("cellImageAnalyzed")),class:(0,n.C4)({active:"cellImageAnalyzed"===a.value})},"Cell Image Analyzed",2),"viewer"!==p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},["pb"===l.value?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>y("rbcDegree")),class:(0,n.C4)({active:"rbcDegree"===a.value})},"RBC Degree",2)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>y("deviceControls")),class:(0,n.C4)({active:"deviceControls"===a.value})},"Device Controls",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>y("wbcRunningCount")),class:(0,n.C4)({active:"wbcRunningCount"===a.value})},"WBC Running Count",2),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>y("wbcCustomClass")),class:(0,n.C4)({active:"wbcCustomClass"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Custom Class ",3),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>y("wbcHotKeys")),class:(0,n.C4)({active:"wbcHotKeys"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Hot Keys ",3),"pb"===l.value?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[6]||(t[6]=e=>y("bfHotKeys")),class:(0,n.C4)({active:"bfHotKeys"===a.value})},"BF Hot Keys",2)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=e=>y("normalRange")),class:(0,n.C4)({active:"normalRange"===a.value})},"Normal Range",2),(0,s.Lk)("button",{onClick:t[8]||(t[8]=e=>y("wbcOrder")),class:(0,n.C4)({active:"wbcOrder"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Order ",3)],64)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",zi,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(S.value)))])]),d.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":d.value,message:m.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:k,onOkConfirm:N},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),i.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":i.value,type:r.value,message:u.value,onHide:h,"onUpdate:hideAlert":h},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const er=Zi;var tr=er;const ar={class:"layer"},lr={class:"layer-content"},sr={class:"layer-header"},or={class:"layer-body"};var nr={__name:"modal",emits:["update:closeLayer"],setup(e,{emit:t}){const a=(0,o.KR)(!1),l=t,n=()=>{a.value=!1,l("update:closeLayer",!1)};return(0,s.sV)((()=>{l("afterOpen")})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",ar,[(0,s.Lk)("div",lr,[(0,s.Lk)("div",sr,[(0,s.RG)(e.$slots,"header"),(0,s.Lk)("button",{onClick:n,class:"alertCloseButton"},"Close")]),(0,s.Lk)("div",or,[(0,s.RG)(e.$slots,"content")])])]))}};const ir=nr;var rr=ir;const cr={class:"settingContainer"},ur={class:"searchUserContainer"},dr=["value"],mr={class:"table defaultTable mt2"},vr=(0,s.Lk)("th",null,"No.",-1),pr=(0,s.Lk)("th",null,"User Type",-1),gr=(0,s.Lk)("th",null,"User ID",-1),fr=(0,s.Lk)("th",null,"Name",-1),Ir=(0,s.Lk)("th",null,"Employee",-1),yr=(0,s.Lk)("th",null,"Subscription Date",-1),br=(0,s.Lk)("th",null,"Latest Date",-1),Cr=(0,s.Lk)("th",null,"Edit",-1),hr=(0,s.Lk)("th",null,"Delete",-1),Sr=["onClick"],kr=["onClick"],Nr=(0,s.Lk)("h2",null,"Edit Account",-1),_r={class:"editModalContainer"},Er={class:"userInputWrapper"},wr=(0,s.Lk)("label",{class:"userLabel",for:"userType",style:{"line-height":"0"}},"User Type",-1),Rr=["value"],Lr={class:"userInputWrapper"},Tr=(0,s.Lk)("label",{class:"userLabel",for:"userId"},"User ID",-1),Pr={class:"userInputWrapper"},Ar=(0,s.Lk)("label",{class:"userLabel",for:"userName"},"Name",-1),Dr={class:"userInputWrapper"},Mr=(0,s.Lk)("label",{class:"userLabel",for:"employeeNo"},"Employee",-1),xr={class:"userInputWrapper"},Kr=(0,s.Lk)("label",{class:"userLabel",for:"subscriptionDate"},"Subscription Date",-1),Or={class:"userInputWrapper"},Br=(0,s.Lk)("label",{class:"userLabel",for:"latestDate"},"Latest Date",-1);var Fr=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.userModule)),i=a.value,r=(0,o.KR)(""),u=(0,o.KR)([]),d=e=>e.replace("T"," ").replace(".000Z",""),m=(0,o.KR)("userId"),v=(0,o.KR)([{value:"userId",text:"User Id"},{value:"name",text:"User Name"}]),p=(0,o.KR)([{value:"normal",text:"normal"},{value:"admin",text:"admin"}]),g=(0,o.KR)(""),f=(0,o.KR)(!1),I=(0,o.KR)({}),y=(0,o.KR)(""),b=(0,s.EW)((()=>d(I.value.subscriptionDate))),C=(0,s.EW)((()=>d(I.value.latestDate))),h=(0,o.KR)(!1),S=(0,o.KR)(""),k=(0,o.KR)("");(0,s.sV)((async()=>{r.value=i.userId,await w()}));const N=(e,t,a)=>{const l=t.toLowerCase();return e.filter((e=>{const t="userId"===a?String(e.userId):e.name;return t.toLowerCase().includes(l)}))},_=async()=>{try{const e=await Is(String(r.value));if(e&&e.data){const t=e.data.users||[],a=N(t,g.value,m.value);u.value=a}}catch(e){console.error("An error occurred:",e)}},E=async()=>{try{await bs(I.value,y.value),await w(),f.value=!1;const e=u.value.find((e=>e.userId===r.value));await t.dispatch("userModule/setUserAction",{id:e.id,userId:e.userId,employeeNo:e.employeeNo,latestDate:e.latestDate,password:e.password,subscriptionDate:e.subscriptionDate,userType:e.userType,name:e.name}),sessionStorage.setItem("user",JSON.stringify(u.value.find((e=>e.userId===r.value)))),localStorage.setItem("user",JSON.stringify(u.value.find((e=>e.userId===r.value))))}catch(e){console.log(e)}},w=async()=>{try{const e=await Is(String(r.value));e&&e?.data&&(u.value=e.data.users||[])}catch(e){console.log(e)}},R=async e=>{y.value=e;try{const t=await ys(e);I.value=t.data.user}catch(t){console.log(t)}},L=async e=>{await R(e),""!==e&&(f.value=!0)},T=()=>{},P=e=>{f.value=e,I.value={},y.value=""},A=()=>{h.value=!1},D=async()=>{h.value=!1;try{await Cs({userId:y.value}),await w(),y.value===r.value&&(VC.push("/user/login"),localStorage.removeItem("user"),sessionStorage.removeItem("user"))}catch(e){console.log(e)}},M=e=>{h.value=!0,y.value=e,k.value=`Do you wish to proceed with deleting user ID ${e}?`};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",cr,[(0,s.Lk)("div",ur,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"searchSelect"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,dr)))),128))],512),[[l.u1,m.value]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),class:"searchInputBox"},null,512),[[l.Jo,g.value]]),(0,s.bF)(a,{icon:["fas","search"],class:"searchBtn",onClick:_})]),(0,s.Lk)("table",mr,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[vr,pr,gr,fr,Ir,yr,br,(0,o.R1)(i).userType.includes("admin")?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[Cr,hr],64)):(0,s.Q3)("",!0)])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.id),1),(0,s.Lk)("td",null,(0,n.v_)(e.userType),1),(0,s.Lk)("td",null,(0,n.v_)(e.userId),1),(0,s.Lk)("td",null,(0,n.v_)(e.name),1),(0,s.Lk)("td",null,(0,n.v_)(e.employeeNo),1),(0,s.Lk)("td",null,(0,n.v_)(d(e.subscriptionDate)),1),(0,s.Lk)("td",null,(0,n.v_)(d(e.latestDate)),1),(0,o.R1)(i).userType.includes("admin")?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("td",{class:"cursorPointer hoverSizeAction",onClick:t=>L(e.userId)},[(0,s.bF)(a,{icon:["fas","pen-to-square"]})],8,Sr),(0,s.Lk)("td",{class:"cursorPointer hoverSizeAction",onClick:t=>M(e.userId)},[(0,s.bF)(a,{icon:["fas","trash"]})],8,kr)],64)):(0,s.Q3)("",!0)])))),128))])])]),f.value?((0,s.uX)(),(0,s.Wv)(rr,{key:0,"onUpdate:closeLayer":P,onAfterOpen:T},{header:(0,s.k6)((()=>[Nr])),content:(0,s.k6)((()=>[(0,s.Lk)("div",_r,[(0,s.Lk)("div",Er,[wr,(0,s.bo)((0,s.Lk)("select",{id:"userType","onUpdate:modelValue":t[2]||(t[2]=e=>I.value.userType=e),class:"searchSelect inputMiddleWrapper",style:{width:"132px !important"}},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Rr)))),128))],512),[[l.u1,I.value.userType]])]),(0,s.Lk)("div",Lr,[Tr,(0,s.bo)((0,s.Lk)("input",{id:"userId",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>I.value.userId=e),disabled:"",readonly:""},null,512),[[l.Jo,I.value.userId]])]),(0,s.Lk)("div",Pr,[Ar,(0,s.bo)((0,s.Lk)("input",{id:"userName",class:"inputMiddleWrapper",type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>I.value.name=e)},null,512),[[l.Jo,I.value.name]])]),(0,s.Lk)("div",Dr,[Mr,(0,s.bo)((0,s.Lk)("input",{id:"employeeNo",class:"inputMiddleWrapper",type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>I.value.employeeNo=e)},null,512),[[l.Jo,I.value.employeeNo]])]),(0,s.Lk)("div",xr,[Kr,(0,s.bo)((0,s.Lk)("input",{id:"subscriptionDate",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e),disabled:""},null,512),[[l.Jo,b.value]])]),(0,s.Lk)("div",Or,[Br,(0,s.bo)((0,s.Lk)("input",{id:"latestDate",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>C.value=e),disabled:""},null,512),[[l.Jo,C.value]])])]),(0,s.Lk)("div",{class:"modalBottom"},[(0,s.Lk)("button",{type:"button",class:"alertButton",onClick:E},"Edit")])])),_:1})):(0,s.Q3)("",!0),h.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:1,"is-visible":h.value,type:S.value,message:k.value,onHide:A,onOkConfirm:D},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Ur=Fr;var $r=Ur;const Wr={class:"settingImagePrint"},Xr=["value"],Gr={class:"mt1"};var Hr=(0,s.pM)({__name:"ImagePrint",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,o.KR)(""),g=(0,o.KR)(!1),f=(0,o.KR)(""),I=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType)),C=(0,o.KR)(!1);(0,s.sV)((async()=>{await k(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.imagePrint})})),(0,s.wB)((()=>u.value),(async e=>{i.value.forEach((t=>{t.checked=e.includes(t.classId)})),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)}),b.value!==Lt.imagePrint&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.imagePrint})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{h()}));const h=()=>{g.value=!0,f.value=`${b.value} ${G.settingNotSaved}`},S=async()=>{try{let e;if(i.value.forEach((e=>{e.checked=u.value.includes(e.classId)})),"post"!==d.value){const e=await Se({imagePrintItems:i.value});return e.data?(N(G.UPDATE_SUCCESSFULLY),await k()):_(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await he({imagePrintItems:i.value}),e&&(N(G.settingSaveSuccess),d.value="put",await k(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},k=async()=>{try{const e=await ke();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(d.value="post",i.value="bm"===window.PROJECT_TYPE?ht:Ct):(d.value="put",i.value=a,u.value=a.filter((e=>e.checked)).map((e=>e.classId)),C.value=u.value.length===i.value.length),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}}catch(e){console.error(e)}},N=e=>{m.value=!0,v.value="success",p.value=e},_=e=>{m.value=!0,v.value="error",p.value=e},E=()=>{m.value=!1},w=()=>{C.value=!C.value,C.value?u.value=i.value.map((e=>e.classId)):u.value=[]},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),g.value=!1,await a.push(I.value)},L=async()=>{await S(),g.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Wr,[(0,s.Lk)("button",{class:"imagePrintBtn mb2",type:"button",onClick:w},(0,n.v_)(C.value?"Uncheck All":"Check All"),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.id},[(0,s.Lk)("div",null,(0,n.v_)(e.fullNm),1),(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:e.classId,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e)},null,8,Xr),[[l.lH,u.value]])])])))),128))]),(0,s.Lk)("div",Gr,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[1]||(t[1]=e=>S())},"Save")]),g.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":g.value,message:f.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:R,onOkConfirm:L},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),m.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":m.value,type:v.value,message:p.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Vr=Hr;var jr=Vr;const Yr={class:"alignDiv"},qr=(0,s.Lk)("p",{class:"mb4"}," [ WBC ] ",-1),Qr={class:"mb1"},Jr=["onUpdate:modelValue"],zr={class:"alignDiv"},Zr=(0,s.Lk)("p",{class:"mt2 mb4"}," [ RBC ] ",-1),ec={class:"mb1"},tc=["onUpdate:modelValue"],ac={class:"alignDiv"},lc=(0,s.Lk)("p",{class:"mb2"}," [ Min Count ] ",-1),sc={key:0,class:"minCountWrapper"},oc=(0,s.Lk)("p",{class:"mb1 mt1"},"Giant Platelet",-1),nc={key:1,class:"minCountWrapper"},ic=(0,s.Lk)("p",{class:"mb1 mt1"},"Platelet Aggregation",-1),rc={class:"mt1"};var cc=(0,s.pM)({__name:"lisCode",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)([]),m=(0,o.KR)(""),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(!1),I=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),C=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await N(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.lisCode})})),(0,s.wB)((()=>[i.value,u.value,d.value]),(async()=>{const e={lisCodeWbcArr:i.value,lisCodeRbcArr:u.value,minCountArr:d.value};await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),C.value!==Lt.lisCode&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.lisCode})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{h()}));const h=()=>{f.value=!0,I.value=`${C.value} ${G.settingNotSaved}`},S=async()=>{try{let e,a,l;if("post"!==m.value){const e=await _e({lisCodeItems:i.value}),a=await Re({lisCodeItems:u.value}),l=await Ue({minCountItems:d.value});return e.data&&a.data&&l.data?(_(G.UPDATE_SUCCESSFULLY),await N()):E(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Ne({lisCodeItems:i.value}),a=await we({lisCodeItems:u.value}),l=await Fe({minCountItems:d.value}),e&&a&&l&&(_(G.settingSaveSuccess),m.value="put",await N(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},k=(e,t)=>{const a=e.target,l=a.value.replace(/[^0-9]/g,"");t?d.value[0].minGPCount=Number(l.trim()):d.value[0].minPACount=Number(l.trim())},N=async()=>{try{const e=await Ee(),a=await Le(),l=await $e();if(e&&e.data&&a&&a.data&&l&&l.data){const s=e.data,o=a.data,n=l.data;!s||s instanceof Array&&0===s.length?(m.value="post",i.value=St):(m.value="put",i.value=s),!o||o instanceof Array&&0===o.length?(m.value="post",u.value=kt):(m.value="put",u.value=o),!n||n instanceof Array&&0===n.length?(m.value="post",d.value=Nt):(m.value="put",d.value=n);const r={lisCodeWbcArr:i.value,lisCodeRbcArr:u.value,minCountArr:d.value};await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:r}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:r})}}catch(e){console.error(e)}},_=e=>{v.value=!0,p.value="success",g.value=e},E=e=>{v.value=!0,p.value="error",g.value=e},w=()=>{v.value=!1},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),f.value=!1,await a.push(y.value)},L=async()=>{await S(),f.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Yr,[qr,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.classId},[(0,s.Lk)("p",Qr,(0,n.v_)(e.fullNm),1),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.key=t},null,8,Jr),[[l.Jo,e.key]])])))),128))]),(0,s.Lk)("div",zr,[Zr,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.fullNm},[(0,s.Lk)("p",ec,(0,n.v_)(e.categoryNm)+" - "+(0,n.v_)(e.fullNm),1),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.key=t},null,8,tc),[[l.Jo,e.key]])])))),128))]),(0,s.Lk)("div",ac,[lc,(0,s.Lk)("ul",null,[d.value.length>0?((0,s.uX)(),(0,s.CE)("li",sc,[oc,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>d.value[0].minGPCount=e),onInput:t[1]||(t[1]=e=>k(e,!0)),class:"form-control form-control-sm"},null,544),[[l.Jo,d.value[0].minGPCount]])])):(0,s.Q3)("",!0),d.value.length>0?((0,s.uX)(),(0,s.CE)("li",nc,[ic,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>d.value[0].minPACount=e),onInput:t[3]||(t[3]=e=>k(e,!1)),class:"form-control form-control-sm"},null,544),[[l.Jo,d.value[0].minPACount]])])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",rc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[4]||(t[4]=e=>S())},"Save")]),f.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":f.value,message:I.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:R,onOkConfirm:L},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":v.value,type:p.value,message:g.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const uc=cc;var dc=uc;const mc=[{siteCd:"0002",hospitalNm:"서울성모병원"},{siteCd:"0003",hospitalNm:"스타고"},{siteCd:"0004",hospitalNm:"이원의료재단"},{siteCd:"0006",hospitalNm:"고대안암병원"},{siteCd:"0007",hospitalNm:"삼광의료재단"},{siteCd:"0011",hospitalNm:"인하대병원"},{siteCd:"0019",hospitalNm:"인천길병원"},{siteCd:"0026",hospitalNm:"건국대학교병원"},{siteCd:"0000",hospitalNm:"0000"},{siteCd:"",hospitalNm:"0000"}],vc={class:"alignDiv"},pc={class:"mb1"},gc=["onUpdate:modelValue"],fc={class:"mt1"};var Ic=(0,s.pM)({__name:"cbcCode",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),y=(0,s.EW)((()=>t.state.commonModule.settingType)),b=(0,o.KR)("");(0,s.sV)((async()=>{await _(),await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.cbcCode})})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),y.value!==Lt.cbcCode&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.cbcCode})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{C()}));const C=()=>{p.value=!0,g.value=`${y.value} ${G.settingNotSaved}`},h=async()=>{try{let e;if("post"!==u.value){const e=await Pe({cbcCodeItems:i.value});return e.data?(k(G.UPDATE_SUCCESSFULLY),await S()):N(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Te({cbcCodeItems:i.value}),e&&(k(G.settingSaveSuccess),u.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},S=async()=>{try{const e=await Ae();if(e&&e.data){const a=e.data;if(!a||a instanceof Array&&0===a.length){u.value="post";const e=mc.filter((e=>e.siteCd===b.value))[0].hospitalNm;i.value="인하대병원"===e?mt:vt}else u.value="put",i.value=a;await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(i.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)})}}catch(e){console.error(e)}},k=e=>{d.value=!0,m.value="success",v.value=e},N=e=>{d.value=!0,m.value="error",v.value=e},_=async()=>{try{const e=await Kt();b.value=e.data.siteCd}catch(e){console.log(e)}},E=()=>{d.value=!1},w=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},R=async()=>{await h(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",vc,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.cd},[(0,s.Lk)("p",pc,(0,n.v_)(e.fullNm),1),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.classCd=t},null,8,gc),[[l.Jo,e.classCd]])])))),128))]),(0,s.Lk)("div",fc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[0]||(t[0]=e=>h())},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":p.value,message:g.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:w,onOkConfirm:R},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const yc=Ic;var bc=yc;const Cc={class:"alignDiv",style:{"text-align":"center"}},hc=(0,s.Lk)("p",{class:"mb2"},"LIS Hot Key",-1),Sc=["value"],kc=(0,s.Lk)("p",{class:"mb2 mt2"},"LIS File Path",-1),Nc=["value"],_c=(0,s.Lk)("p",{class:"mb2 mt2"},"CBC File Path",-1),Ec=["value"],wc={class:"mt1"};var Rc=(0,s.pM)({__name:"filePathSet",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),l=(0,o.KR)([]),n=(0,o.KR)(""),i=(0,o.KR)(!1),u=(0,o.KR)(""),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),g=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),f=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await b(),await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.filePathSet})})),(0,s.wB)((()=>l.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),f.value!==Lt.filePathSet&&await t.dispatch("commonModule/setCommonInfo",{settingType:Lt.filePathSet})}),{deep:!0}),(0,s.wB)((()=>g.value),(()=>{I()}));const I=()=>{m.value=!0,v.value=`${f.value} ${G.settingNotSaved}`},y=async()=>{try{let e;if("post"!==n.value){const e=await Me({filePathSetItems:l.value});return e.data?(k(G.UPDATE_SUCCESSFULLY),await b()):N(G.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await De({filePathSetItems:l.value}),e&&(k(G.settingSaveSuccess),n.value="put",await b(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},b=async()=>{try{const e=await xe();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(n.value="post",l.value=Et):(n.value="put",l.value=a),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(l.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(l.value)})}}catch(e){console.error(e)}},C=(e,t)=>{l.value[t].lisHotKey=e.target.value},h=(e,t)=>{l.value[t].lisFilePath=e.target.value},S=(e,t)=>{l.value[t].cbcFilePath=e.target.value},k=e=>{i.value=!0,u.value="success",d.value=e},N=e=>{i.value=!0,u.value="error",d.value=e},_=()=>{i.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),m.value=!1,await a.push(p.value)},w=async()=>{await y(),m.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Cc,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,[hc,(0,s.Lk)("input",{type:"text",value:l.value[0]?l.value[0].lisHotKey:"",onInput:t[0]||(t[0]=e=>C(e,0))},null,40,Sc)]),(0,s.Lk)("li",null,[kc,(0,s.Lk)("input",{type:"text",value:l.value[0]?l.value[0].lisFilePath:"",onInput:t[1]||(t[1]=e=>h(e,0))},null,40,Nc)]),(0,s.Lk)("li",null,[_c,(0,s.Lk)("input",{type:"text",value:l.value[0]?l.value[0].cbcFilePath:"",onInput:t[2]||(t[2]=e=>S(e,0))},null,40,Ec)])])]),(0,s.Lk)("div",wc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[3]||(t[3]=e=>y())},"Save")]),m.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":m.value,message:v.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:E,onOkConfirm:w},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),i.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":i.value,type:u.value,message:d.value,onHide:_,"onUpdate:hideAlert":_},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Lc=Rc;var Tc=Lc;const Pc={class:"settingTabSubButtons"},Ac={key:0},Dc={class:"tab-content"};var Mc=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)(!1);let l=(0,o.KR)("ImagePrint");const i=(0,o.KR)(""),r=(0,o.KR)(!1),u=(0,o.KR)(""),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.settingType)),g=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),f=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString));(0,s.KC)((()=>{a.value="bm"===window.PROJECT_TYPE}));const I=e=>{l.value!==e&&(i.value=e,g.value!==f.value?(m.value=!0,v.value=`${p.value} ${G.settingNotSaved}`):l.value=i.value)},y=(0,s.EW)((()=>{switch(l.value){case"ImagePrint":return jr;case"LisCode":return dc;case"CbcCode":return bc;case"filePathSet":return Tc;default:return null}})),b=e=>{r.value=!0,u.value="success",d.value=e},C=e=>{r.value=!0,u.value="error",d.value=e},h=()=>{r.value=!1},S=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),l.value=i.value,m.value=!1},k=async()=>{m.value=!1;try{console.log(p.value),await Qi(p.value,JSON.parse(f.value)),await b(G.settingSaveSuccess)}catch(e){await C(G.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Pc,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>I("ImagePrint")),class:(0,n.C4)({active:"ImagePrint"===(0,o.R1)(l)})},"Image Print",2),a.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Ac,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>I("LisCode")),class:(0,n.C4)({active:"LisCode"===(0,o.R1)(l)})},"LIS Code",2),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>I("CbcCode")),class:(0,n.C4)({active:"CbcCode"===(0,o.R1)(l)})},"CBC Code",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>I("filePathSet")),class:(0,n.C4)({active:"filePathSet"===(0,o.R1)(l)})},"LIS(CBC) Hot Key & File Path",2)]))]),(0,s.Lk)("div",Dc,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(y.value)))])]),m.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":m.value,message:v.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:S,onOkConfirm:k},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),r.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":r.value,type:u.value,message:d.value,onHide:h,"onUpdate:hideAlert":h},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const xc=Mc;var Kc=xc;const Oc=(0,s.Lk)("p",{class:"mb1"},"QualityCheck",-1);var Bc=(0,s.pM)({__name:"index",setup(e){const t=async()=>{await Ye()};return(e,a)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("ul",{class:"customSettingContainer"},[(0,s.Lk)("li",{class:"mt2"},[Oc,(0,s.Lk)("button",{type:"button",class:"defaultBtn",onClick:t},"Ok")])])]))}});const Fc=Bc;var Uc=Fc;const $c=ee(),Wc=async e=>$c.httpPost(te.jsonReader.get,e,"",!1,sessionStorage.getItem("viewerCheck")||"viewer"),Xc=async e=>$c.httpPost(te.dziReader.get,e),Gc=async e=>$c.httpGet(te.fileTxtRead.get,`${e}`,!0),Hc=async e=>$c.httpPost(te.H7Read.post,e,"text/plain",!1,sessionStorage.getItem("viewerCheck")||"viewer"),Vc=async e=>$c.httpPost(te.H7Message.post,e,"",!1,sessionStorage.getItem("viewerCheck")||"viewer"),jc=async e=>$c.httpPost(te.Hl7Create.post,e),Yc={class:"versionContainer"},qc=(0,s.Lk)("h3",{class:"fs12 mb1"},"SW",-1),Qc={class:"versionContainer"},Jc=(0,s.Lk)("h3",{class:"fs12 mb1"},"Engine",-1);var zc=(0,s.pM)({__name:"index",setup(e){const t=(0,o.KR)(!1),a=(0,o.KR)(),l=(0,o.KR)(),i=(0,o.KR)(""),r=(0,o.KR)(""),c=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,o.KR)("");(0,s.KC)((()=>{t.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{await g(),p()}));const p=()=>{a.value=[{key:"Core Version",name:r.value},{key:"DeepNet Version",name:i.value},{key:"Web Frontend Version",name:window.WEB_FRONTEND_VERSION},{key:"Web Backend Version",name:window.WEB_BACKEND_VERSION},{key:"PB Version",name:window.PB_VERSION}],console.log(t.value),t.value?l.value=[{key:"BM SEG Version",name:c.value},{key:"BM CELL Version",name:u.value}]:l.value=[{key:"PB SEG Version",name:d.value},{key:"PB WBC Version",name:m.value},{key:"PB RBC Version",name:v.value}]},g=async()=>{const e="D:\\UIMD_Data\\Backend_INI",t="SW_Config";try{const a=await Gc(`path=${e}&filename=${t}`),l=a.data.data,s=/TCP_VERSION\s*=\s*(.+)/,o=/BACKEND\s*=\s*(.+)/,n=/BM_SEG_ENGINE\s*=\s*(.+)/,p=/BM_CELL_ENGINE\s*=\s*(.+)/,g=/PB_SEG_ENGINE\s*=\s*(.+)/,f=/PB_WBC_ENGINE\s*=\s*(.+)/,I=/PB_RBC_SHAPE_ENGINE\s*=\s*(.+)/;i.value=l.match(s)[1]||"",r.value=l.match(o)[1]||"",c.value=l.match(n)[1]||"",u.value=l.match(p)[1]||"",d.value=l.match(g)[1]||"",m.value=l.match(f)[1]||"",v.value=l.match(I)[1]||""}catch(a){console.log(a),i.value="",r.value=""}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Yc,[qc,(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.Lk)("span",null,(0,n.v_)(e.key),1),(0,s.Lk)("span",null,(0,n.v_)(e.name),1)])))),128))])]),(0,s.Lk)("div",Qc,[Jc,(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.Lk)("span",null,(0,n.v_)(e.key),1),(0,s.Lk)("span",null,(0,n.v_)(e.name),1)])))),128))])])],64))}});const Zc=zc;var eu=Zc;const tu={class:"settingWrapDiv"},au={class:"settingTabBtn"},lu=["onClick"],su=["onClick"];var ou=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=["Login/Account","Analysis/Database","Report","Quality Check","Version"],l=["Login/Account","Analysis/Database","Version"],i=(0,o.KR)(a[0]),r=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),p=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString)),g=(0,s.EW)((()=>t.state.commonModule.settingType)),f=(0,o.KR)(!1),I=(0,o.KR)(""),y=(0,o.KR)(a[0]),b=e=>{i.value!==e&&(y.value=e,v.value!==p.value?(f.value=!0,I.value=`${g.value} ${G.settingNotSaved}`):(i.value=y.value,sessionStorage.setItem("selectedTab",y.value)))},C={"Login/Account":$r,"Analysis/Database":tr,Report:Kc,"Quality Check":Uc,Version:eu},h={"Login/Account":$r,Version:eu,"Analysis/Database":tr},S=sessionStorage.getItem("selectedTab");S&&a.includes(S)&&(i.value=S);const k=(0,s.EW)((()=>"viewer"===r.value?h[i.value]:C[i.value])),N=e=>{u.value=!0,d.value="success",m.value=e},_=e=>{u.value=!0,d.value="error",m.value=e},E=()=>{u.value=!1},w=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),i.value=y.value,f.value=!1},R=async()=>{f.value=!1;try{console.log("seeting"),await Qi(g.value,JSON.parse(p.value)),await N(G.settingSaveSuccess)}catch(e){await _(G.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",tu,[(0,s.Lk)("ul",au,["viewer"===r.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l,(e=>(0,s.Lk)("li",{key:e,class:(0,n.C4)({activeTab:i.value===e}),onClick:t=>b(e)},(0,n.v_)(e),11,lu))),64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},(0,s.pI)(a,(e=>(0,s.Lk)("li",{key:e,class:(0,n.C4)({activeTab:i.value===e}),onClick:t=>b(e)},(0,n.v_)(e),11,su))),64))]),((0,s.uX)(),(0,s.Wv)((0,s.$y)(k.value),{class:"settingWrap"}))]),f.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:0,"is-visible":f.value,message:I.value,confirmText:(0,o.R1)(G).SAVE,closeText:(0,o.R1)(G).LEAVE,onHide:w,onOkConfirm:R},null,8,["is-visible","message","confirmText","closeText"])):(0,s.Q3)("",!0),u.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":u.value,type:d.value,message:m.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const nu=ou;var iu=nu;const ru=ee(),cu=async e=>ru.httpPost(te.settings.runningInfo.create,e),uu=async e=>ru.httpPut(te.settings.runningInfo.update,e,"",!0),du=async e=>{const t=Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`)).join("&");return ru.httpGet(te.settings.runningInfo.get,`${t}`,!0)},mu=async e=>ru.httpDelete(te.settings.runningInfo.delete,e,!0),vu=async e=>ru.httpGet(te.settings.runningInfo.detail,`${e}`,!1),pu=async e=>ru.httpGet(te.settings.runningInfo.classInfoDetail,`${e}`,!1),gu=async e=>ru.httpGet(te.settings.runningInfo.classInfoDetailSelectQuery,`${e}`,!1),fu=async e=>ru.httpGet(te.settings.runningInfo.classInfoMenuDetailSelectQuery,`${e}`,!1),Iu=async e=>ru.httpGet(te.settings.runningInfo.pageUpDown,`${e}`,!0),yu=async e=>ru.httpGet(te.settings.runningInfo.updatePcIpState,`${e}`,!0),bu=async e=>ru.httpGet(te.settings.runningInfo.clearPcIpState,`${e}`,!0),Cu=async()=>ru.httpGet(te.settings.runningInfo.removePageAllData,"",!0);a(4603),a(7566),a(8721);var hu=a(3075);const Su=()=>{document.body.style.overflow="hidden"},ku=()=>{document.body.style.overflow="auto"},Nu=e=>isNaN(e)?0:e,_u=(e,t)=>{if("04"!==e.testType){const e=["NR","AR","GP","PA","MC","MA"];let a=0;t.forEach((t=>{Number(t.count)>0&&!e.includes(t.title)&&(a+=Number(t.count))}));let l=null,s=0;return t.forEach(((o,n)=>{let i=Number((Number(o.count)/a*100).toFixed(0));const r=Number((Number(o.count)/a*100).toFixed(2));("BL"===o.title||["LA","IM","MB","AM"].includes(o.title))&&Number(o.count)>0&&r>=0&&r<=1&&(i=1),o.percent=i,e.includes(o.title)||(s+=Number(o.percent),(null===l||Number(l.count)<Number(o.count))&&(l=o)),null!==l&&n+1===t.length&&(l.percent=Number(l.percent)+(100-s))})),t}return t},Eu=(e,t)=>{const a=e.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent))||0)).reduce(((e,t)=>e+Number(t)),0);return t.map((e=>"Neutrophil"===e.name?{...e,percent:100-a}:{...e,percent:Math.round(parseFloat(e.percent))}))},wu={class:"moveImgIsBool"},Ru={style:{"font-size":"0.8rem",width:"900px",height:"90%","overflow-y":"auto",background:"#fff",color:"#000",position:"absolute",top:"10%",left:"33%","box-sizing":"border-box",padding:"3rem 7rem",border:"2px solid #ccc","border-radius":"10px","z-index":"9999"}},Lu={style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},Tu={style:{display:"flex","flex-direction":"column","justify-content":"space-between"}},Pu={style:{width:"100%","font-size":"0.8rem"}},Au=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"30%"}}),(0,s.Lk)("col",{style:{width:"70%"}})],-1),Du={style:{"padding-bottom":"5px"}},Mu=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Slot ID",-1),xu={style:{"text-align":"left",padding:"5px 0"}},Ku={style:{"padding-bottom":"5px"}},Ou=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Ordered date",-1),Bu={style:{"text-align":"left",padding:"5px 0"}},Fu={style:{"padding-bottom":"5px"}},Uu=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Signed by ID",-1),$u={style:{"text-align":"left",padding:"5px 0"}},Wu={style:{"padding-bottom":"5px"}},Xu=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Signed date",-1),Gu={style:{"text-align":"left",padding:"5px 0"}},Hu={style:{"padding-bottom":"5px"}},Vu=(0,s.Lk)("th",{style:{"text-align":"left"}},"Ordered Classification",-1),ju={style:{"text-align":"left",padding:"5px 0"}},Yu={style:{"padding-bottom":"5px"}},qu=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Name",-1),Qu={style:{"text-align":"left",padding:"5px 0"}},Ju={style:{"padding-bottom":"5px"}},zu=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Birth",-1),Zu={style:{"text-align":"left",padding:"5px 0"}},ed={style:{"padding-bottom":"5px"}},td=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Gender",-1),ad={style:{"text-align":"left",padding:"5px 0"}},ld={key:0,style:{"margin-top":"20px","border-top":"2px dotted #696969"}},sd={key:1,style:{"margin-top":"20px"}},od=(0,s.Lk)("h3",{style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},"RBC classification result",-1),nd={style:{width:"100%","font-size":"0.8rem"}},id=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"20%"}}),(0,s.Lk)("col",{style:{width:"25%"}}),(0,s.Lk)("col",{style:{width:"25%"}}),(0,s.Lk)("col",{style:{width:"15%"}}),(0,s.Lk)("col",{style:{width:"15%"}})],-1),rd=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{style:{"margin-bottom":"15px","font-size":"18px","font-weight":"normal","padding-bottom":"100px"}},[(0,s.Lk)("th",{style:{"text-align":"left"}},"Category"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Class"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Degree"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Count"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Percent")])],-1),cd=["rowspan"],ud={style:{"text-align":"left"}},dd={style:{"text-align":"left"}},md={style:{"text-align":"left"}},vd={style:{"text-align":"left"}},pd={style:{"text-align":"left"}},gd={style:{"text-align":"left"}},fd={style:{"text-align":"left"}},Id={style:{"text-align":"left"}},yd={key:0},bd=(0,s.Lk)("td",null,null,-1),Cd=(0,s.Lk)("td",{style:{"text-align":"left"}},"Others",-1),hd=(0,s.Lk)("td",{style:{"text-align":"left"}},"-",-1),Sd={style:{"text-align":"left"}},kd={style:{"text-align":"left"}},Nd={key:1},_d=(0,s.Lk)("td",{style:{"text-align":"left"}},"Malaria",-1),Ed=(0,s.Lk)("td",{style:{"text-align":"left"}},"-",-1),wd={style:{"text-align":"left"}},Rd={style:{"text-align":"left"}},Ld={key:0},Td=(0,s.Lk)("td",{style:{"text-align":"left"}},null,-1),Pd=(0,s.Lk)("td",{style:{"text-align":"left","font-weight":"bold"}},"Total",-1),Ad={style:{"text-align":"left","font-weight":"bold"}},Dd={style:{"text-align":"left","font-weight":"bold"}},Md={key:1},xd=(0,s.Lk)("td",null,null,-1),Kd=(0,s.Lk)("td",null,null,-1),Od=(0,s.Lk)("td",{style:{"text-align":"left","font-weight":"bold"}},"Total",-1),Bd={style:{"text-align":"left","font-weight":"bold"}},Fd={style:{"text-align":"left","font-weight":"bold"}},Ud=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Others",-1),$d=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Platelets",-1),Wd=(0,s.Lk)("th",null,null,-1),Xd={style:{"text-align":"left",padding:"15px 0"},colspan:"2"},Gd=(0,s.Lk)("th",{style:{"text-align":"left","padding-top":"15px"}},"Comment",-1),Hd={style:{"text-align":"left","padding-top":"15px"},colspan:"4"},Vd={style:{"text-align":"left",outline:"1px solid #252629",padding:"4px"}},jd={style:{"margin-top":"150px","margin-bottom":"50px","border-top":"2px dotted #696969"}},Yd={style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},qd={style:{width:"100%","font-size":"0.8rem"}},Qd=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"30%"}}),(0,s.Lk)("col",{style:{width:"45%"}}),(0,s.Lk)("col",{style:{width:"25%"}})],-1),Jd=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{style:{"margin-bottom":"15px","font-size":"18px","font-weight":"normal","padding-bottom":"100px"}},[(0,s.Lk)("th",{style:{"text-align":"left"}},"Class"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Count"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Percent")])],-1),zd={style:{"text-align":"left",padding:"5px 0"}},Zd={style:{"text-align":"left",padding:"5px 0"}},em={style:{"text-align":"left",padding:"5px 0"}},tm={style:{"padding-bottom":"5px"}},am=(0,s.Lk)("th",{style:{"text-align":"left","font-weight":"bold",padding:"5px 0"}},"Total",-1),lm={style:{"text-align":"left",padding:"5px 0"}},sm=(0,s.Lk)("td",{style:{"text-align":"left",padding:"5px 0"}},"100.00%",-1),om={key:0,style:{"text-align":"left","padding-top":"30px","font-weight":"bold"}},nm={key:0,style:{"padding-top":"5px","padding-bottom":"15px"}},im={style:{"text-align":"left",padding:"5px 0",width:"30%"}},rm={style:{"text-align":"left",padding:"5px 0",width:"45%"}},cm=(0,s.Lk)("td",{style:{"text-align":"left",padding:"5px 0",width:"25%"}},"-",-1),um={style:{"padding-bottom":"5px"}},dm=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Comment",-1),mm={colspan:"2",style:{"text-align":"left",padding:"5px 0"}},vm={style:{"text-align":"left",outline:"1px solid #252629",padding:"4px"}},pm={class:"print",style:{"list-style":"none","padding-left":"0","margin-top":"20px","text-align":"center",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},gm={style:{"font-weight":"bold","font-size":"18px",margin:"10px auto 20px"}},fm={style:{position:"relative","text-align":"left"}},Im=["src","width","height","onError"];var ym=(0,s.pM)({__name:"print",emits:["printClose"],setup(e,{emit:t}){const a=window.PROJECT_TYPE,i=(0,c.Pj)(),r=(0,s.EW)((()=>i.state.commonModule.viewerCheck)),u="viewer"===r.value?window.MAIN_API_IP:window.APP_API_BASE_URL,d=(0,o.KR)(null),m=(0,o.KR)([]),v=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),p=(0,s.EW)((()=>i.state.commonModule.selectedSampleId)),I=(0,s.EW)((()=>i.state.commonModule.siteCd)),y=(0,o.KR)(null),b=(0,o.KR)({}),C=(0,o.KR)([]),h=t,S=["12","13","14","15","16"],k=(0,o.KR)([]),N=(0,o.KR)(0),_=(0,o.KR)(0),E=(0,o.KR)(0),w=(0,o.KR)(0),R=(0,o.KR)(0),L=(0,o.KR)(0),T=(0,o.KR)(0),P=(0,o.KR)(0),A=(0,o.KR)(!1);(0,s.sV)((async()=>{await $(),await U(),await V(),"bm"!==a&&(await x(),await D()),await H()}));const D=async()=>{const e=await M();P.value=e?.artifact+e?.doubleNormal},M=async()=>{const e=""!==y.value?.img_drive_root_path&&y.value?.img_drive_root_path?y.value?.img_drive_root_path:v.value,t=`${e}/${y.value?.slotId}/03_RBC_Classification/${y.value?.slotId}.json`,a=await Wc({fullPath:t}),l=a.data[0].rbcClassList,s={artifact:0,doubleNormal:0};if(l)return l.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?s.artifact+=1:"DoubleNormal"===t.classNm&&(s.doubleNormal+=1)})),s},x=async()=>{const e=""!==y.value?.img_drive_root_path&&y.value?.img_drive_root_path?y.value?.img_drive_root_path:v.value,t=`${e}/${y.value?.slotId}/03_RBC_Classification/${y.value?.slotId}_new.json`,a=await Wc({fullPath:t}),l=`${e}/${y.value?.slotId}/03_RBC_Classification/${y.value?.slotId}.json`,s=await Wc({fullPath:l});if("not file"!==a.data){const e=a?.data;for(const t of s.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}k.value=s.data[0].rbcClassList}else k.value=s?.data[0].rbcClassList;if(!k.value||!Array.isArray(k.value))return void console.error("rbcInfoPathAfter.value is not iterable");let o=0,n=0,i=0,r=0;k.value.forEach((e=>{const t=e.classInfo.length>0?e.classInfo[e.classInfo.length-1].index.replace(/[^\d]/g,""):"";switch(e.categoryId){case"01":o=t;break;case"02":n=t;break;case"03":i=t;break;case"05":r=t;break;default:break}})),N.value=Number(o)+1,_.value=Number(o)+1,E.value=n,w.value=Number(i)+Number(r)+2,y.value.rbcInfoAfter.forEach((e=>{e.classInfo.forEach((e=>{e.originalDegree=0}))})),k.value.forEach((e=>{const t=y.value.rbcInfoAfter.find((t=>t.categoryId===e.categoryId));t&&e.classInfo.forEach((e=>{const a=t.classInfo.find((t=>t.classId===e.classId));a&&a.originalDegree++}))})),await F()},K=(0,o.KR)({}),O=(e,t)=>{K.value[`${e}-${t}`]=!0},B=e=>{const t=(Number(e)/Number(N.value)*100).toFixed(1);return Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t},F=async()=>{let e=0,t=0;for(const a of k.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;R.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}L.value=Math.floor(e/parseFloat(R.value)*1e3),T.value=t},U=async()=>{try{const e=await He();e&&(0===e?.data.length?b.value=[]:b.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}},$=async()=>{try{const e=await vu(String(p.value));y.value=e.data,m.value=e.data.wbcInfoAfter}catch(e){console.log(e)}},W=(e,t)=>"nonWbc"===t?e.filter((e=>S.includes(e.id)&&e.count>0)):e.filter((e=>!S.includes(e.id)&&e.count>0));function X(e,t,l){const s=[...C.value].find((e=>e===String(t)));if(!s)return"";if(!m.value||0===m.value.length)return"";const o=""!==y.value.img_drive_root_path&&y.value.img_drive_root_path?y.value.img_drive_root_path:v.value,n=y.value.slotId||"",i="bm"===a?`${o}/${n}/04_BM_Classification/${t}_${l}`:`${o}/${n}/01_WBC_Classification/${t}_${l}`;return`${u}/images/print?folder=${i}&imageName=${e}`}const G=e=>e.filter((e=>[...C.value].includes(String(e.id)))),H=async()=>{A.value=!0,Su(),q();try{const e=d.value;if(!e)throw new Error("프린트할 내용을 찾을 수 없습니다.");const t=hu.Ay.gzip(e.innerHTML,{level:9}),a=await fetch(`${u}/pdf/convert`,{method:"POST",headers:{"Content-Type":"application/octet-stream","Content-Encoding":"gzip"},body:t});if(!a.ok)throw new Error("HTML을 PDF로 변환하는데 실패했습니다.");const l=await a.blob(),s=window.URL.createObjectURL(l);window.open(s,"_blank","width=800,height=500,noopener,noreferrer"),window.URL.revokeObjectURL(s),A.value=!1}catch(e){console.error("Error:",e),A.value=!1}finally{ku()}},V=async()=>{try{const e=await ke();if(e&&e.data){const t=e.data;C.value=t.filter((e=>e.checked)).map((e=>e.classId)),m.value=m.value.filter((e=>"0"!==e.count));const l=b.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),s=0!==b.value.length?l:"bm"===a?wa:Ea,o=await j(m.value,s);m.value=o,q()}}catch(e){console.error(e)}},j=(e,t)=>{let a=e.slice();return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),e.splice(0,e.length,...a)},q=async()=>{const e=mc.find((e=>"서울성모병원"===e.hospitalNm))?.siteCd===I.value,t=mc.find((e=>"인하대병원"===e.hospitalNm))?.siteCd===I.value;e?m.value=Eu(m.value,m.value):t&&(m.value=await _u(y.value,m.value))},Q=()=>{h("printClose")};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",wu," Loading Print...",512),[[l.aG,A.value]]),(0,s.Lk)("div",Ru,[(0,s.Lk)("button",{style:{position:"absolute",right:"8px",background:"none",border:"1px solid #000","border-radius":"5px",padding:"7px 25px",top:"5px",cursor:"pointer"},onClick:Q},"Close "),(0,s.Lk)("div",{ref_key:"printContent",ref:d,style:{"margin-top":"20px"}},[(0,s.Lk)("div",null,[(0,s.Lk)("h3",Lu,"Analysis Report from UIMD "+(0,n.v_)("bm"===(0,o.R1)(a)?"BM":"PB")+" system",1)]),(0,s.Lk)("div",Tu,[(0,s.Lk)("table",Pu,[Au,(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",Du,[Mu,(0,s.Lk)("td",xu,(0,n.v_)(y.value?.slotId),1)]),(0,s.Lk)("tr",Ku,[Ou,(0,s.Lk)("td",Bu,(0,n.v_)((0,o.R1)(Y)(y.value?.orderDttm)),1)]),(0,s.Lk)("tr",Fu,[Uu,(0,s.Lk)("td",$u,(0,n.v_)(y.value?.submitUserId),1)]),(0,s.Lk)("tr",Wu,[Xu,(0,s.Lk)("td",Gu,(0,n.v_)(y.value?.submitOfDate),1)]),(0,s.Lk)("tr",Hu,[Vu,(0,s.Lk)("td",ju,(0,n.v_)("pb"===(0,o.R1)(a)?(0,o.R1)(g)(y.value?.testType):(0,o.R1)(f)(y.value?.testType)),1)]),(0,s.Lk)("tr",Yu,[qu,(0,s.Lk)("td",Qu,(0,n.v_)(y.value?.patientName),1)]),(0,s.Lk)("tr",Ju,[zu,(0,s.Lk)("td",Zu,(0,n.v_)(y.value?.birthDay),1)]),(0,s.Lk)("tr",ed,[td,(0,s.Lk)("td",ad,(0,n.v_)(""===y.value?.gender?"":"01"===y.value?.gender?"Male":"Female"),1)])])]),"04"===y.value?.testType?((0,s.uX)(),(0,s.CE)("div",ld)):(0,s.Q3)("",!0),"04"===y.value?.testType?((0,s.uX)(),(0,s.CE)("div",sd,[od,(0,s.Lk)("table",nd,[id,rd,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([y.value.rbcInfoAfter],((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[(0,s.Lk)("tr",null,[(0,s.Lk)("td",{rowspan:e.classInfo.length+("Shape"!==e.categoryNm?1:0),style:{"text-align":"left","vertical-align":"top"}},(0,n.v_)(e.categoryNm),9,cd),(0,s.Lk)("td",ud,(0,n.v_)(e.classInfo[0]?.classNm),1),(0,s.Lk)("td",dd,(0,n.v_)(e.classInfo[0]?.degree),1),(0,s.Lk)("td",md,(0,n.v_)(e.classInfo[0]?.originalDegree),1),(0,s.Lk)("td",vd,(0,n.v_)(B(e.classInfo[0]?.originalDegree)),1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.classInfo.slice(1),((t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("tr",null,[(0,s.Lk)("td",pd,(0,n.v_)(t.classNm),1),(0,s.Lk)("td",gd,(0,n.v_)(t.degree),1),(0,s.Lk)("td",fd,(0,n.v_)(t.originalDegree),1),(0,s.Lk)("td",Id,(0,n.v_)(B(t.originalDegree)),1)]),"Shape"===e.categoryNm&&a===e.classInfo.slice(1).length-1?((0,s.uX)(),(0,s.CE)("tr",yd,[bd,Cd,hd,(0,s.Lk)("td",Sd,(0,n.v_)(P.value),1),(0,s.Lk)("td",kd,(0,n.v_)(B(P.value))+" %",1)])):(0,s.Q3)("",!0),"Inclusion Body"===e.categoryNm&&a===e.classInfo.slice(1).length-1?((0,s.uX)(),(0,s.CE)("tr",Nd,[_d,Ed,(0,s.Lk)("td",wd,(0,n.v_)(T.value),1),(0,s.Lk)("td",Rd,(0,n.v_)(B(T.value)),1)])):(0,s.Q3)("",!0)],64)))),128)),"Shape"!==e.categoryNm&&"Inclusion Body"!==e.categoryNm?((0,s.uX)(),(0,s.CE)("tr",Ld,[Td,Pd,(0,s.Lk)("td",Ad,(0,n.v_)(_.value),1),(0,s.Lk)("td",Dd,(0,n.v_)(B(_.value))+" %",1)])):(0,s.Q3)("",!0),"Inclusion Body"==e.categoryNm?((0,s.uX)(),(0,s.CE)("tr",Md,[xd,Kd,Od,(0,s.Lk)("td",Bd,(0,n.v_)(w.value),1),(0,s.Lk)("td",Fd,(0,n.v_)(B(w.value))+" %",1)])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("tr",null,[Ud,$d,Wd,(0,s.Lk)("th",Xd,(0,n.v_)(L.value)+" PLT / 1000 RBC",1)]),(0,s.Lk)("tr",null,[Gd,(0,s.bo)((0,s.Lk)("th",Hd,[(0,s.Lk)("pre",Vd,(0,n.v_)(y.value?.rbcMemo),1)],512),[[l.aG,y.value?.rbcMemo]])])])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",jd,[(0,s.Lk)("h3",Yd,(0,n.v_)("pb"===(0,o.R1)(a)?"WBC":"BM")+" classification result",1),(0,s.Lk)("table",qd,[Qd,Jd,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(W(m.value,"wbc"),(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,style:{"padding-bottom":"5px"}},[(0,s.Lk)("th",zd,(0,n.v_)(e?.name),1),(0,s.Lk)("td",Zd,(0,n.v_)(e?.count),1),(0,s.Lk)("td",em,(0,n.v_)(e?.percent)+" %",1)])))),128)),(0,s.Lk)("tr",tm,[am,(0,s.Lk)("td",lm,(0,n.v_)(y.value?.wbcInfo?.totalCount),1),sm]),"bm"!==(0,o.R1)(a)?((0,s.uX)(),(0,s.CE)("th",om,"non-Wbc")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(W(m.value,"nonWbc"),(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},["bm"!==(0,o.R1)(a)?((0,s.uX)(),(0,s.CE)("tr",nm,[(0,s.Lk)("td",im,(0,n.v_)(e.name),1),(0,s.Lk)("td",rm,(0,n.v_)(e.count),1),cm])):(0,s.Q3)("",!0)],64)))),128)),(0,s.Lk)("tr",um,[dm,(0,s.bo)((0,s.Lk)("td",mm,[(0,s.Lk)("pre",vm,(0,n.v_)(y.value?.wbcMemo),1)],512),[[l.aG,y.value?.wbcMemo]])])])]),(0,s.Lk)("ul",pm,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(G(m.value),(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,style:{}},[(0,s.Lk)("div",gm,(0,n.v_)(e?.title)+" ("+(0,n.v_)(e?.count)+") ",1),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+e?.title),style:{"list-style":"none","padding-left":"0","margin-top":"10px","text-align":"left"}},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>((0,s.uX)(),(0,s.CE)("li",{key:t.fileName,style:{display:"inline-block","margin-right":"5px","margin-top":"5px",outline:"1px solid #2c2d2c",cursor:"auto"}},[(0,s.Lk)("div",fm,[K.value[`${e.id}-${t.fileName}`]?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,src:X(t.fileName,e.id,e.title),width:t.width?t.width:"150px",height:t.height?t.height:"150px",onError:a=>O(e.id,t.fileName),style:(0,n.Tr)({filter:t.filter}),class:"cellImg",ref_for:!0,ref:"cellRef"},null,44,Im)),(0,s.Lk)("div",{class:"center-point",style:(0,n.Tr)(t.coordinates)},null,4)])])))),128))],2)])))),128))])])])],512)])],64))}});const bm=ym;var Cm=bm;const hm={key:0,class:"loaderBackground"},Sm=(0,s.Lk)("div",{class:"loader"},null,-1),km=(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1),Nm=[Sm,km],_m=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"15%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"3%"}),(0,s.Lk)("col",{width:"15%"}),(0,s.Lk)("col",{width:"3%"})],-1),Em=(0,s.Lk)("th",null,"NO",-1),wm=(0,s.Lk)("th",null,"Type",-1),Rm=(0,s.Lk)("th",null,"State",-1),Lm=(0,s.Lk)("th",null,"Tray Slot",-1),Tm=(0,s.Lk)("th",null,"Barcode NO",-1),Pm=(0,s.Lk)("th",null,"Patient ID",-1),Am=(0,s.Lk)("th",null,"Patient Name",-1),Dm=(0,s.Lk)("th",null,"Analyzed Date",-1),Mm=(0,s.Lk)("th",null,"Tact Time(S)",-1),xm=(0,s.Lk)("th",null,"Submit",-1),Km=(0,s.Lk)("th",null,"Submit Date",-1),Om=(0,s.Lk)("th",null,"Edit",-1),Bm={key:0},Fm=["onClick","onDblclick","data-row-id","onContextmenu"],Um=["onClick"],$m=["onUpdate:modelValue","checked"],Wm={key:1},Xm=(0,s.Lk)("tr",{class:"text-center"},[(0,s.Lk)("td",{colspan:"13"}," NO Data")],-1),Gm=[Xm],Hm=(0,s.Lk)("h2",null,"Edit order data",-1),Vm={class:"editOrder"},jm={class:"flexColumn"},Ym=(0,s.Lk)("label",{for:"testType"},"PB/BF",-1),qm={class:"flexColumn"},Qm=(0,s.Lk)("label",{for:"traySlot"},"Tray Slot",-1),Jm={class:"flexColumn"},zm=(0,s.Lk)("label",{for:"barcode"},"BARCODE ID",-1),Zm={class:"flexColumn"},ev=(0,s.Lk)("label",{for:"patientId"},"PATIENT ID",-1),tv={class:"flexColumn"},av=(0,s.Lk)("label",{for:"patientName"},"PATIENT NAME",-1),lv={class:"flexColumn"},sv=(0,s.Lk)("label",{for:"analyzedDate"},"Analyzed date",-1),ov={class:"flexColumn"},nv=(0,s.Lk)("label",{for:"signedState"},"Signed state",-1),iv={key:0},rv=(0,s.Lk)("p",null,"Barcode Image",-1),cv=["src"];var uv={__name:"listTable",props:["dbData","selectedItemIdFalse","notStartLoading","loadingDelayParents"],setup(e,{emit:t}){const a=e,i=(0,o.KR)(null),r=t,u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)({}),v=(0,c.Pj)(),p=(0,s.EW)((()=>v.state.userModule)),y=(0,o.KR)(""),b=(0,o.KR)(!1),C=(0,o.KR)(""),h=(0,o.KR)(""),S=(0,o.KR)(""),k=(0,o.KR)(!1),N=e=>{const t=V()(e,"YYYYMMDDHHmmssSSSSS");return t.format("YYYY-MM-DD HH:mm:ss")},_=(0,o.KR)({visible:!1,x:0,y:0}),E=(0,o.KR)([]),w=sessionStorage.getItem("user"),R=JSON.parse(w||"{}"),L=(0,o.KR)(""),T=(0,o.KR)({}),P=(0,o.KR)(!1),A=(0,o.KR)(null),D=(0,o.KR)([]),M=(0,o.KR)(!1),x=(0,s.nI)(),K=(0,o.KR)(""),O=(0,s.EW)((()=>v.state.commonModule.iaRootPath)),B=(0,s.EW)((()=>v.state.commonModule.selectedSampleId)),F=(0,s.EW)((()=>v.state.commonModule)),U=(0,o.KR)(!1),$=(0,o.KR)(!1),W=(0,o.KR)(""),X=(0,o.KR)("");let H;const j=(0,o.KR)(null),Y=(0,o.KR)(!1);async function q(e){e.ctrlKey&&(U.value=!0),e.shiftKey&&($.value=!0)}function Q(e){e.ctrlKey||(U.value=!1),e.shiftKey||($.value=!1)}(0,s.sV)((async()=>{S.value=JSON.parse(sessionStorage.getItem("pcIp")),y.value=window.PROJECT_TYPE;try{L.value=R.id,await Ie()}catch(e){console.log(e)}document.addEventListener("click",se),window.addEventListener("keydown",q),window.addEventListener("keyup",Q)})),(0,s.hi)((()=>{document.removeEventListener("click",se)})),(0,s.wB)((()=>a.loadingDelayParents),(e=>{k.value=!!e}),{deep:!0}),(0,s.nT)((async()=>{if(a.dbData.length>0){await(0,s.dY)(),a.selectedItemIdFalse;const e=a.dbData.filter((e=>e.id===Number(B.value||0))),t=new IntersectionObserver(ce,{root:null,rootMargin:"0px",threshold:.5});if(i.value&&t.observe(i.value),"0"!==u.value&&u.value||(k.value=!1),!0===F.value.dataBasePageReset&&0!==e.length){await ve(e[0]),await v.dispatch("commonModule/setCommonInfo",{dataBasePageReset:!1}),await ae();const t=document.querySelector(`[data-row-id="${e[0].id}"]`);return void(t&&"0"!==u.value&&(k.value=!1))}}}));const J=()=>{P.value=!1},z=()=>{P.value=!0,le()},Z=()=>{he(T.value),le()},ee=()=>{fe(T.value),le()},te=()=>{a.dbData.forEach((e=>{e.checked=M.value})),r("checkListItem",a.dbData.filter((e=>e.checked)))},ae=()=>{a.dbData.forEach((e=>{e.checked=!1})),r("checkListItem",a.dbData.filter((e=>e.checked)))},le=()=>{_.value.x=0,_.value.y=0,_.value.visible=!1},se=e=>{const t=document.querySelector(".context-menu");t&&!t.contains(e.target)&&le()},oe=async(e,t)=>{if(!1!==a.dbData.filter((t=>t.id===e.id)).lock_status){if(await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:e.id}),T.value=e,0!==Object.keys(e?.wbcInfo).length){const t=e?.wbcInfo?.wbcInfo[0],a=t.sort(((e,t)=>e.id-t.id));D.value=a}t&&(_.value.x=t.clientX,_.value.y=t.clientY,_.value.visible=!0)}else ue(G.IDS_ERROR_SELECT_A_TARGET_ITEM)},ne=()=>{const e=Math.min(Number(W.value),Number(X.value)),t=Math.max(Number(W.value),Number(X.value)),l=a.dbData;l.forEach((a=>{const l=Number(a.id);l>=e&&l<=t&&(a.checked=!a.checked)})),r("checkListItem",a.dbData.filter((e=>e.checked)))},ie=e=>{e&&(e.checked=!e.checked,r("checkListItem",a.dbData.filter((e=>e.checked))))},ce=(e,t)=>{e.forEach((e=>{e.isIntersecting&&1!==e.intersectionRatio&&r("loadMoreData")}))},ue=e=>{b.value=!0,C.value="success",h.value=e},de=e=>{b.value=!0,C.value="error",h.value=e},me=()=>{b.value=!1},ve=async e=>{$.value?W.value&&(X.value=e.id,ne()):X.value="",U.value&&ie(e),e&&(W.value=e.id,r("selectItem",e),u.value=e.id,await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(e.id)}))},pe=async e=>{try{const t=await Ot(),a=t.data,l=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:s,endDate:o,page:n,searchText:i,nrCount:r,testType:c,wbcInfo:u,wbcTotal:d}=JSON.parse(l),m=s+o+n+i+r+c+u+d,v=`oldPcIp=${a}&newEntityId=${e.id}&newPcIp=${a}&dayQuery=${m}`;await yu(v).then((e=>{ge("SEND_DATA","refreshDb",300)})).catch((e=>{console.log(e)}))}catch(t){console.log(t)}},ge=(e,t,a)=>{void 0!==H&&clearTimeout(H),H=window.setTimeout((()=>{x?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},fe=async e=>{e.lock_status&&e?.pcIp!==S.value||(await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:e.id}),await v.dispatch("commonModule/setCommonInfo",{clonedRbcInfo:e.rbcInfo.rbcClass}),await pe(e),await VC.push("/databaseDetail"))},Ie=async()=>{try{const e=await re(),t=e.data;E.value=t}catch(e){}},ye=e=>{d.value=e},be=()=>{},Ce=async()=>{try{const e={id:m.value.id,barcodeNo:m.value.barcodeNo,patientId:m.value.patientId,patientNm:m.value.patientNm},t=[...a.dbData],l=t.findIndex((e=>e.id===m.value.id));-1!==l&&(t[l]={...t[l],...e});const s=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:o,endDate:n,page:i,searchText:c,nrCount:u,testType:d,wbcInfo:v,wbcTotal:g}=JSON.parse(s),f=o+n+i+c+u+d+v+g,I=await uu({userId:Number(p.value.id),runingInfoDtoItems:[t[l]],dayQuery:f});I?(ue("success"),r("initData"),ye()):console.error("백엔드가 디비에 저장 실패함")}catch(e){console.error("Error:",e)}},he=async e=>{Se(),m.value=JSON.parse(JSON.stringify(e)),m.value.submitState=["","Ready","checkFirst"].includes(m.value.submitState)?"":m.value.submitState,m.value.testType="bm"!==y.value?g(e?.testType):f(e?.testType);const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:O.value;K.value=I("barcode_image.jpg",t,e.slotId,wt.barcodeDirName)},Se=()=>{d.value=!0},ke=async()=>{try{let e=a.dbData.filter((e=>e.checked));if(0===e.length&&""===u.value)de(G.IDS_ERROR_SELECT_A_TARGET_ITEM);else if(0===e.length&&""!==u.value){if(e=a.dbData.find((e=>e.id===u.value)),e.lock_status)return void de(G.lockRow);const t=e,l=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),s=`${l}/${e.slotId}`,o=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:n,endDate:i,page:c,searchText:d,nrCount:m,testType:v,wbcInfo:p,wbcTotal:g}=JSON.parse(o),f=n+i+c+d+m+v+p+g,I={ids:[t.id],img_drive_root_path:[s],dayQuery:f},y=await mu(I);y.success?(ue("Items deleted successfully"),r("refresh"),le()):console.error("Failed to delete items")}else{const t=e.map((e=>e.id)),a=e.map((e=>e.lock_status));if(a.includes(!0))return void de(G.lockRow);const l=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),s=e.map((e=>`${l}/${e.slotId}`)),o=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:n,endDate:i,page:c,searchText:u,nrCount:d,testType:m,wbcInfo:v,wbcTotal:p}=JSON.parse(o),g=n+i+c+u+d+m+v+p,f={ids:t,img_drive_root_path:s,dayQuery:g},I=await mu(f);I.success?(ue("Items deleted successfully"),r("refresh"),le()):console.error("Failed to delete items")}}catch(e){console.error("Error:",e)}},Ne=(e,t)=>{switch(e){case"Ready":return"Ready";case"Submit":return`Submit (${t})`;default:return"Ready"}},_e=()=>{Y.value=!0};return(t,a)=>{const r=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[k.value?((0,s.uX)(),(0,s.CE)("div",hm,Nm)):(0,s.Q3)("",!0),(0,s.Lk)("table",{class:"defaultTable mt2 dbDataTable",ref_key:"scrollableDiv",ref:j},[_m,(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[Em,(0,s.Lk)("th",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=e=>M.value=e),onChange:te},null,544),[[l.lH,M.value]])]),wm,Rm,Lm,Tm,Pm,Am,Dm,Mm,xm,Km,Om])]),0!==e.dbData.length?((0,s.uX)(),(0,s.CE)("tbody",Bm,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.dbData,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,n.C4)({selectedTr:u.value===e.id,submittedTr:"Submit"===e.submitState||"lis"===e.submitState,rock:e.lock_status&&e.pcIp!==S.value,checkFirst:"checkFirst"===e.submitState}),onClick:t=>ve(e),onDblclick:t=>fe(e),ref_for:!0,ref:"firstRow",style:{height:"49px"},"data-row-id":e.id,onContextmenu:(0,l.D$)((t=>oe(e,t)),["prevent"]),title:"Double click the row"},[(0,s.Lk)("td",null,["N"===e.isNormal?((0,s.uX)(),(0,s.Wv)(r,{key:0,class:"red",icon:["fas","triangle-exclamation"]})):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,n.v_)(t+1),1)]),(0,s.Lk)("td",{onClick:t=>ie(e)},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.checked=t,checked:e.checked},null,8,$m),[[l.lH,e.checked]])],8,Um),(0,s.Lk)("td",null,(0,n.v_)("bm"!==y.value?(0,o.R1)(g)(e?.testType):(0,o.R1)(f)(e?.testType)),1),(0,s.Lk)("td",null,[(0,s.bF)(r,{icon:["fas",""+(e?.lock_status?"lock":"lock-open")]},null,8,["icon"])]),(0,s.Lk)("td",null,(0,n.v_)(e?.traySlot),1),(0,s.Lk)("td",null,(0,n.v_)(e?.barcodeNo),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientId),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientNm),1),(0,s.Lk)("td",null,(0,n.v_)(""===e?.analyzedDttm?"":N(e?.analyzedDttm)),1),(0,s.Lk)("td",null,(0,n.v_)(e?.tactTime),1),(0,s.Lk)("td",null,(0,n.v_)(Ne(e?.submitState,e?.submitUserId)),1),(0,s.Lk)("td",null,(0,n.v_)(""!==e?.submitOfDate&&e?.submitOfDate?N(e?.submitOfDate):""),1),(0,s.Lk)("td",null,["checkFirst"===e?.submitState||""===e?.submitState?((0,s.uX)(),(0,s.Wv)(r,{key:0,icon:["fas","pen-to-square"],onClick:t=>he(e)},null,8,["onClick"])):(0,s.Q3)("",!0)])],42,Fm)))),128)),(0,s.Lk)("tr",null,[(0,s.Lk)("div",{ref_key:"loadMoreRef",ref:i,style:{height:"30px"}},null,512)])])):((0,s.uX)(),(0,s.CE)("tbody",Wm,Gm))],512),_.value.visible?((0,s.uX)(),(0,s.CE)("div",{key:1,style:(0,n.Tr)({top:_.value.y-100+"px",left:_.value.x+"px"}),class:"context-menu"},[(0,s.Lk)("ul",null,[(0,s.Lk)("li",{onClick:z},"Print"),(0,s.Lk)("li",{onClick:ee},"Classification"),(0,s.Lk)("li",{onClick:Z},"Edit order data"),(0,s.Lk)("li",{onClick:ke},"Delete")])],4)):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(rr,{key:2,"onUpdate:closeLayer":ye,onAfterOpen:be},{header:(0,s.k6)((()=>[Hm])),content:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Vm,[(0,s.Lk)("li",jm,[Ym,(0,s.bo)((0,s.Lk)("input",{id:"testType",class:"inputDisabled",type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>m.value.testType=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.testType]])]),(0,s.Lk)("li",qm,[Qm,(0,s.bo)((0,s.Lk)("input",{id:"traySlot",class:"inputDisabled",type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>m.value.traySlot=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.traySlot]])]),(0,s.Lk)("li",Jm,[zm,(0,s.bo)((0,s.Lk)("input",{id:"barcode",type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>m.value.barcodeNo=e),placeholder:"BARCODE ID"},null,512),[[l.Jo,m.value.barcodeNo]])]),(0,s.Lk)("li",Zm,[ev,(0,s.bo)((0,s.Lk)("input",{id:"patientId",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>m.value.patientId=e),placeholder:"PATIENT ID"},null,512),[[l.Jo,m.value.patientId]])]),(0,s.Lk)("li",tv,[av,(0,s.bo)((0,s.Lk)("input",{id:"patientName",type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>m.value.patientNm=e),placeholder:"PATIENT NAME"},null,512),[[l.Jo,m.value.patientNm]])]),(0,s.Lk)("li",lv,[sv,(0,s.bo)((0,s.Lk)("input",{id:"analyzedDate",class:"inputDisabled",type:"text","onUpdate:modelValue":a[6]||(a[6]=e=>m.value.analyzedDttm=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.analyzedDttm]])]),(0,s.Lk)("li",ov,[nv,(0,s.bo)((0,s.Lk)("input",{id:"signedState",class:"inputDisabled",type:"text","onUpdate:modelValue":a[7]||(a[7]=e=>m.value.submitState=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.submitState]])]),Y.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",iv,[rv,(0,s.Lk)("img",{class:"mt1",src:K.value,onError:_e},null,40,cv)]))])]),(0,s.Lk)("div",{class:"modalBottom"},[(0,s.Lk)("button",{class:"alertButton",onClick:Ce},"Save")])])),_:1})):(0,s.Q3)("",!0),P.value?((0,s.uX)(),(0,s.Wv)(Cm,{key:3,selectItems:T.value,ref_key:"printContent",ref:A,printOnOff:P.value,selectItemWbc:D.value,onPrintClose:J},null,8,["selectItems","printOnOff","selectItemWbc"])):(0,s.Q3)("",!0),b.value?((0,s.uX)(),(0,s.Wv)(at,{key:4,"is-visible":b.value,type:C.value,message:h.value,onHide:me,"onUpdate:hideAlert":me},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}};const dv=uv;var mv=dv;const vv={key:0},pv=(0,s.Lk)("h3",{class:"orderTitle hh3title"},"Order Information",-1),gv={class:"orderListWrapper",style:{padding:"0"}},fv={class:"orderListUi"},Iv={class:"flexColumn"},yv=(0,s.Lk)("span",{class:"mb1"},"Order ID:",-1),bv={class:"mb2"},Cv=["src"],hv={class:"resultInformationContainer",style:{"padding-top":"0"}},Sv=(0,s.Lk)("h3",{class:"mt2 mb1 hh3title"},"Result Information",-1),kv={class:"resInfoTopContainer"},Nv={key:0},_v={class:"resInfoContainer"},Ev=(0,s.Lk)("li",{class:"resInfoWrapper mb1"},[(0,s.Lk)("p",null,"Class"),(0,s.Lk)("p",null,"Count"),(0,s.Lk)("p",null,"Percent")],-1),wv={key:0,class:"resInfoWrapper resInfoWrapperLine"},Rv={class:"resInfoWrapper mt1 mb2"},Lv=(0,s.Lk)("p",null,"Total",-1),Tv=(0,s.Lk)("p",null,"100%",-1),Pv={key:0,class:"resInfoWrapper resInfoWrapperLine"},Av=(0,s.Lk)("p",null,"-",-1);var Dv={__name:"listInfo",props:["selectedItem"],setup(e){const t=(0,c.Pj)(),a=e,i=(0,o.KR)(t.state.commonModule.iaRootPath),r=(0,s.EW)((()=>t.state.commonModule.siteCd)),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(0),v=["NR","GP","PA","AR","MA","SM","OT"],p=(0,o.KR)(""),g=(0,o.KR)({}),f=(0,o.KR)({});(0,s.KC)((()=>{p.value=window.PROJECT_TYPE})),(0,s.sV)((async()=>{await C(),d.value=!1,i.value&&(u.value=E("barcode_image.jpg"))})),(0,s.wB)((()=>a.selectedItem),(e=>{d.value=!1,h(),y(),i.value&&(u.value=E("barcode_image.jpg",e))}));const I=e=>{let t="";const a=e.find((e=>"NE"===e.title));return t=a?"Y":"N",t},y=async()=>{if(!g.value||0===g.value.length||!Array.isArray(g.value))return void(f.value=a.selectedItem.wbcInfoAfter);const e=g.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),t=0!==g.value.length?e:"bm"===p.value?wa:Ea,l=b(a.selectedItem.wbcInfoAfter,t);f.value=l},b=(e,t)=>{let a=e.slice();return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s}))},C=async()=>{try{const e=await He();e&&(0===e?.data.length?g.value=[]:g.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}},h=async()=>{m.value=a.selectedItem.wbcInfoAfter.reduce(((e,t)=>v.includes(t.title)?e:e+Number(t.count)),0);for(const e of a.selectedItem.wbcInfoAfter)if("bm"===window.PROJECT_TYPE){if("OT"!==e.title){const t=(Number(e.count)/Number(m.value)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}else{const t=mc.find((e=>"서울성모병원"===e.hospitalNm))?.siteCd===r.value,l=mc.find((e=>"인하대병원"===e.hospitalNm))?.siteCd===r.value;if(l&&"04"!==a.selectedItem?.testType)f.value=await _u(a.selectedItem,a.selectedItem.wbcInfoAfter);else if(t)f.value=Eu(a.selectedItem.wbcInfoAfter,a.selectedItem.wbcInfoAfter);else{const t=S(r.value,a.selectedItem?.testType);if(!t.includes(e.title)){const t=(Number(e.count)/Number(m.value)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}}},S=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},k=e=>e&&e.length>0&&!v.includes(e),N=e=>e&&e.length>0&&v.includes(e),_="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL;function E(e){const t=""!==a.selectedItem?.img_drive_root_path&&a.selectedItem?.img_drive_root_path?a.selectedItem?.img_drive_root_path:i.value;return`${_}/images?folder=${t+"/"+a.selectedItem.slotId+"/"+wt.barcodeDirName+"/"}&imageName=${e}`}const w=()=>{d.value=!0};return(t,a)=>0!==Object.keys(e.selectedItem).length?((0,s.uX)(),(0,s.CE)("div",vv,[(0,s.Lk)("div",null,[pv,(0,s.Lk)("div",gv,[(0,s.Lk)("ul",fv,[(0,s.Lk)("li",Iv,[yv,(0,s.Lk)("span",bv,(0,n.v_)(e.selectedItem?.slotId),1)]),(0,s.Lk)("li",null,"NS, NB Integration: "+(0,n.v_)(I(e.selectedItem.wbcInfoAfter)),1)]),(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("img",{onError:w,src:u.value,style:{width:"200px",float:"right"}},null,40,Cv),[[l.aG,!d.value]])])])]),(0,s.Lk)("div",hv,[Sv,(0,s.Lk)("ul",kv,["01"===e.selectedItem?.testType||"04"===e.selectedItem?.testType||"bm"===p.value?((0,s.uX)(),(0,s.CE)("li",Nv,[(0,s.Lk)("div",_v,[Ev,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.title},[k(e.title)&&e.count>0?((0,s.uX)(),(0,s.CE)("li",wv,[(0,s.Lk)("p",null,(0,n.v_)(e.title),1),(0,s.Lk)("p",null,(0,n.v_)(e.count),1),(0,s.Lk)("p",null,(0,n.v_)((0,o.R1)(Nu)(e.percent)+"%"),1)])):(0,s.Q3)("",!0)],64)))),128)),(0,s.Lk)("li",Rv,[Lv,(0,s.Lk)("p",null,(0,n.v_)(m.value),1),Tv]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.title},[N(e.title)&&e.count>0?((0,s.uX)(),(0,s.CE)("li",Pv,[(0,s.Lk)("p",null,(0,n.v_)(e.title),1),(0,s.Lk)("p",null,(0,n.v_)(e.count),1),Av])):(0,s.Q3)("",!0)],64)))),128))])])):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0)}};const Mv=Dv;var xv=Mv;const Kv={class:"mt1 listTableImageContainer"},Ov=(0,s.Lk)("h3",{class:"mb1 hh3title infoImageTitle"},"WBC Images",-1),Bv={key:0,class:"dbImageContainer"},Fv=["src","onError","onClick"],Uv={key:1};var $v=(0,s.pM)({__name:"listWbcImg",props:["dbData","selectedItem"],setup(e){const t=e,a=(0,c.Pj)(),i=(0,o.KR)(a.state.commonModule.iaRootPath),r=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),u="viewer"===r.value?window.MAIN_API_IP:window.APP_API_BASE_URL,d=(0,o.KR)([]),m=(0,o.KR)({}),v=(0,o.KR)("");(0,s.sV)((()=>{d.value=[],f()})),(0,s.wB)((()=>t.selectedItem),(()=>{d.value=[],f()}),{deep:!0});const p=e=>{v.value===e?v.value="":v.value=e},g=e=>v.value===e;function f(){t.selectedItem?.wbcInfo&&0!==Object.keys(t.selectedItem?.wbcInfo).length&&(d.value=t.selectedItem?.wbcInfo?.wbcInfo[0]?.reduce(((e,t)=>(t.images&&t.images.length>0&&e.push({id:t.id,images:t.images,title:t.title}),e)),[])||[])}function I(e,a,l){const{selectedItem:s}=t;if(!s?.wbcInfo?.wbcInfo||0===s?.wbcInfo?.wbcInfo.length)return"";const o=s.slotId||"",n=""!==s?.img_drive_root_path&&s?.img_drive_root_path?s?.img_drive_root_path:i.value,r=`${n}/${o}/01_WBC_Classification/${a}_${l}`;return`${u}/images/getImageRealTime?folder=${r}&imageName=${e}`}function y(e,t){m.value[`${e}-${t}`]=!0}return(e,t)=>((0,s.uX)(),(0,s.CE)("div",Kv,[Ov,d.value.length>0?((0,s.uX)(),(0,s.CE)("div",Bv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("img",{key:t.fileName,class:(0,n.C4)(["dbRightImages",["dbRightImages",{"selected-image":g(`${e.id}-${t.fileName}`)}]]),src:I(t.fileName,e.id,e.title),onError:a=>y(e.id,t.fileName),onClick:a=>p(`${e.id}-${t.fileName}`)},null,42,Fv)),[[l.aG,!m.value[`${e.id}-${t.fileName}`]]]))),128))],64)))),128))])):((0,s.uX)(),(0,s.CE)("div",Uv,"No images available"))]))}});const Wv=$v;var Xv=Wv;const Gv={class:"mt3 listTableImageContainer"},Hv=(0,s.Lk)("h3",{class:"mb1 hh3title infoImageTitle"},"BM Images",-1),Vv={key:0,class:"dbImageContainer"},jv=["src","onError"],Yv={key:1};var qv=(0,s.pM)({__name:"listBmImg",props:["dbData","selectedItem"],setup(e){const t=e,a=(0,c.Pj)(),n=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),i=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),r="viewer"===i.value?window.MAIN_API_IP:window.APP_API_BASE_URL,u=(0,o.KR)([]),d=(0,o.KR)({});function m(){t.selectedItem?.wbcInfo&&0!==Object.keys(t.selectedItem?.wbcInfo).length&&(u.value=t.selectedItem?.wbcInfo?.wbcInfo[0]?.reduce(((e,t)=>(t.images&&t.images.length>0&&e.push({id:t.id,images:t.images,title:t.title}),e)),[])||[])}function v(e,a,l){const{selectedItem:s}=t;if(!s?.wbcInfo?.wbcInfo||0===s?.wbcInfo?.wbcInfo.length)return"";const o=s.slotId||"",i=""!==s?.img_drive_root_path&&s?.img_drive_root_path?s?.img_drive_root_path:n.value,c=`${i}/${o}/04_BM_Classification/${a}_${l}`;return`${r}/images?folder=${c}&imageName=${e}`}function p(e,t){d.value[`${e}-${t}`]=!0}return(0,s.sV)((()=>{m()})),(0,s.wB)((()=>t.selectedItem),(()=>{m()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",Gv,[Hv,u.value.length>0?((0,s.uX)(),(0,s.CE)("div",Vv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("img",{key:t.fileName,class:"dbRightImages",src:v(t.fileName,e.id,e.title),onError:a=>p(e.id,t.fileName)},null,40,jv)),[[l.aG,!d.value[`${e.id}-${t.fileName}`]]]))),128))],64)))),128))])):((0,s.uX)(),(0,s.CE)("div",Yv,"No images available"))]))}});const Qv=qv;var Jv=Qv;const zv=ee(),Zv=async e=>zv.httpPost(te.excel.execute,e),ep={key:0,class:"loaderBackgroundForLogin"},tp=(0,s.Lk)("div",{class:"loaderForLogin"},null,-1),ap=(0,s.Lk)("p",{class:"loadingTextLogin"},"Loading...",-1),lp=[tp,ap],sp={class:"titleH3"},op={class:"listBoxTable"},np={class:"filterListDiv"},ip=(0,s.Lk)("option",{value:"barcodeNo"},"Barcode No",-1),rp=(0,s.Lk)("option",{value:"patientId"},"Patient ID",-1),cp=(0,s.Lk)("option",{value:"patientNm"},"Patient Name",-1),up=[ip,rp,cp],dp={class:"settingDatePickers"},mp={key:0,class:"excelDivList"},vp={key:0,class:"filterDivBox"},pp={key:0,class:"nrCount"},gp=(0,s.Lk)("span",null,"NR count",-1),fp={class:"wbcTotal"},Ip=(0,s.Lk)("span",null,"WBC Total",-1),yp=(0,s.Lk)("option",{value:"all"},"Do Not Select",-1),bp=(0,s.Lk)("option",null,"DESC",-1),Cp=(0,s.Lk)("option",null,"ASC",-1),hp=[yp,bp,Cp],Sp={class:"wbcInfoFilter"},kp={class:"wbcInfoFilter"},Np=["id","onUpdate:modelValue"],_p=["for"],Ep={class:"lastTestType"},wp=(0,s.Lk)("span",null,"Test Type",-1),Rp=["checked"],Lp=(0,s.Lk)("span",null,"ALL",-1),Tp=["checked"],Pp=(0,s.Lk)("span",null,"Diff",-1),Ap=["checked"],Dp=(0,s.Lk)("span",null,"PBS",-1),Mp=["checked"],xp=(0,s.Lk)("span",null,"Wedge",-1),Kp=["checked"],Op=(0,s.Lk)("span",null,"Biopsy",-1),Bp=["checked"],Fp=(0,s.Lk)("span",null,"Squash",-1),Up={class:"listBox"},$p=100;var Wp=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)([]),i=(0,o.KR)(!1),r=(0,o.KR)(""),u=new Date,d=new Date(u);d.setDate(u.getDate()-29);const m=(0,o.KR)(d),v=(0,o.KR)(new Date),p=(0,o.KR)(""),g=(0,o.KR)("barcodeNo"),f=(0,o.KR)(1),I=(0,o.KR)(1),y=(0,o.KR)({}),b=(0,o.KR)([]),C=(0,o.KR)([]),h=(0,o.KR)(0),S=(0,o.KR)(""),k=(0,o.KR)(""),N=(0,o.KR)(!1),_=(0,o.KR)(!1),E=(0,s.nI)(),w=(0,o.KR)(""),R=(0,o.KR)(""),L=(0,o.KR)([]),T=(0,o.KR)(t.state.commonModule.iaRootPath),P=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),A="viewer"===P.value?window.MAIN_API_IP:window.APP_API_BASE_URL,D=(0,o.KR)(!1),M=(0,o.KR)(!1),x=(0,o.KR)(!1),K=(0,o.KR)(!1),O=(0,o.KR)(null),B=(0,o.KR)(!1),F=(0,o.KR)([]),U=(0,o.KR)(0),$=(0,o.KR)(0),W=(0,o.KR)(0),X=(0,o.KR)(0),G=(0,o.KR)(0),H=(0,o.KR)(0),j=(0,o.KR)(0),Y=(0,o.KR)([]),q=(0,o.KR)([]),Q=(0,o.KR)([]),z=(0,o.KR)(null),Z=(0,o.KR)("");async function ee(e){D.value=!0,K.value=!1,await Cu(),await me().then((()=>{}))}(0,s.KC)((async()=>{_.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{D.value||await me(),document.addEventListener("click",ie),O.value&&O.value.focus(),K.value=!0,E?.appContext.config.globalProperties.$socket.on("stateVal",ee),document.addEventListener("keydown",oe)}));const te=(0,o.KR)("");let ae=Date.now();const le={value:!1},se=e=>{if(!e.data)return;const t=Date.now(),a=t-ae;le.value=a<50,ae=t,le.value&&(Z.value+=e.data,z.value&&clearTimeout(z.value),z.value=setTimeout((()=>{const e=Z.value.trim();e!==te.value&&(p.value=e,te.value=e),Z.value="",Ie()}),$p))},oe=e=>{"/dataBase"===VC.currentRoute.value.path&&("Enter"!==e.key&&"Tab"!==e.key||setTimeout((()=>{if(O.value){O.value.focus(),p.value=p.value.trim();const e=p.value.trim();e!==te.value&&(te.value=e)}}),10))},ne=()=>{O.value&&Ie()};(0,s.xo)((()=>{document.removeEventListener("click",ie)}));const ie=e=>{const t=document.querySelector(".filterDivBox"),a=document.querySelector(".classificationListBtn");a&&a.contains(e.target)||t&&!t.contains(e.target)&&(N.value=!1)},ce=()=>{N.value=!N.value},ue=e=>{S.value=S.value===e?"":e},de=()=>{const e=b.value?.filter((e=>e.checked)).map((e=>e.title));C.value=e},me=async()=>{M.value=!0;const e=ge();0!==Object.keys(e).length?(g.value=e.searchType||"barcodeNo",p.value=e.searchText||"",m.value=new Date(e.startDate)||new Date,v.value=new Date(e.endDate)||new Date,f.value=e.page||1,await fe("search")):await fe("mounted",1)},ve=e=>{y.value=e},pe=()=>{const e={page:f.value,prevPage:I.value,searchType:g.value,searchText:p.value,startDate:J(m.value),endDate:J(v.value),nrCount:h.value,wbcTotal:k.value,wbcInfo:C.value,testType:S.value};sessionStorage.setItem("lastSearchParams",JSON.stringify(e)),localStorage.setItem("lastSearchParams",JSON.stringify(e))},ge=()=>{const e=sessionStorage.getItem("lastSearchParams");return e?JSON.parse(e):{}},fe=async(e,l)=>{"search"===e?(L.value=[],x.value=!0,K.value=!0,f.value=1):(x.value=!1,K.value=!1);let s=0;s="loadMoreData"===e?f.value:"loadPrevData"===e?I.value:f.value;const o={page:"mounted"!==e?s:Number(l),pageSize:20,startDay:""===p.value?J(m.value):"",endDay:""===p.value?J(v.value):"",barcodeNo:"barcodeNo"===g.value?p.value:void 0,patientId:"patientId"===g.value?p.value:void 0,patientNm:"patientNm"===g.value?p.value:void 0,nrCount:h.value};""===w.value&&(w.value=o.page),0!==C.value.length&&(o.title=C.value),"00"!==S.value&&""!==S.value&&(o.testType=S.value),""!==k.value&&"all"!==k.value&&(o.wbcCountOrder=k.value);try{const l=await du(o);if(pe(),1===f.value&&0===l.data.data.length)return void(M.value=!1);if(l&&l.data){w.value=o.page,R.value=o;const t=l.data.data;0===t.length?(1===f.value?f.value=1:f.value-=1,0===t.length&&"1"===String(l.data?.page)&&(a.value=t)):("search"===e?a.value=t:t.forEach((e=>{const t=a.value.findIndex((t=>t.id===e.id));-1!==t?a.value[t]=e:a.value.push(e)})),0===b.value.length&&(b.value=a.value[0]?.wbcInfo?.wbcInfo[0]),""!==k.value&&"all"!==k.value||(a.value=a.value.sort(((e,t)=>{const a=V()(e.analyzedDttm,"YYYYMMDDHHmmssSSS"),l=V()(t.analyzedDttm,"YYYYMMDDHHmmssSSS");return l.diff(a)}))),0!==a.value.length||(f.value-=1))}a.value.length>0&&(await t.dispatch("commonModule/setCommonInfo",{dbListDataFirstNum:Number(a.value[0].id)}),await t.dispatch("commonModule/setCommonInfo",{dbListDataLastNum:Number(a.value[a.value.length-1].id)}))}catch(n){console.error(n)}},Ie=()=>{a.value=[],sessionStorage.removeItem("lastSearchParams");const e=v.value.getTime()-m.value.getTime(),t=e/864e5;t>30?he("You cannot select a period of more than 30 days."):fe("search")},ye=()=>{fe("search")},be=async()=>{f.value+=1,await fe("loadMoreData")},Ce=async()=>{I.value=ge().prevPage,I.value-=1,I.value<=0||await fe("loadPrevData")},he=async e=>{i.value=!0,r.value=e},Se=()=>{i.value=!1},ke=async()=>{0!==L.value.length?(B.value=!0,await _e(L.value),await Ne()):await he("Select an Item")},Ne=async()=>{const e="01"===L.value[0].testType||"04"===L.value[0].testType?"01_WBC_Classification":"05_BF_Classification",t=""!==y.value?.img_drive_root_path&&y.value?.img_drive_root_path?y.value?.img_drive_root_path:T.value,a=L.value.map((a=>`${t}\\${a.slotId}\\${e}`));try{const e=await Zv(a);"Application executed successfully"===e.data.message?await he("Excel created"):await he("Excel create failed")}catch(l){console.log(l),await he("Excel create failed")}finally{B.value=!1}},_e=async e=>{if(_.value)return;let t={},a={};for(const l of e){if("04"!==l.testType)continue;const e=await vu(String(l.id));await Pe();const s=e.data;Q.value=s.rbcInfo.rbcClass,q.value=s.rbcInfoAfter,await Re(s),await Le(),await Ae(Q.value),Ee(Q.value,q.value)&&await Ae(q.value);const o={before:{},after:{}},n=await Te(s);for(const a of Q.value){let e={};for(const t of a.classInfo){const a={[t.classNm]:{degree:t.degree,count:Number(t.originalDegree)}};e={...e,...a},"Basophilic Stippling"===t.classNm&&(e={...e,Malaria:{degree:"-",count:Number(s.rbcInfo.malariaCount)}})}"Shape"===a.categoryNm&&(e={...e,Others:{degree:"-",count:Number(n.doubleNormal+n.artifact)}}),t={...t,[a.categoryNm]:e},"Inclusion Body"===a.categoryNm&&(t={...t,Others:{Platelet:{degree:"-",count:Number(s.rbcInfo.pltCount)}}})}for(const t of q.value){let e={};for(const a of t.classInfo){const t={[a.classNm]:{degree:a.degree,count:Number(a.originalDegree)}};e={...e,...t},"Basophilic Stippling"===a.classNm&&(e={...e,Malaria:{degree:"-",count:Number(s.rbcInfo.malariaCount)}})}"Shape"===t.categoryNm&&(e={...e,Others:{degree:"-",count:Number(n.doubleNormal+n.artifact)}}),a={...a,[t.categoryNm]:e},"Inclusion Body"===t.categoryNm&&(a={...a,Others:{Platelet:{degree:"-",count:Number(s.rbcInfo.pltCount)}}})}o.before=t,o.after=a,await we(s.slotId,o)}},Ee=(e,t)=>{for(let a=0;a<e.length;a++){const l=e[a],s=t[a];for(let e=0;e<l.classInfo.length;e++){const t=l.classInfo[e],a=s.classInfo[e];if(String(t.degree)!==String(a.degree))return!1}}return!0},we=async(e,t)=>{const a=JSON.stringify(t),l=(new TextEncoder).encode(a),s=hu.Ay.deflate(l),o=new Blob([s],{type:"application/octet-stream"}),n=new FormData;n.append("file",o,"RBC.json");const i=""!==y.value?.img_drive_root_path&&y.value?.img_drive_root_path?y.value?.img_drive_root_path:T.value,r=`${i}/${e}/RBC_Analysis.json`;try{await fetch(`${A}/jsonReader/upload?filePath=${r}`,{method:"POST",body:n})}catch(c){console.error("Error:",c),he("Excel print failed"),B.value=!1}},Re=async e=>{const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:T.value,a=`${t}/${e?.slotId}/03_RBC_Classification/${e?.slotId}_new.json`,l=await Wc({fullPath:a}),s=`${t}/${e?.slotId}/03_RBC_Classification/${e?.slotId}.json`,o=await Wc({fullPath:s});if("not file"!==l.data){const e=l?.data;for(const t of o.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}F.value=o.data[0].rbcClassList}else F.value=o?.data[0].rbcClassList;if(!F.value||!Array.isArray(F.value))return void console.error("rbcInfoPathAfter.value is not iterable");let n=0,i=0,r=0,c=0;countArtifact.value=0,countDoubleNormal.value=0,F.value.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?countArtifact.value+=1:"DoubleNormal"===t.classNm&&(countDoubleNormal.value+=1);switch(e.categoryId){case"01":n=e.classInfo.length;break;case"02":i=e.classInfo.length;break;case"03":r=e.classInfo.length;break;case"05":c=e.classInfo.length;break;default:break}})),X.value=Number(n),G.value=Number(n),H.value=i,j.value=Number(r)+Number(c)},Le=async()=>{if(!q.value||!Array.isArray(q.value))return;if(!Q.value||!Array.isArray(Q.value))return;if(!F.value||!Array.isArray(F.value))return;for(const a of q.value)for(const e of a.classInfo){let t=0;for(const l of F.value)for(const s of l.classInfo)s.classNm.replace(/\s+/g,"")===e.classNm.replace(/\s+/g,"")&&l.categoryId===a.categoryId&&t++;e.originalDegree=t}let e=0,t=0;for(const a of F.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;U.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}$.value=Math.floor(e/parseFloat(U.value)*1e3),W.value=t},Te=async e=>{const t=""!==e.img_drive_root_path&&e.img_drive_root_path?e?.img_drive_root_path:T.value,a=`${t}/${e.slotId}/03_RBC_Classification/${e.slotId}.json`,l=await Wc({fullPath:a}),s=l.data[0].rbcClassList,o={artifact:0,doubleNormal:0};if(s)return s.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?o.artifact+=1:"DoubleNormal"===t.classNm&&(o.doubleNormal+=1)})),o},Pe=async()=>{try{const e=await re(),t=e.data;Y.value=t}catch(e){console.log(e)}},Ae=async e=>{if(_.value)return;let t=X.value,a=G.value,l=H.value;Array.isArray(Q.value)&&(e.forEach((e=>{e.classInfo.forEach((s=>{Y.value&&Y.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;return n<Number(o.degree1)?void i("0"):n<Number(o.degree2)?void i("1"):n<Number(o.degree3)?void i("2"):void i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((s=>{Y.value&&Y.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})))},De=()=>{m.value=d,v.value=new Date,Ie()},Me=e=>{L.value=e};return(e,t)=>{const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[B.value?((0,s.uX)(),(0,s.CE)("div",ep,lp)):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[(0,s.Lk)("h3",sp,[(0,s.eW)(" Classification List "),(0,s.Lk)("button",{onClick:ce,class:"classificationListBtn"},[(0,s.bF)(c,{icon:["fas","list-check"]})])]),(0,s.Lk)("div",op,[(0,s.Lk)("div",np,[(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),class:"searchSelect"},up,512),[[l.u1,g.value]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),class:"searchInputBox",onKeydown:(0,l.jR)(ne,["enter"]),ref_key:"barcodeInput",ref:O,onInput:se},null,544),[[l.Jo,p.value]]),(0,s.Lk)("button",{class:"searchClass",onClick:De},[(0,s.bF)(c,{icon:["fas","calendar-days"]}),(0,s.eW)(" Refresh ")]),(0,s.Lk)("div",dp,[(0,s.bF)((0,o.R1)(so.A),{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e)},null,8,["modelValue"]),(0,s.bF)((0,o.R1)(so.A),{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=e=>v.value=e)},null,8,["modelValue"])]),(0,s.Lk)("button",{type:"button",class:"searchClass",onClick:Ie},"Search"),"main"===P.value?((0,s.uX)(),(0,s.CE)("div",mp,[(0,s.bF)(c,{icon:["fas","file-csv"],onClick:ke})])):(0,s.Q3)("",!0)]),N.value?((0,s.uX)(),(0,s.CE)("div",vp,[_.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",pp,[gp,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>h.value=e)},null,512),[[l.Jo,h.value]])])),(0,s.Lk)("div",fp,[Ip,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e)},hp,512),[[l.u1,k.value]])]),(0,s.Lk)("div",Sp,[(0,s.Lk)("span",null,(0,n.v_)(_.value?"BM":"WBC")+" Info Filter",1),(0,s.Lk)("ul",kp,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(b.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:"checkbox_"+t,"onUpdate:modelValue":t=>e.checked=t,onChange:de},null,40,Np),[[l.lH,e.checked]]),(0,s.Lk)("label",{for:"checkbox_"+t},(0,n.v_)(e.title),9,_p)])))),128))])]),(0,s.Lk)("div",Ep,[wp,(0,s.Lk)("div",null,[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"00",onChange:t[6]||(t[6]=e=>ue("00")),checked:"00"===S.value},null,40,Rp),Lp]),_.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"01",onChange:t[7]||(t[7]=e=>ue("01")),checked:"01"===S.value},null,40,Tp),Pp]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"04",onChange:t[8]||(t[8]=e=>ue("04")),checked:"04"===S.value},null,40,Ap),Dp])],64)),_.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"02",onChange:t[9]||(t[9]=e=>ue("02")),checked:"02"===S.value},null,40,Mp),xp]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"04",onChange:t[10]||(t[10]=e=>ue("04")),checked:"04"===S.value},null,40,Kp),Op]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"06",onChange:t[11]||(t[11]=e=>ue("06")),checked:"06"===S.value},null,40,Bp),Fp])],64)):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0)]),((0,s.uX)(),(0,s.Wv)(s.PR,null,[(0,s.bF)(mv,{loadingDelayParents:M.value,dbData:a.value,onLoadMoreData:be,onLoadPrevData:Ce,onInitData:me,onSelectItem:ve,onRefresh:ye,onCheckListItem:Me,selectedItemIdFalse:x.value,notStartLoading:K.value},null,8,["loadingDelayParents","dbData","selectedItemIdFalse","notStartLoading"])],1024))]),(0,s.Lk)("div",Up,[(0,s.bF)(xv,{dbData:a.value,selectedItem:y.value},null,8,["dbData","selectedItem"]),_.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(Xv,{key:0,dbData:a.value,selectedItem:y.value},null,8,["dbData","selectedItem"])),_.value?((0,s.uX)(),(0,s.Wv)(Jv,{key:1,dbData:a.value,selectedItem:y.value},null,8,["dbData","selectedItem"])):(0,s.Q3)("",!0)])]),i.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":i.value,message:r.value,onHide:Se,"onUpdate:hideAlert":Se},null,8,["is-visible","message"])):(0,s.Q3)("",!0)],64)}}});const Xp=Wp;var Gp=Xp;const Hp={class:"createdRbc"},Vp={class:"mt1 flexSpaceBetween"},jp=(0,s.Lk)("h3",{class:"wbcClassInfoLeft"},"RBC Classification",-1),Yp={class:"leftWbcInfo rbcClass"},qp={style:{position:"relative"}},Qp={key:0,class:"memoModal"},Jp={class:"categoryNm"},zp=["onClick"],Zp={class:"classNmRbc"},eg=["onClick"],tg={key:0},ag=["value"],lg={key:0},sg={class:"degree analysis"},og={key:4},ng={class:"rbcPercent"},ig={key:1},rg={key:4},cg={class:"rbcPercent mr1"},ug={key:4},dg={class:"categories rbcClass"},mg={class:"categoryNm"},vg={class:"classNmRbc"},pg={key:0},gg={class:"degree analysis"},fg=(0,s.Lk)("ul",{class:"rbcPercent"},null,-1),Ig=(0,s.Lk)("ul",{class:"rbcPercent"},null,-1);var yg=(0,s.pM)({__name:"rbcClass",props:["rbcInfo","selectItems","type","allCheckClear","isCommitChanged","notCanvasClickVal","currentRbcPageNumber"],setup(e,{emit:t}){const a=e=>e?.categoryNm,i=(0,o.KR)([]),u=e,d=(0,o.KR)([]),m=(0,o.KR)([]),v=(0,o.KR)(0),p=(0,o.KR)(0),g=(0,o.KR)(""),f=(0,o.KR)(50),I=(0,o.KR)(!1),y=(0,c.Pj)(),b=(0,o.KR)(!1),C=(0,o.KR)(""),h=(0,o.KR)(""),S=(0,o.KR)(!1),k=(0,o.KR)(""),N=(0,o.KR)(""),_=(0,s.EW)((()=>y.state.userModule)),E=(0,o.KR)(!1),w=(0,o.KR)([]),R=t,L=(0,o.KR)(""),T=(0,r.rd)(),P=(0,o.KR)(!1),A=(0,o.KR)([]),D=(0,o.KR)("Macrocyte"),M=(0,o.KR)(!0),x=(0,o.KR)([]),K=(0,o.KR)(0),O=(0,s.EW)((()=>y.state.commonModule.iaRootPath)),B=(0,o.KR)(!1),F=(0,s.EW)((()=>y.state.commonModule.rbcReData)),U=(0,s.EW)((()=>y.state.commonModule.resetRbcArr)),$=(0,s.EW)((()=>y.state.commonModule.selectedSampleId)),W=(0,o.KR)([]),X=(0,o.KR)(0),H=(0,o.KR)(0),j=(0,o.KR)(0),Y=(0,o.KR)(0),q=(0,o.KR)(0),Q=(0,s.EW)((()=>y.state.commonModule.rbcReDataCheck)),J=(0,o.KR)(null);let Z;const ee=(0,o.KR)(""),te=(0,o.KR)(window.PROJECT_TYPE),ae=(0,o.KR)(0),le=(0,o.KR)(0),se=(0,o.KR)([]),oe=(0,o.KR)(0);(0,s.sV)((async()=>{oe.value=0;const{path:e}=T.currentRoute.value;g.value=u.selectItems?.rbcMemo,v.value=u.selectItems?.rbcInfo.pltCount,p.value=u.selectItems?.rbcInfo.malariaCount,g.value=u.selectItems?.rbcMemo,L.value=u.selectItems?.rbcInfo.maxRbcCount,ee.value=u.selectItems?.submitState,P.value="/report"===e,A.value=[],ne()})),(0,s.wB)((()=>u.isCommitChanged),(()=>{ee.value="Submit"})),(0,s.wB)((()=>u.allCheckClear),(e=>{i.value=[],w.value=[]}),{deep:!0}),(0,s.wB)((()=>u.currentRbcPageNumber),(async e=>{oe.value=e,await de(e)})),(0,s.wB)((()=>u.selectItems),(async e=>{v.value=u.selectItems?.pltCount,p.value=u.selectItems?.malariaCount,g.value=u.selectItems?.rbcMemo,ee.value=u.selectItems?.submitState,await ye(e),ne(),M.value=!0}));const ne=()=>{if(A.value=[],!u.selectItems?.rbcInfo)return;const e=u.selectItems?.rbcInfo.rbcClass||u.selectItems?.rbcInfo;if(e)for(const t of e)t.classInfo.forEach((e=>{"Normal"!==e.classNm&&A.value.push({...e,categoryId:t.categoryId})}));A.value.push({categoryId:"04",classId:"01",classNm:"Platelet"},{categoryId:"05",classId:"03",classNm:"Malaria"})};(0,s.wB)((()=>u.rbcInfo),(async e=>{await ye(e),await de(oe.value),await be(),await xe(),await Ke(m.value),Ie(m.value,d.value)&&await Ke(d.value)})),(0,s.wB)((()=>U),(async e=>{e&&(await y.dispatch("commonModule/setCommonInfo",{resetRbcArr:!1}),await de(oe.value),await be())}),{deep:!0}),(0,s.wB)((()=>u.allCheckClear),(e=>{i.value=[],w.value=[],M.value=!0}),{deep:!0}),(0,s.wB)((()=>F),(async e=>{e&&(clearTimeout(Z),Z=setTimeout((async()=>{B.value=!1,await de(oe.value),await be(),await xe(),await Ke(m.value),Ie(m.value,d.value)&&await Ke(d.value)}),1e3))}),{deep:!0});const ie=(e,t,a,l,s,o)=>{const n=i.value.includes(o);n?i.value=i.value.filter((e=>e!==o)):i.value.push(o),Se(l.classNm,!n,s.categoryId,l.classId),fe(l.classNm,"Others",s.categoryId,l.classId)};function ce(e,t,a,l,s){ue(e,t,a,l,s),fe(l.classNm,s.categoryNm,s.categoryId,l.classId)}function ue(e,t,a,l,s){const o=`${e}-${t}-${a}`,n=i.value.includes(o);n?i.value=i.value.filter((e=>e!==o)):i.value.push(o),Se(l.classNm,!n,s.categoryId,l.classId)}const de=async e=>{const t=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:O.value,a=`${t}/${u.selectItems.slotId}/03_RBC_Classification/${u.selectItems.slotId}_new.json`,l=await Wc({fullPath:a}),s=`${t}/${u.selectItems.slotId}/03_RBC_Classification/${u.selectItems.slotId}.json`;if(se.value=await Wc({fullPath:s}),"not file"!==l.data){const t=l?.data;console.log("rbcResponseOldArr.value",se.value);for(const a of se.value.data[e].rbcClassList)for(const e of t){const t=a.classInfo.findIndex((t=>t.index===e.index));if(-1!==t&&a.classInfo.splice(t,1),a.categoryId===e.categoryId){let t={classNm:e.classNm,classId:e.classId,posX:String(e.posX),posY:String(e.posY),width:e.width,height:e.height,index:e.index};a.classInfo.push(t)}}x.value=se.value?.data[e].rbcClassList}else x.value=se.value?.data[e].rbcClassList;if(!x.value||!Array.isArray(x.value))return;let o=0,n=0,i=0,r=0;ae.value=0,le.value=0,x.value.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?ae.value+=1:"DoubleNormal"===t.classNm&&(le.value+=1);switch(e.categoryId){case"01":o=e.classInfo.length;break;case"02":n=e.classInfo.length;break;case"03":i=e.classInfo.length;break;case"05":r=e.classInfo.length;break;default:break}})),K.value=Number(o),X.value=Number(o),H.value=n,j.value=Number(r),Y.value=Number(i),q.value=Number(i)+Number(r)},me=e=>{const t=(Number(e)/Number(K.value)*100).toFixed(1);return isNaN(t)?"-":Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t},ve=async()=>{const e=JSON.parse(JSON.stringify(d.value));if(!Array.isArray(e))return;const t=e.find((e=>e.categoryNm===D.value));if(t)f.value=t.sensitivity||50;else{for(const t of e){const e=t.classInfo.find((e=>e.classNm===D.value));if(e)return void(f.value=e.sensitivity||50)}f.value=50}},pe=()=>{null!==J.value&&clearTimeout(J.value)};(0,s.wB)(Q,(e=>{pe(),null!==J.value&&clearInterval(J.value),J.value=window.setInterval((()=>{e&&ge()}),800)}),{deep:!0});const ge=async()=>{B.value=!0,await Ce(D.value),await y.dispatch("commonModule/setCommonInfo",{rbcReData:!1});const e={jobCmd:"RBC_RE_CLASSIFICATION",sensitivity:Number(f.value),reqDttm:z().embedStatus.settings.reqDttm,reqUserId:_.value.userId||"",className:D.value.replace(/\s/g,""),slotId:u.selectItems?.slotId,anyWay:"true"};Je.publish("childEmitSocketData",e)},fe=(e,t,a,l)=>{if("Normal"===e)return;const s=JSON.parse(JSON.stringify(d.value));for(const o of s)for(const t of o?.classInfo)t.classNm===e&&t.classId===l&&(f.value=t.sensitivity||50);D.value=e},Ie=(e,t)=>{for(let a=0;a<e.length;a++){const l=e[a],s=t[a];for(let e=0;e<l.classInfo.length;e++){const t=l.classInfo[e],a=s.classInfo[e];if(String(t.degree)!==String(a.degree))return!1}}return!0},ye=async e=>{if(""===u.selectItems?.submitState||!u.selectItems?.submitState){const e=await vu(String(u.selectItems?.id)),t={submitState:"checkFirst"},a={...e.data,...t};await Re(a,!1)}E.value=!1,R("isBeforeUpdate",!1);let t={};if(t=e||u.selectItems,m.value=t.rbcInfo?.rbcClass?t.rbcInfo.rbcClass:t,d.value=u.selectItems?.rbcInfoAfter?u.selectItems.rbcInfoAfter:m.value,"report"===u.type){const e=await vu(String($.value));d.value=e.data.rbcInfoAfter,await y.dispatch("commonModule/setCommonInfo",{rbcInfoAfterData:e.data.rbcInfoAfter})}await ve()},be=async()=>{if(!m.value||!Array.isArray(m.value))return;if(!x.value||!Array.isArray(x.value))return;for(const a of m.value)for(const e of a.classInfo){let t=0;for(const l of x.value)for(const s of l.classInfo)s.classNm.replace(/\s+/g,"")===e.classNm.replace(/\s+/g,"")&&l.categoryId===a.categoryId&&t++;e.originalDegree=t}let e=0,t=0;for(const a of x.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;L.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}v.value=Math.floor(e/parseFloat(L.value)*1e3),p.value=t},Ce=async e=>{let t=JSON.parse(JSON.stringify(d.value));for(const o of t)if(o.categoryNm===e)o.sensitivity=f.value;else{const t=o?.classInfo?.findIndex((t=>t.classNm===e));-1!==t&&void 0!==t&&o?.classInfo&&(o.classInfo[t].sensitivity=f.value)}d.value=t;const a=await vu(String($.value)),l={rbcInfoAfter:t},s={...a.data,...l};await Re(s,!1)},he=(e,t)=>{if(u.notCanvasClickVal)return;let a=[];for(const l of m.value)"03"!==l.categoryId&&"04"!==l.categoryId&&"05"!==l.categoryId||l.classInfo.forEach(((e,t)=>{a.push({classNm:e.classNm,categoryId:l.categoryId,classId:e.classId})})),"05"===l.categoryId&&a.push({classNm:"Malaria",categoryId:"05",classId:"03"});a.push({classNm:"Platelet",categoryId:"04",classId:"01"}),i.value=e?["0-2-0","0-2-1","0-2-2","0-2-3","0-2-4","0-2-5","0-2-6","0-2-7","0-2-8","0-2-9","0-2-10","0-3-0","0-3-1","9-9-1","9-9-2"]:[],a.forEach((t=>{Se(t.classNm,e,t.categoryId,t.classId)})),M.value=!M.value},Se=(e,t,a,l)=>{u.notCanvasClickVal||(t?w.value.some((t=>t.classNm===e&&t.classId===l&&t.categoryId===a))||w.value.push({classNm:e,categoryId:a,classId:l}):w.value=w.value.filter((t=>!(t.classNm===e&&t.classId===l&&t.categoryId===a))),R("classInfoArrUpdate",w.value))};(0,s.wB)(F,(async(e,t)=>{e&&ke()}),{deep:!0});const ke=()=>{R("classInfoArrUpdateRe",w.value)},Ne=async(e,t,a,l=!1)=>{if("report"===u.type)return;const s=JSON.parse(JSON.stringify(d.value)).map((s=>(s.categoryNm===e.categoryNm&&(s.classInfo=s.classInfo.map((e=>(e.classNm===t.classNm&&(e.degree=String(l?0===Number(e.degree)?1:0:a)),e)))),s)));d.value=s;const o=await vu(String($.value)),n={rbcInfoAfter:s},i={...o.data,...n};await y.dispatch("commonModule/setCommonInfo",{rbcInfoAfterData:s}),await Re(i,!1,"degree")},_e=()=>{I.value=!I.value},Ee=()=>{I.value=!1},we=async()=>{const e=await vu(String($.value)),t=g.value.replaceAll("\r\n","<br>"),a={rbcMemo:t},l={...e.data,...a};await Re(l,!0),I.value=!1},Re=async(e,t,a)=>{try{const l=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:s,endDate:o,page:n,searchText:i,nrCount:r,testType:c,wbcInfo:u,wbcTotal:d}=JSON.parse(l),m=s+o+n+i+r+c+u+d,v=await uu({userId:Number(_.value.id),runingInfoDtoItems:[e],dayQuery:m});if(v){"degree"===a&&(await de(oe.value),await be(),await xe()),t&&Le("success");const l=e;g.value=l.rbcMemo}else console.error("백엔드가 디비에 저장 실패함")}catch(l){console.error("Error:",l)}},Le=e=>{b.value=!0,C.value="success",h.value=e,window.scrollTo({top:0,behavior:"smooth"})},Te=()=>{b.value=!1},Pe=()=>{"Submit"!==ee.value&&(S.value=!0,N.value=G.IDS_MSG_CONFIRM_SLIDE)},Ae=()=>{Me(),S.value=!1},De=()=>{S.value=!1},Me=async()=>{const e=V()().local(),t=await vu(String($.value)),a={submitState:"Submit",submitOfDate:e.format(),submitUserId:_.value.name},l={...t.data,...a};await Re(l),R("submitStateChanged","Submit")},xe=async()=>{try{const e=await re(),t=e.data;W.value=t}catch(e){console.log(e)}},Ke=async e=>{if("bm"===te.value)return;let t=K.value,a=X.value,l=H.value;Array.isArray(m.value)&&(e.forEach((e=>{e.classInfo.forEach((s=>{W.value&&W.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;return n<Number(o.degree1)?void i("0"):n<Number(o.degree2)?void i("1"):n<Number(o.degree3)?void i("2"):void i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((s=>{W.value&&W.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})))};return(t,o)=>{const r=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",Hp," Creating a new RBC classification ...",512),[[l.aG,B.value]]),(0,s.Lk)("div",null,[(0,s.Lk)("div",Vp,[jp,(0,s.Lk)("ul",Yp,[(0,s.Lk)("li",qp,[(0,s.bF)(r,{icon:["fas","comment-dots"],onClick:_e}),I.value?((0,s.uX)(),(0,s.CE)("div",Qp,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":o[0]||(o[0]=e=>g.value=e)},null,512),[[l.Jo,g.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:we},"OK"),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Ee},"CANCEL")])):(0,s.Q3)("",!0)]),(0,s.Lk)("li",{onClick:Pe,class:(0,n.C4)({submitted:"Submit"===ee.value})},[(0,s.bF)(r,{icon:["fas","square-check"]})],2)])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([m.value],((t,c)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:c},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,u)=>((0,s.uX)(),(0,s.CE)("div",{key:u,class:"categories rbcClass"},[(0,s.Lk)("ul",Jp,[0===u?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"mb1 liTitle",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Category",4)):(0,s.Q3)("",!0),(0,s.Lk)("li",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.Lk)("span",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(a(t)),5),"Shape"===a(t)&&"report"!==e.type?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"degreeAllCheckBtn",onClick:e=>he(M.value,t)},(0,n.v_)(M.value?"All Check":"All Uncheck"),9,zp)):(0,s.Q3)("",!0)],4)]),(0,s.Lk)("ul",Zp,[0===u?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"mb1 liTitle",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Class",4)):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((a,r)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${c}-${u}-${r}`},[(0,s.Lk)("li",{onClick:e=>ce(c,u,r,a,t),style:(0,n.Tr)("report"===e.type&&"cursor: default;")},["Shape"!==t?.categoryNm&&"Inclusion Body"!==t.categoryNm||"report"===e.type||"Poikilocyte"===a?.classNm?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",tg,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:`${c}-${u}-${r}`,"onUpdate:modelValue":o[1]||(o[1]=e=>i.value=e)},null,8,ag),[[l.aG,!P.value],[l.lH,i.value]])])),(0,s.Lk)("span",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)("TearDropCell"===a?.classNm?"TearDrop Cell":a?.classNm),5)],12,eg),r===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",{key:0,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.Lk)("span",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Others",4)],4)):(0,s.Q3)("",!0),r===t.classInfo.length-1&&"05"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",{key:1,onClick:o[4]||(o[4]=e=>ie(0,0,2,{classNm:"Malaria",classId:"03"},{categoryId:"05"},"9-9-2")),style:(0,n.Tr)("report"===e.type&&"cursor: default;")},["report"!==e.type?((0,s.uX)(),(0,s.CE)("div",lg,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:"9-9-2","onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e),onChange:o[3]||(o[3]=e=>Se("Malaria",e.target.checked,"05","03"))},null,544),[[l.aG,!P.value],[l.lH,i.value]])])):(0,s.Q3)("",!0),(0,s.Lk)("span",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Malaria",4)],4)):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",sg,[0===u?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"mb1 liTitle",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Degree",4)):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((a,o)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${c}-${u}-${o}`},["01"!==a.classId||"05"===t.categoryId||"01"!==d.value[u].classInfo[o].classId||"05"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("li",{key:0,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},["01"!==a.classId||"05"===t.categoryId?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"rbcSapn",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(e=>(0,s.bF)(r,{icon:["fac","half-circle-up"],key:e,class:(0,n.C4)({degreeActive:e<Number(a?.degree)+2||0,"degree0-img":e>=Number(a?.degree)+1||0}),onClick:t=>Ne(d.value[u],d.value[u].classInfo[o],e-1,!1)},null,8,["class","onClick"]))),64))],4)):(0,s.Q3)("",!0),"01"!==d.value[u].classInfo[o].classId||"05"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("span",{key:1,class:"rbcSapnDown",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(e=>(0,s.bF)(r,{icon:["fac","half-circle-down"],key:e+"-down",class:(0,n.C4)({degreeActive:e<Number(d.value[u].classInfo[o]?.degree)+2||0,"degree0-img":e>=Number(d.value[u].classInfo[o]?.degree)+1||0}),onClick:t=>Ne(d.value[u],d.value[u].classInfo[o],e-1,!1)},null,8,["class","onClick"]))),64))],4)):(0,s.Q3)("",!0)],4)):((0,s.uX)(),(0,s.CE)("li",{key:1,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},["0"===a.degree?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"rbcSapn",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.bF)(r,{icon:["fac","half-circle-up"]})],4)):((0,s.uX)(),(0,s.CE)("span",{key:1,class:"rbcSapn",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.bF)(r,{icon:["fac","half-circle-up"],class:"degreeActive"})],4)),"0"===d.value[u].classInfo[o]?.degree?((0,s.uX)(),(0,s.CE)("span",{key:2,class:"rbcSapnDown",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.bF)(r,{onClick:e=>Ne(d.value[u],d.value[u].classInfo[o],"0",!0),icon:["fac","half-circle-down"]},null,8,["onClick"])],4)):((0,s.uX)(),(0,s.CE)("span",{key:3,class:"rbcSapnDown",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},[(0,s.bF)(r,{onClick:e=>Ne(d.value[u],d.value[u].classInfo[o],"1",!0),icon:["fac","half-circle-down"],class:"degreeActive"},null,8,["onClick"])],4))],4)),o===t.classInfo.length-1&&"03"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("li",{key:2,style:(0,n.Tr)("report"===e.type&&"cursor: default;")}," - ",4)):(0,s.Q3)("",!0),o===t.classInfo.length-1&&"05"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("li",{key:3,style:(0,n.Tr)("report"===e.type&&"cursor: default;")}," - ",4)):(0,s.Q3)("",!0),o===t.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",og,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02","05"],(e=>(0,s.bo)((0,s.Lk)("div",{key:e,class:"underline"}," Total "),[[l.aG,d.value[u].categoryId===e]]))),64))])):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",ng,[0===u?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"mb1 liTitle",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"count",4)):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((a,o)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${c}-${u}-${o}`},["Poikilocyte"!==a?.classNm?((0,s.uX)(),(0,s.CE)("li",{key:0,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(Number(a?.originalDegree)||0),5)):((0,s.uX)(),(0,s.CE)("li",ig,"-")),o===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",{key:2,class:"defaultText",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(Number(ae.value+le.value)||0),5)):(0,s.Q3)("",!0),o===t.classInfo.length-1&&"05"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",{key:3,class:"defaultText",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(Number(p.value)||0),5)):(0,s.Q3)("",!0),o===t.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",rg,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02"],(t=>(0,s.bo)((0,s.Lk)("div",{key:t,class:"underline",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(Number(X.value)||0),5),[[l.aG,d.value[u].categoryId===t]]))),64))])):(0,s.Q3)("",!0),o===t.classInfo.length-1&&"05"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("div",{key:5,class:"underline",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(Number(q.value)||0),5)):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",cg,[0===u?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"mb1 liTitle",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"percent",4)):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((a,o)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${c}-${u}-${o}`},["Poikilocyte"!==a?.classNm?((0,s.uX)(),(0,s.CE)("li",{key:0,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(me(Number(a?.originalDegree))||0),5)):((0,s.uX)(),(0,s.CE)("li",{key:1,style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"-",4)),o===t.classInfo.length-1&&"03"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("li",{key:2,class:"defaultText",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(me(ae.value+le.value)||0),5)):(0,s.Q3)("",!0),o===t.classInfo.length-1&&"05"===d.value[u].categoryId?((0,s.uX)(),(0,s.CE)("li",{key:3,class:"defaultText",style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(me(p.value)||0),5)):(0,s.Q3)("",!0),o===t.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",ug,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02","05"],(t=>(0,s.bo)((0,s.Lk)("div",{key:t,class:"underline",style:(0,n.Tr)("report"===e.type&&"cursor: default;")}," 100% ",4),[[l.aG,d.value[u].categoryId===t]]))),64))])):(0,s.Q3)("",!0)],64)))),128))])])))),128))],64)))),128)),(0,s.Lk)("div",null,[(0,s.Lk)("div",dg,[(0,s.Lk)("ul",mg,[(0,s.Lk)("li",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Others",4)]),(0,s.Lk)("ul",vg,[(0,s.Lk)("li",{onClick:o[7]||(o[7]=e=>ie(0,0,1,{classNm:"Platelet",classId:"01"},{categoryId:"04"},"9-9-1")),style:{"padding-top":"0"}},["report"!==e.type?((0,s.uX)(),(0,s.CE)("div",pg,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:"9-9-1","onUpdate:modelValue":o[5]||(o[5]=e=>i.value=e),onChange:o[6]||(o[6]=e=>Se("Platelet",e.target.checked,"04","01"))},null,544),[[l.aG,!P.value],[l.lH,i.value]])])):(0,s.Q3)("",!0),(0,s.Lk)("span",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},"Platelet",4)])]),(0,s.Lk)("ul",gg,[(0,s.Lk)("li",{style:(0,n.Tr)("report"===e.type&&"cursor: default;")},(0,n.v_)(v.value||0)+" PLT / 1000 RBC",5)]),fg,Ig])])]),b.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":b.value,type:C.value,message:h.value,onHide:Te,"onUpdate:hideAlert":Te},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),S.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:1,"is-visible":S.value,type:k.value,message:N.value,onHide:De,onOkConfirm:Ae},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const bg=yg;var Cg=bg,hg=a(4791),Sg=a.n(hg);const kg=[{id:"none",text:"None"},{id:"line",text:"Line"},{id:"cross",text:"Cross"},{id:"circle",text:"Circle"}],Ng=ee(),_g=async e=>Ng.httpGet(te.images.move,e,!0),Eg=async e=>Ng.httpPost(te.images.moveClassImage,e,"",!1,window.VIEWER_CHECK),wg={key:0},Rg=(0,s.Lk)("h1",{class:"malariaTitle"},"Malaria O",-1),Lg=["src","onClick","onDragstart","onDblclick"],Tg=(0,s.Lk)("h1",{class:"malariaTitle"},"Malaria X",-1),Pg=["src","onClick","onDragstart","onDblclick"],Ag={key:1},Dg=(0,s.Lk)("span",null,"Malaria Images do not exist.",-1),Mg=[Dg],xg={class:"wbcModal"},Kg={class:"wbcModalImageContent"},Og=["src"];var Bg=(0,s.pM)({__name:"Malaria",props:["selectItems"],setup(e){const t=e,a=sessionStorage.getItem("iaRootPath")||Rt.iaRootPath,i=window.APP_API_BASE_URL||"http://192.168.0.115:3002",r=(0,o.KR)([]),c=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)("");let m=(0,o.KR)(null),v=(0,o.KR)([]);const p=(0,o.KR)(!1),g=(0,o.KR)(!1),f=(0,o.KR)("150px"),I=(0,o.KR)("150px");async function y(e,l){const s=t.selectItems.slotId||"",o=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:a,n=`${o}/${s}/${Rt.rbcClassDirName}/${e}`;try{const e=await fetch(`${i}/folders?folderPath=${n}`);if(!e.ok)throw p.value=!1,new Error("Network response was not ok");{const t=await e.json();l.value=t.map((e=>`${i}/folders?folderPath=${n}/${e}`)),p.value=!0}}catch(r){console.error(r)}}(0,s.sV)((async()=>{await y(Rt.malariaDirName,r),await y(Rt.noMalariaDirName,c),document.body.addEventListener("click",N)}));const b=e=>{e.target.classList.contains("wbc-modal-content")&&(g.value=!1)},C=()=>{g.value=!1},h=(e,t,a)=>{"malaria"===e&&(d.value=t,g.value=!0)},S=()=>{let e=Math.min(parseFloat(f.value)+50,400),t=Math.min(parseFloat(I.value)+50,400);f.value=`${e}px`,I.value=`${t}px`},k=()=>{let e=Math.max(parseFloat(f.value)-50,150),t=Math.max(parseFloat(I.value)-50,150);f.value=`${e}px`,I.value=`${t}px`};function N(e){const t=e.target;t.closest(".item-image")||(u.value=[])}function _(e,t,a,l){const s={section:e,imgName:t,index:a};if(u.value.length>0&&u.value[u.value.length-1].section!==e)u.value=[s];else if(l.shiftKey&&null!==m.value){const t=Math.min(m.value,a),l=Math.max(m.value,a);for(let a=t;a<=l;a++){const t=u.value.findIndex((e=>e.index===a));-1===t&&u.value.push({section:e,imgName:"malaria"===e?r.value[a]:c.value[a],index:a})}}else if(l.ctrlKey&&null!==m.value)u.value.push(s);else{const e=u.value.findIndex((e=>e.imgName===t));-1!==e?u.value.splice(e,1):u.value=[s]}m.value=a}function E(e,t){return u.value.some((e=>e.imgName===t))}function w(e,t,a){u.value.length>0?v.value=u.value:v.value=[{section:e,imgName:t,index:a}]}function R(e){for(const t of v.value)e!==t.section&&L(e,t.imgName)}async function L(e,l){const s=t.selectItems.slotId||"",o=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:a,n=`${o}/${s}/${Rt.rbcClassDirName}`,i="malaria"===e?`${n}/${Rt.noMalariaDirName}`:`${n}/${Rt.malariaDirName}`,d="malaria"===e?`${n}/${Rt.malariaDirName}`:`${n}/${Rt.noMalariaDirName}`,m=l.split("/"),v=m[m.length-1],p=await _g(`sourceFolder=${i}&destinationFolder=${d}&imageName=${v}`);if(p){const t="malaria"===e?c.value.findIndex((e=>e===l)):r.value.findIndex((e=>e===l));"malaria"===e?(c.value.splice(t,1),r.value.push(l)):(r.value.splice(t,1),c.value.push(l))}u.value=[]}return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[p.value?((0,s.uX)(),(0,s.CE)("div",wg,[(0,s.Lk)("div",null,[Rg,(0,s.Lk)("div",{class:"malariaWrapper",onDrop:t[0]||(t[0]=e=>R("malaria")),onDragover:t[1]||(t[1]=(0,l.D$)((()=>{}),["prevent"]))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{key:"malaria-"+t,src:e,class:(0,n.C4)(["item-image",{selected:E("malaria",e)}]),alt:"malaria-image",onClick:a=>_("malaria",e,t,a),onDragstart:a=>w("malaria",e,t),onDblclick:a=>h("malaria",e,t)},null,42,Lg)))),128))],32)]),(0,s.Lk)("div",null,[Tg,(0,s.Lk)("div",{class:"malariaWrapper",onDrop:t[2]||(t[2]=e=>R("noMalaria")),onDragover:t[3]||(t[3]=(0,l.D$)((()=>{}),["prevent"]))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.value,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{key:"noMalaria-"+t,src:e,class:(0,n.C4)(["item-image",{selected:E("noMalaria",e)}]),alt:"noMalaria-image",onClick:a=>_("noMalaria",e,t,a),onDragstart:a=>w("noMalaria",e,t),onDblclick:a=>h("malaria",e,t)},null,42,Pg)))),128))],32)])])):((0,s.uX)(),(0,s.CE)("div",Ag,Mg)),(0,s.bo)((0,s.Lk)("div",xg,[(0,s.Lk)("div",{class:"wbc-modal-content",onClick:b},[(0,s.Lk)("span",{class:"wbcClose",onClick:C},"×"),(0,s.Lk)("div",Kg,[(0,s.Lk)("img",{src:d.value,style:(0,n.Tr)({width:f.value,height:I.value}),class:"modal-image"},null,12,Og)]),(0,s.Lk)("div",{class:"buttons"},[(0,s.Lk)("button",{onClick:S},"+"),(0,s.Lk)("button",{onClick:k},"-")])])],512),[[l.aG,g.value]])],64))}});const Fg=Bg;var Ug=Fg;const $g={class:"rbc-container imgList"},Wg={class:"btn-container_img_list"},Xg={class:"btn-imgsetbox_img_list",ref:"imgSetWrap"},Gg={class:"imgSet_img_list"},Hg={class:"alignItemsCenter"},Vg=(0,s.Lk)("label",null,"R",-1),jg={class:"alignItemsCenter"},Yg=(0,s.Lk)("label",null,"G",-1),qg={class:"alignItemsCenter"},Qg=(0,s.Lk)("label",null,"B",-1),Jg=(0,s.Lk)("span",null,"Grid",-1),zg=(0,s.Lk)("span",null,"Ruler",-1),Zg={class:"ruler_box_img_list"},ef=["onClick"],tf=(0,s.Lk)("span",null,"Zoom",-1),af={class:"tiling-viewer_img_list-box_img_list"},lf={key:2},sf=(0,s.Lk)("span",null,"Tile does not exist.",-1),of=[sf],nf={class:"categoryNm"},rf={class:"classNmRbc"},cf=["onClick"],uf=(0,s.Lk)("span",null,"Malaria",-1),df=[uf],mf={class:"categories"},vf=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",null,"Others")],-1),pf={class:"classNmRbc"},gf=(0,s.Lk)("span",null,"Platelets",-1),ff=[gf];var If=(0,s.pM)({__name:"rbcImageList",props:["rbcInfo","selectItems","type","classInfoArr","isBefore"],setup(e,{emit:t}){const a=(0,o.KR)(!1),i=(0,o.KR)(""),r=(0,o.KR)(""),u=e,d=(0,o.KR)("lowMag");let m=(0,o.KR)(null);const v=(0,o.KR)(!1),p=(0,o.KR)(100),g=(0,o.KR)([0,0,0]),f=(0,o.KR)(!1),I=(0,o.KR)(!1),y=((0,o.KR)(null),(0,o.KR)("None")),b=(0,o.KR)(!1),C=(0,o.KR)({prevPosX:0,prevPosY:0,posX:0,posY:0,left:0,top:0,width:50,height:50}),h=(0,o.KR)(5),S=(0,o.KR)(0),k=(0,o.KR)(150),N=(0,o.KR)(null),_=(0,o.KR)(!0),E=(0,o.KR)([]),w=(0,c.Pj)(),R=(0,s.EW)((()=>w.state.commonModule.viewerCheck)),L="viewer"===R.value?window.MAIN_API_IP:window.APP_API_BASE_URL,T=(0,s.EW)((()=>w.state.commonModule.iaRootPath)),P=(0,o.KR)([]),A=(0,o.KR)([]),D=(0,o.KR)(null),M=(0,o.KR)([]),x=(0,o.KR)([]),K=(0,o.KR)(0),O=(0,o.KR)(0),B=t,F=(0,o.KR)([]),U=(0,s.EW)((()=>w.state.commonModule.rbcReData)),$=(0,s.EW)((()=>w.state.commonModule.classInfoArr)),W=(0,o.KR)("0"),X=(0,o.KR)("0"),G=(0,o.KR)([]),H=((0,o.KR)(!1),(0,o.KR)(0));(0,s.sV)((async()=>{H.value=0,await(0,s.dY)(),await se(),document.addEventListener("click",J),F.value=u.selectItems.rbcInfo.rbcClass?u.selectItems.rbcInfo.rbcClass:u.selectItems.rbcInfo}));const V=async e=>{const t=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,a=`${t}/${u.selectItems.slotId}/02_RBC_Image/${e}.dzi`,l=await Xc({filePath:a});return await j(`${e}`,l)},j=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}},Y=async(e,t,a)=>{const l=document.getElementsByClassName("overlayElement");if(0===l.length)return void Z("Nothing has been selected");let s=P.value.find((t=>t.categoryId===e));s||(s={categoryId:e,classInfo:[]},P.value.push(s));let o=[];for(const n of x.value)for(const l of P.value){if(n.categoryId===l.categoryId){const s=l.classInfo.findIndex((e=>String(e.index)===n.index));-1!==s&&(o.push({categoryId:e,classNm:a,classId:t,posX:n.posX,posY:n.posY,width:n.width,height:n.height,index:String(n.index)}),l.classInfo.splice(s,1))}l.categoryId===e&&l.classInfo.push({classNm:a,classId:t,posX:n.posX,posY:n.posY,width:n.width,height:n.height,index:String(n.index)})}await q(),await Q(o),await le(A.value)},q=async()=>{const e=document.getElementsByClassName("overlayElement"),t=Array.from(e);t.forEach((e=>{m.value.removeOverlay(e)})),b.value=!1},Q=async e=>{const t=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,a=`${t}/${u.selectItems?.slotId}/03_RBC_Classification/${u.selectItems?.slotId}_new.json`,l=await Wc({fullPath:a});let s=[];if("not file"!==l.data){const a=`${t}/${u.selectItems?.slotId}/03_RBC_Classification/${u.selectItems?.slotId}_new.json`,l=await Wc({fullPath:a});s=[...l.data,...e]}else s=e;const o=JSON.stringify(s),n=(new TextEncoder).encode(o),i=hu.Ay.deflate(n),r=new Blob([i],{type:"application/octet-stream"}),c=new FormData;c.append("file",r,`${u.selectItems?.slotId}_new.json`);const d=`${t}/${u.selectItems?.slotId}/03_RBC_Classification/${u.selectItems?.slotId}_new.json`;try{const e=await fetch(`${L}/jsonReader/upload?filePath=${d}`,{method:"POST",body:c});await e.json()}catch(m){console.error("Error:",m)}},J=e=>{const t=document.querySelector(".rbc-select-box");t&&!t.contains(e.target)&&(b.value=!1)};(0,s.wB)((()=>u.classInfoArr),(e=>{if(E.value=e,0===e.length)return q(),void ae();const t=document.querySelectorAll("ol.overlayElement"),a=new Set(e.map((e=>e.classNm)));t.forEach((e=>{const t=e.getAttribute("data-class-nm");a.has(t)||(console.log("Removing <ol> with data-class-nm:",t),m.value.removeOverlay(e))})),te(e,H.value)}),{deep:!0}),(0,s.wB)($,(async(e,t)=>{if(U.value)return 0===e.length?(q(),void ae()):(await te(e,H.value),await w.dispatch("commonModule/setCommonInfo",{rbcReData:!1}),void await w.dispatch("commonModule/setCommonInfo",{classInfoArr:[]}))}),{deep:!0});const z=e=>{u.isBefore||0===A.value.length||(b.value=!0,e.currentTarget instanceof HTMLElement&&(K.value=e.clientX,O.value=e.clientY-300))},Z=e=>{a.value=!0,i.value="error",r.value=e},ee=()=>{a.value=!1},te=async(e,t)=>{const a=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,l=`${a}/${u.selectItems.slotId}/03_RBC_Classification/${u.selectItems.slotId}_new.json`,s=await Wc({fullPath:l}),o=`${a}/${u.selectItems.slotId}/03_RBC_Classification/${u.selectItems.slotId}.json`,n=await Wc({fullPath:o});if("not file"!==s.data){const e=s?.data;for(const a of n.data[t].rbcClassList)for(const t of e){const e=a.classInfo.findIndex((e=>String(e.index)===String(t.index)));if(-1!==e&&a.classInfo.splice(e,1),a.categoryId===t.categoryId){let e={classNm:t.classNm,classId:t.classId,posX:String(t.posX),posY:String(t.posY),width:t.width,height:t.height,index:String(t.index)};a.classInfo.push(e)}}P.value=n.data[t].rbcClassList}else P.value=n?.data[t].rbcClassList;A.value=e,0===e.length?ae():await le(e)};(0,s.wB)((()=>u.selectItems),(async e=>{await(0,s.dY)();const t=document.getElementById("tiling-viewer_img_list");t&&(t.innerHTML="",m.value&&m.value.destroy(),d.value="lowMag",await se())}));const ae=()=>{const e=D.value;if(!e)return console.error("Canvas element를 찾을 수 없습니다."),null;const t=e.getContext("2d");return t?(t.clearRect(0,0,e.width,e.height),t.beginPath(),M.value=[],t):(console.error("2D context를 가져올 수 없습니다."),null)},le=async e=>{const t={Normal:"red",Poikilocyte:"orange","Target Cell":"navy","Burr Cell":"purple",Acanthocyte:"#1E90FF",Ovalocyte:"#800080",Schistocyte:"magenta","Sickle Cell":"#3CB371",Stomatocyte:"#FFFF00","TearDrop Cell":"#4682B4",Spherocyte:"#FF6347","Howell-Jolly Body":"#FF4500","Basophilic Stippling":"#DDA0DD",Malaria:"black",Platelet:"#C71585"},a=ae();a?(e.forEach((e=>{P.value.forEach((l=>{l.classInfo.forEach((s=>{if(s.classNm.replace(/\s/g,"")===e.classNm.replace(/\s/g,"")&&l.categoryId===e.categoryId){a.lineWidth=3,a.strokeStyle=`${t[e.classNm]||"black"}`;let l,o,n,i,r=new Path2D;s?.width?(l=s.width,o=s.height,n=s.posX,i=s.posY):(l=Number(s.x2)-Number(s.x1),o=Number(s.y2)-Number(s.y1),n=Number(s.x1),i=Number(s.y1));let c={categoryId:e.categoryId,classNm:e.classNm,classId:e.classId,posX:n,posY:i,width:l,height:o,index:String(s.index)};r.rect(n,i,l,o),M.value.push(c),a.stroke(r)}}))}))})),await w.dispatch("commonModule/setCommonInfo",{resetRbcArr:!0})):console.error("Canvas context 초기화 실패")},se=async()=>{if(void 0===u.selectItems.slotId)return;const e=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value;try{const t=`${e}/${u.selectItems.slotId}/${Rt.rbcImageDirName}`,a=await oe(t);if(0!==a.length){m.value=Sg()({id:"tiling-viewer_img_list",animationTime:.4,navigatorSizeRatio:.25,showNavigator:!0,sequenceMode:!0,defaultZoomLevel:1,prefixUrl:`${L}/folders?folderPath=D:/UIMD_Data/Res/uimdFe/images/`,tileSources:a,showReferenceStrip:!1,gestureSettingsMouse:{clickToZoom:!1},maxZoomLevel:15,minZoomLevel:1,zoomPerClick:1.2,zoomPerScroll:1.2,viewportMargins:{top:0,left:0,bottom:0,right:0},visibilityRatio:1}),new(Sg().MouseTracker)({element:m.value.element,moveHandler:function(e){const t=document.getElementById("magCanvas");if(t&&m.value.element.removeChild(t),!I.value)return;const{canvas:a}=m.value.drawer,l=document.createElement("canvas"),s=l.getContext("2d");if(D.value=l,s){const t=200,o=200,n=5;l.id="magCanvas",l.width=t,l.height=o,l.style.position="absolute",l.style.left=e.position.x-t/2+"px",l.style.top=e.position.y-o/2+"px",l.style.border="1px solid",l.style.borderRadius="50%",l.style.width=`${t}px`,l.style.height=`${o}px`,l.style.zIndex="0",m.value.element.appendChild(l),s.drawImage(a,e.position.x-t/2/n,e.position.y-o/2/n,t/n,o/n,0,0,t,o),l.style.visibility=e.position.y<=0||e.position.x<=0?"hidden":"visible"}}});const e=document.createElement("canvas");m.value.addOverlay({element:e,location:new(Sg().Rect)(0,0,1,1)});e.id="myCanvas",D.value=e,m.value.addHandler("open",(function(t){e.width=t.source.Image.Size.Width,e.height=t.source.Image.Size.Height})),m.value.addHandler("page",(function(t){const a=!G.value[t.page].includes("RBC_Image");a||(H.value=t.page,B("changeCurrentRbcImagePageNumber",t.page)),B("notCanvasClick",a),e.parentElement!==m.value.container&&m.value.addOverlay({element:e,location:new(Sg().Rect)(0,0,1,1)}),B("unChecked")})),m.value.addHandler("zoom",(()=>{"None"!==y.value&&ye(y.value)})),m.value.addHandler("canvas-click",(async e=>{if(e.originalEvent.ctrlKey||await q(),e.originalEvent.shiftKey){const t=m.value.viewport.pointFromPixel(e.position),a={x:t.x*m.value.source.width,y:t.y*m.value.source.height},l=e=>{const t=e.width,l=e.height;return a.x>=Number(e.posX)&&a.x<=Number(e.posX)+t&&a.y>=Number(e.posY)&&a.y<=Number(e.posY)+l};let s="";for(const e of M.value)if("Normal"!==e.classNm&&l(e)){s=e.classNm;break}for(const e of M.value)if("Normal"!==e.classNm&&s===e.classNm){console.log(e.classNm),x.value.push(e);const t=document.createElement("ol");t.className="overlayElement",t.id="overlayElement",t.setAttribute("data-category-id",e.categoryId),t.setAttribute("data-class-nm",e.classNm),t.style.width=`${e.width}px`,t.style.backgroundColor="lightgreen",t.style.height=`${e.height}px`,t.style.position="absolute",t.style.opacity="0.5";const a=parseFloat(e.posX),l=parseFloat(e.posY),s=m.value.viewport.imageToViewportRectangle(a,l,e.width,e.height);m.value.addOverlay({element:t,location:s})}}else{const t=m.value.viewport.pointFromPixel(e.position),a={x:t.x*m.value.source.width,y:t.y*m.value.source.height};for(const l of M.value){const t=l,s=t.width,o=t.height;if(a.x>=Number(t.posX)&&a.x<=Number(t.posX)+s&&a.y>=Number(t.posY)&&a.y<=Number(t.posY)+o){const n=l.categoryId,i="lightgreen";if(e.originalEvent.ctrlKey){const e=document.querySelector(`.overlayElement[data-class-posX="${t.posX}"][data-class-posY="${t.posY}"]`);if(e)return;x.value.push(l);const a=document.createElement("ol");a.className="overlayElement",a.id="overlayElement",a.setAttribute("data-category-id",n),a.setAttribute("data-class-nm",l.classNm),a.setAttribute("data-class-posY",t.posY),a.setAttribute("data-class-posX",t.posX),a.style.width=`${l.width}px`,a.style.backgroundColor=i,a.style.height=`${l.height}px`,a.style.position="absolute",a.style.opacity="0.5";const s=parseFloat(t.posX),o=parseFloat(t.posY),r=m.value.viewport.imageToViewportRectangle(s,o,t.width,t.height);m.value.addOverlay({element:a,location:r})}else if(a.x>=Number(t.posX)&&a.x<=Number(t.posX)+s&&a.y>=Number(t.posY)&&a.y<=Number(t.posY)+o){const e=l.categoryId,a="lightgreen",s=P.value.find((t=>t.categoryId===e))?.classInfo.find((e=>e.index===l.index));if(s){x.value=[l];const s=document.getElementById("overlayElement");s&&m.value.removeOverlay(s);const o=document.querySelector(`.overlayElement[data-category-id="${e}"][data-class-nm="${l.classNm}"]`);if(o){const e=parseFloat(t.posX),a=parseFloat(t.posY),l=m.value.viewport.imageToViewportRectangle(e,a,t.width,t.height);m.value.updateOverlay(o,l)}else{const s=document.createElement("ol");s.className="overlayElement",s.id="overlayElement",s.setAttribute("data-category-id",e),s.setAttribute("data-class-nm",l.classNm),s.style.width=`${l.width}px`,s.style.backgroundColor=a,s.style.height=`${l.height}px`,s.style.position="absolute",s.style.opacity="0.5";const o=parseFloat(t.posX),n=parseFloat(t.posY),i=m.value.viewport.imageToViewportRectangle(Number(o),Number(n),Number(l.width),Number(l.height));m.value.addOverlay({element:s,location:i})}}}break}}}}))}}catch(t){console.error("Error:",t)}},oe=async e=>{const t=`${L}/folders?folderPath=${e}`,a=await fetch(t);if(a.ok){const t=await a.json(),l=[];G.value=[];for(const a of t)if(a.endsWith("_files")){const t=ne(a);G.value.push(t);const{width:s,height:o,tileSize:n}=await V(t);l.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${L}/folders?folderPath=${e}/${a}/`,Format:"jpg",Overlap:"1",TileSize:n,Size:{Width:s,Height:o}}}),X.value=s,W.value=o}return _.value=!0,l}throw _.value=!1,new Error("Network response was not ok")},ne=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e},ie=e=>{switch(e){case"lowMag":d.value="lowMag";break;case"malaria":d.value="malaria",v.value=!1;break}"malaria"!==d.value&&(se(),B("notCanvasClick",!1))},re=()=>{v.value=!v.value},ce=e=>{const t=e?.target?.value,a=g.value[0],l=g.value[1],s=g.value[2],o=document.getElementById("tiling-viewer_img_list");o&&(o.style.filter=`opacity(1) drop-shadow(0 0 0 rgb(${a}, ${l}, ${s})) brightness(${t}%)`)},ue=()=>{const e=g.value[0],t=g.value[1],a=g.value[2],l=p.value,s=document.getElementById("tiling-viewer_img_list");s&&(s.style.filter=`opacity(0.9) drop-shadow(0 0 0 rgb(${e}, ${t}, ${a})) brightness(${l}%)`)},de=()=>{const e=p.value;g.value=[0,0,0];const t=document.getElementById("tiling-viewer_img_list");t&&(t.style.filter=`opacity(1) drop-shadow(0 0 0 rgb(0,0,0)) brightness(${e}%)`)},me=()=>{p.value=100,ue()},ve=()=>{f.value=!f.value,m.value.addHandler("zoom",pe),f.value?pe():fe()},pe=()=>{if(fe(),f.value){const e=m.value.world.getItemAt(0).getContentSize().y,t=m.value.world.getItemAt(0).getContentSize().x,a=m.value.viewport.getZoom(),l=400,s=Math.round(l/a),o=Math.min(t,e)/s;for(let n=1;n<s;n++){const a=n*o;ge(a,0,1,e,"rgba(128, 128, 128, 0.2)"),ge(0,a,t,1,"rgba(128, 128, 128, 0.2)")}}},ge=(e,t,a,l,s)=>{const o=document.createElement("div");o.className="grid-line",o.style.position="absolute",o.style.left=`${e}px`,o.style.top=`${t}px`,o.style.width=`${a}px`,o.style.height=`${l}px`,o.style.background=s,o.style.userSelect="none",o.style.pointerEvents="none",m.value.container.appendChild(o)},fe=()=>{const e=document.querySelectorAll(".grid-line");e.forEach((e=>e.remove()))},Ie=e=>{switch(e.text){case"None":y.value="None";break;case"Line":y.value="Line";break;case"Cross":y.value="Cross";break;case"Circle":y.value="Circle";break}ye(e)},ye=e=>{const t=document.getElementById("tiling-viewer_img_list");if(t instanceof HTMLElement){const a=document.getElementById("rulerOverlay");a instanceof HTMLElement&&t.removeChild(a);const l=document.createElement("div");l.id="rulerOverlay",l.style.position="absolute",l.style.width=C.value.width+"px",l.style.height=C.value.height+"px",l.style.zIndex="9999999";const s=m.value.viewport.getZoom(!0);0===C.value.left?l.style.left=m.value.container.clientWidth/2-C.value.width/2+"px":l.style.left=C.value.left/s+"px",0===C.value.top?l.style.top=m.value.container.clientHeight/2-C.value.height/2+"px":l.style.top=C.value.top/s+"px",be(l,h,e),t.appendChild(l);let o=!1;l.onmousedown=function(e){C.value.prevPosX=e.clientX,C.value.prevPosY=e.clientY,C.value.left<=30&&(C.value.left=31),C.value.top<=80&&(C.value.top=81),o=!0},l.onmouseup=function(){o=!1},l.onwheel=function(t){t.deltaY<0?h.value<20&&be(l,++h.value,e):h.value>5&&be(l,--h.value,e)};const n=document.getElementById("tilingViewer");n instanceof HTMLElement&&(n.onmousemove=function(e){o&&(C.value.left<=30||C.value.top<=80||(C.value.posX=C.value.prevPosX-e.clientX,C.value.posY=C.value.prevPosY-e.clientY,C.value.prevPosX=e.clientX,C.value.prevPosY=e.clientY,l.style.left=l.offsetLeft-C.value.posX+"px",l.style.top=l.offsetTop-C.value.posY+"px",C.value.left=l.offsetLeft,C.value.top=l.offsetTop))})}},be=(e,t,a)=>{"object"===typeof t&&(t=t.value),null!==document.getElementById("rulerTitle")&&e.removeChild(document.getElementById("rulerTitle"));let l=1;t>5&&(l+=.06*(t-5));let s=m.value.viewport.viewportToImageZoom(m.value.viewport.getZoom());s>1?s*=1.02:s>.9&&s<1?s*=1.12:s>.7&&s<=.9?s*=1.22:s>.6&&s<=.7?s*=1.32:s>.5&&s<=.6?s*=1.42:s>.4&&s<=.5?s*=1.52:s>.3&&s<=.4?s*=1.72:s>.2&&s<=.3&&(s*=1.92),S.value=s*l*60;const o=document.createElement("div");if(o.id="rulerTitle",o.style.color="black",o.style.textAlign="center",o.style.fontSize="16px",o.style.minWidth="50px",o.style.width=S.value+"px","line"===a.id||"Line"===a){const a=k.value/2-S.value/2,l=k.value/2+S.value/2,s=k.value/2,n=s;o.innerHTML='<div style="width: 100%;">'+t+'μm</div><svg viewBox="0 0 150 150" xmlns="http://www.w3.org/2000/svg"><line x1="'+a+'" y1="'+s+'" x2="'+l+'" y2="'+n+'" stroke="black" stroke-width="2"/><line x1="'+a+'" y1="'+(s-5)+'" x2="'+a+'" y2="'+(n+5)+'" stroke="black" stroke-width="2"/><line x1="'+l+'" y1="'+(n-5)+'" x2="'+l+'" y2="'+(n+5)+'" stroke="black" stroke-width="2"/></svg>',e.appendChild(o)}else if("cross"===a.id||"Cross"===a){const a=k.value/2,l=k.value/2,s=S.value/2;o.innerHTML='<div style="width: 100%;">'+t+'μm</div><svg viewBox="0 0 150 150" xmlns="http://www.w3.org/2000/svg"><line x1="'+(a-s)+'" y1="'+l+'" x2="'+(a+s)+'" y2="'+l+'" stroke="black" stroke-width="2"/><line x1="'+a+'" y1="'+(l-s)+'" x2="'+a+'" y2="'+(l+s)+'" stroke="black" stroke-width="2"/></svg>',e.appendChild(o)}else if("circle"===a.id||"Circle"===a){const a=k.value/2,l=k.value/2,s=.5*S.value;o.innerHTML='<div style="width: 100%;">'+t+'μm</div><svg viewBox="0 0 150 150" xmlns="http://www.w3.org/2000/svg"><circle cx="'+a+'" cy="'+l+'" r="'+s+'" stroke="black" stroke-width="2" fill="transparent" opacity="0.6" /></svg>',e.appendChild(o)}else{const e=document.getElementById("rulerOverlay");if(null!==e){const t=document.getElementById("tilingViewer");t?.removeChild(e)}}},Ce=()=>{I.value=!I.value};return(t,c)=>{const u=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",$g,[(0,s.Lk)("div",Wg,[(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:c[0]||(c[0]=e=>ie("lowMag")),class:(0,n.C4)(["tab-btn_img_list",{active:"lowMag"===d.value,inactive:"lowMag"!==d.value}])},"Low magnification ",2),(0,s.Lk)("button",{onClick:c[1]||(c[1]=e=>ie("malaria")),class:(0,n.C4)(["tab-btn_img_list",{active:"malaria"===d.value,inactive:"malaria"!==d.value}])},"Malaria ",2)]),(0,s.Lk)("div",Xg,[(0,s.bo)((0,s.Lk)("button",{class:"darkButton",onClick:re},"IMG Setting",512),[[l.aG,"malaria"!==d.value]]),(0,s.bo)((0,s.Lk)("div",Gg,[(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","sun"]}),(0,s.Lk)("span",null,"Brightness "+(0,n.v_)(p.value),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"120","onUpdate:modelValue":c[2]||(c[2]=e=>p.value=e),onInput:ce},null,544),[[l.Jo,p.value]]),(0,s.Lk)("button",{class:"resetBtn",onClick:me},"Brightness Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","palette"]}),(0,s.Lk)("span",null,"RGB [ "+(0,n.v_)(`${g.value[0]} , ${g.value[1]}, ${g.value[2]}`)+" ]",1),(0,s.Lk)("div",Hg,[Vg,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[3]||(c[3]=e=>g.value[0]=e),onInput:ue},null,544),[[l.Jo,g.value[0]]])]),(0,s.Lk)("div",jg,[Yg,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[4]||(c[4]=e=>g.value[1]=e),onInput:ue},null,544),[[l.Jo,g.value[1]]])]),(0,s.Lk)("div",qg,[Qg,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[5]||(c[5]=e=>g.value[2]=e),onInput:ue},null,544),[[l.Jo,g.value[2]]])]),(0,s.Lk)("button",{class:"resetBtn",onClick:de},"RGB Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","th"]}),Jg,(0,s.bF)(u,{icon:f.value?["fas","toggle-on"]:["fas","toggle-off"],onClick:ve},null,8,["icon"])]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","ruler"]}),zg,(0,s.Lk)("div",Zg,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(kg),(e=>((0,s.uX)(),(0,s.CE)("button",{class:(0,n.C4)(["tab-ruler-btn_img_list",{active:y.value===e.text,inactive:y.value!==e.text}]),onClick:t=>Ie(e),key:e.id},(0,n.v_)(e.text),11,ef)))),128))])]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","magnifying-glass"]}),tf,(0,s.bF)(u,{icon:I.value?["fas","toggle-on"]:["fas","toggle-off"],onClick:Ce},null,8,["icon"])])],512),[[l.aG,v.value]])],512)]),(0,s.Lk)("div",af,["malaria"===d.value?((0,s.uX)(),(0,s.Wv)(Ug,{key:0,selectItems:e.selectItems},null,8,["selectItems"])):"malaria"!==d.value&&_.value?((0,s.uX)(),(0,s.CE)("div",{key:1,ref_key:"tilingViewerLayer",ref:N,id:"tiling-viewer_img_list",style:{width:"100%"},onContextmenu:(0,l.D$)(z,["prevent"])},null,544)):((0,s.uX)(),(0,s.CE)("div",lf,of))])]),b.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"rbc-select-box",style:(0,n.Tr)({left:`${K.value}px`,top:`${O.value}px`})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([F.value],((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{key:a,class:"categories"},[(0,s.Lk)("ul",nf,[(0,s.Lk)("li",null,(0,n.v_)(e.categoryNm),1)]),(0,s.Lk)("ul",rf,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((l,o)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${t}-${a}-${o}`},["Poikilocyte"!==l.classNm?((0,s.uX)(),(0,s.CE)("li",{key:0,onClick:t=>Y(e.categoryId,l.classId,l.classNm)},[(0,s.Lk)("span",null,(0,n.v_)(l?.classNm),1)],8,cf)):(0,s.Q3)("",!0),"Basophilic Stippling"===l.classNm?((0,s.uX)(),(0,s.CE)("li",{key:1,onClick:c[6]||(c[6]=e=>Y("05","03","Malaria"))},df)):(0,s.Q3)("",!0)],64)))),128))])],512)),[[l.aG,"Shape"===e?.categoryNm||"Inclusion Body"===e.categoryNm]]))),128)),(0,s.Lk)("div",mf,[vf,(0,s.Lk)("ul",pf,[(0,s.Lk)("li",{onClick:c[7]||(c[7]=e=>Y("04","01","Platelet"))},ff)])])],64)))),128))],4)):(0,s.Q3)("",!0),a.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":a.value,type:i.value,message:r.value,onHide:ee,"onUpdate:hideAlert":ee},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const yf=If;var bf=yf;const Cf={class:"wbcMenu"},hf={class:"menuIco"},Sf={class:"menuIco"},kf={class:"menuIco"},Nf=(0,s.Lk)("p",null,"REPORT",-1),_f=(0,s.Lk)("p",null,"LIS-CBC",-1),Ef={class:"wbcMenuBottom"},wf=["disabled"],Rf=["disabled"];var Lf=(0,s.pM)({__name:"classInfoMenu",props:["isNext"],setup(e,{emit:t}){const a=t,l=(0,o.KR)(!1),i=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)("bm"),m=(0,o.KR)(null),v=(0,o.KR)([]),p=((0,o.KR)([]),(0,s.nI)()),g=(0,c.Pj)(),f=(0,s.EW)((()=>g.state.commonModule.selectedSampleId)),I=(0,r.lq)(),y=(0,o.KR)([]),b=(0,s.EW)((()=>g.state.commonModule.cbcLayer)),C=(0,o.KR)(!1);let h;const S=(0,o.KR)(!1),k=e,N=(0,o.KR)(""),_=(0,o.KR)(!0),E=(0,o.KR)("");let w;const R=(0,s.EW)((()=>g.state.commonModule.testType)),L=(0,s.EW)((()=>g.state.commonModule.dbListDataFirstNum)),T=(0,s.EW)((()=>g.state.commonModule.dbListDataLastNum));(0,s.wB)(k.isNext,(e=>{e&&F("down")})),(0,s.KC)((async()=>{d.value=window.PROJECT_TYPE,await P(),_.value=!1;const e="bm"===d.value?"bmKeepPage":"keepPage";E.value=JSON.parse(JSON.stringify(sessionStorage.getItem(e)))})),(0,s.sV)((async()=>{S.value=!0;const e=await Ot();N.value=e.data})),(0,s.hi)((async()=>{S.value&&await D(),await g.dispatch("commonModule/setCommonInfo",{cbcLayer:!1})}));const P=async()=>{try{const e=await fu(String(f.value));m.value=e.data,await g.dispatch("commonModule/setCommonInfo",{testType:m.value.testType}),v.value=e.data}catch(e){console.log(e),m.value=null,v.value=null}},A=()=>{l.value=!1},D=async()=>{await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(v.value?.id)});const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:t,endDate:a,page:l,searchText:s,nrCount:o,testType:n,wbcInfo:i,wbcTotal:r}=JSON.parse(e),c=t+a+l+s+o+n+i+r,u=`oldPcIp=${N.value}&dayQuery=${c}`;await bu(u).then((e=>{K("SEND_DATA","refreshDb",300)})).catch((e=>{console.log("2 err",e)}))},M=async e=>{try{const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:t,endDate:a,page:l,searchText:s,nrCount:o,testType:n,wbcInfo:i,wbcTotal:r}=JSON.parse(e),c=t+a+l+s+o+n+i+r,u=`oldPcIp=${N.value}&newEntityId=${v.value?.id}&newPcIp=${N.value}&dayQuery=${c}`;await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(v.value?.id)}),await yu(u).then((e=>{K("SEND_DATA","refreshDb",300)})).catch((e=>{console.log("3 err",e)}))}catch(t){console.log(t)}},x=async()=>{try{const e=await He();e&&(0===e?.data.length?y.value=[]:y.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}},K=(e,t,a)=>{void 0!==w&&clearTimeout(w),w=window.setTimeout((()=>{p?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},O=e=>{VC.push(e),S.value=!1};async function B(e,t,a){try{const l=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:s,endDate:o,page:n,searchText:i,nrCount:r,testType:c,wbcInfo:u,wbcTotal:d}=JSON.parse(l),m=s+o+n+i+r+c+u+d,p=`id=${e}&step=${t}&type=${a}&dayQuery=${m}`,f=await Iu(p);null!==f.data&&(v.value=f.data,await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(f.data.id)}))}catch(l){console.log(l)}}const F=async e=>{if("up"===e){if(L.value===m.value?.id)return l.value=!0,i.value="success",void(u.value="This is the first page. Navigation to other pages is not possible.")}else if(T.value===m.value?.id)return l.value=!0,i.value="success",void(u.value="This is the last page. Navigation to other pages is not possible.");g.dispatch("commonModule/setCommonInfo",{cbcLayer:!1}),void 0!==h&&clearTimeout(h),C.value=!0,await x(),await U(e,m.value?.id),h=window.setTimeout((()=>{C.value=!1}),700)},U=async(e,t)=>{const a=await B(t,"1",e);if(v.value?.lock_status)return l.value=!0,i.value="success",void(u.value="Someone else is editing.");await $(a?.id,a)},$=async(e,t)=>{if(!v.value)return;m.value=v.value;const a=0===v.value?.wbcInfoAfter.length?v.value?.wbcInfo?.wbcInfo[0]:v.value?.wbcInfoAfter;await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(e)}),await W(a,v.value)},W=async(e,t)=>{await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(t.id)}),("pb"===d.value&&"01"===m.value?.testType&&X("/databaseRbc")||!E.value||"false"===E.value)&&O("/databaseDetail"),a("refreshClass",t),S.value=!0,await M(t)},X=e=>I.path===e,G=()=>{g.dispatch("commonModule/setCommonInfo",{cbcLayer:!b.value})};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Cf,[(0,s.Lk)("ul",null,[["bm","pb"].includes(d.value)?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},["pb"!==d.value||"04"===R.value&&"pb"===d.value?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({onRight:X("bm"===d.value?"/databaseWhole":"/databaseRbc")}),onClick:t[0]||(t[0]=e=>O("bm"===d.value?"/databaseWhole":"/databaseRbc"))},[(0,s.Lk)("p",hf,[(0,s.bF)(a,{icon:["fas","virus"]})]),(0,s.Lk)("p",null,(0,n.v_)("bm"===d.value?"WHOLE":"RBC"),1)],2)):(0,s.Q3)("",!0),(0,s.Lk)("li",{class:(0,n.C4)({onRight:X("/databaseDetail")}),onClick:t[1]||(t[1]=e=>O("/databaseDetail"))},[(0,s.Lk)("p",Sf,[(0,s.bF)(a,{icon:["fas","disease"]})]),(0,s.Lk)("p",null,(0,n.v_)("bm"===d.value?"BM CELL":"WBC"),1)],2),_.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",{key:1,class:(0,n.C4)({onRight:X("/report")}),onClick:t[2]||(t[2]=e=>O("/report"))},[(0,s.Lk)("p",kf,[(0,s.bF)(a,{icon:["fas","clipboard"]})]),Nf],2))],64)):(0,s.Q3)("",!0)]),"bm"!==d.value?((0,s.uX)(),(0,s.CE)("div",{key:0,onClick:G,class:(0,n.C4)({onRight:b.value,cbcLi:!0})},[(0,s.bF)(a,{icon:["fas","desktop"]}),_f],2)):(0,s.Q3)("",!0),(0,s.Lk)("div",Ef,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>F("up")),disabled:C.value},[(0,s.bF)(a,{icon:["fas","circle-up"]})],8,wf),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>F("down")),disabled:C.value},[(0,s.bF)(a,{icon:["fas","circle-down"]})],8,Rf)])]),l.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":l.value,type:i.value,message:u.value,onHide:A,"onUpdate:hideAlert":A},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Tf=Lf;var Pf=Tf,Af=a(8990);const Df=ee(),Mf=async e=>Df.httpPost(te.filesystem.post,e,""),xf=async e=>Df.httpDelete(te.filesystem.delete,e,!1),Kf=async e=>Df.httpGet(te.filesystem.createDirectory,`${e}`,!0),Of=async e=>Df.httpPost(te.filesystem.fileCreate,e,""),Bf=async e=>Df.httpPost(te.filesystem.cbcSaveData,e,""),Ff={class:"cbcDiv"},Uf={key:0,class:"loaderBackground cbc"},$f=(0,s.Lk)("div",{class:"loader"},null,-1),Wf=(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1),Xf=[$f,Wf],Gf=(0,s.Lk)("h1",{class:"titleCbc"},"CBC + DIFF",-1),Hf={key:1,class:"cbcDivWarp"},Vf={class:"cbcTable"},jf=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"50%"}),(0,s.Lk)("col",{width:"50%"})],-1),Yf={key:2,class:"cbcDivWarp"},qf={class:"cbcTable"},Qf={key:0},Jf={key:3,class:"cbcDivWarp"},zf={class:"cbcTable"},Zf={key:4};var eI=(0,s.pM)({__name:"lisCbc",props:["selectItems"],setup(e){const t=(0,c.Pj)(),a=e,l=(0,o.KR)([]),i=(0,o.KR)(""),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(""),g=(0,s.EW)((()=>t.state.userModule)),f=(0,s.EW)((()=>t.state.commonModule.deviceSerialNm)),I=(0,s.EW)((()=>t.state.commonModule.siteCd)),y=(0,s.EW)((()=>t.state.commonModule.selectedSampleId)),b=(0,o.KR)([]),C=(0,o.KR)([]),h=(0,o.KR)(!1),S=(0,o.KR)(""),k=(0,o.KR)("");(0,s.wB)(a.selectItems,(async e=>{C.value=e,await T(),await P(),await N(C.value)}),{deep:!0}),(0,s.sV)((async()=>{C.value=a.selectItems,await T(),await P(),await N(C.value),Je.subscribe("classInfoCbcDataGet",E)}));const N=async e=>{d.value=!0;let t=mc.find((e=>e.siteCd===I.value))?.hospitalNm;switch(""===I.value&&(t="0000"),t){case"서울성모병원":await R(e);break;case"고대안암병원":await L();break;case"인천길병원":await L();break;case"0000":await L();break;case"삼광의료재단":break;case"인하대병원":await E();break;default:await _();break}C.value.cbcPatientNo=i.value,C.value.cbcPatientNm=r.value,C.value.cbcSex=u.value,C.value.cbcAge=m.value;const a={cbcPatientNo:i.value,cbcPatientNm:r.value,cbcSex:u.value,cbcAge:m.value},l=await vu(String(y.value)),s={...l.data,...a};await A([s])},_=async()=>{if(""===p.value)return void w(G.UPLOAD_PLEASE_CBC);if(p.value.includes("http")){const e={url:p.value,barcodeNo:a.selectItems.barcodeNo,userId:g.value.userId,deviceBarcode:f.value},t=e.url+"?barcodeNo="+e.barcodeNo+"&deviceBarcode="+f.value+"&userid="+e.userId;await Z.A.get(t).then((async function(e){const t=await Hc(e.data);l.value=[],t.data?.segments.forEach((function(e){"OBX"===e.name.trim()?b.value.forEach((function(t){if(t.CBC_CD===e.fields[3].value[0][0].value[0]){var a={classNm:t.cd,count:e.fields[5].value[0][0].value[0],unit:e.fields[6].value[0][0].value[0]};l.value.push(a)}})):"PID"===e.name.trim()&&(i.value=e.fields[1].value[0][0].value[0],r.value=e.fields[4].value[0][0].value[0],u.value=e.fields[6].value[0][0].value[0],m.value=e.fields[7].value[0][0].value[0])})),d.value=!1})).catch((function(e){console.log(e.message),d.value=!1}))}else{const e=await Gc(`path=${p.value}&filename=${a.selectItems.barcodeNo}.hl7`);if(e.data.success){const t=await Hc(e.data.data);l.value=[],t?.data?.segments.forEach((e=>{"OBX"===e.name.trim()&&b.value.forEach((t=>{if(t.cd===e.fields[3].value[0][0].value[0]){const a={classNm:t.cd,count:e.fields[5].value[0][0].value[0],unit:e.fields[6].value[0][0].value[0]};l.value.push(a)}}))})),d.value=!1}else console.error(e.data.message),d.value=!1}const e={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};await Bf(e)},E=async()=>{if(console.log("inhaCbc cbcFilePathSetArr",p),""!==p.value){if(p.value.includes("http"))try{let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const s={machine:"ADUIMD",episode:a.selectItems.barcodeNo,baseUrl:`${p.value}/api/MifMain/File`},o=await Z.A.post(`${e}/cbc/executePostCurl`,s);l.value=[];const n=o.data[0];if("0"===n?.returnCode){i.value=n?.regNo,r.value=n?.name,u.value=n?.sex,m.value=n?.age,v.value=n?.testCode,await t.dispatch("commonModule/setCommonInfo",{inhaTestCode:n?.testCode});const e=n.testCode.split(",");e.forEach((e=>{const[t,a,s]=e.split("|"),o=b.value.find((e=>e.cd===t));if(o){const e={classNm:o.classCd,count:a,unit:s||""};l.value.push(e)}}))}else w(n?.returnCode);const c={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};await Bf(c),d.value=!1,console.log("Response:",o.data)}catch(e){console.log(e.message+" : no CBC result"),d.value=!1,w(e.message)}}else w(G.UPLOAD_PLEASE_CBC)},w=e=>{h.value=!0,S.value="error",k.value=e},R=async e=>{let t=window.APP_API_BASE_URL||"http://192.168.0.131:3002";Z.A.get(`${t}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00124",business_id:"li",instcd:"012",bcno:e.barcodeNo},headers:{"Content-Type":"application/json"}}).then((function(e){const t=e.data?.data,s=JSON.parse((0,Af.xml2json)(t,{compact:!0}));l.value=s.root.spcworklist.worklist;const o={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};Bf(o),d.value=!1})).catch((function(e){console.log(e.message),d.value=!1}))},L=async()=>{let e;if(e="0000"===I.value||""===I.value?await Gc(`path=${p.value}&filename=${a.selectItems.barcodeNo}`):await Gc(`path=C:/Users/user/Desktop/IA_MSG/CBC&filename=${a.selectItems.barcodeNo}`),e.data.success){const t=e.data.data.toString(),s=t.split("\n"),o=["SPC_NO","BLCL_DT","PT_NO","PT_NM","SEX","AGE","SCAT_WDF","SCAT_WNR","DIST_RBC","DIST_WDF(FSC)","DIST_PLT"];s.forEach((e=>{const[t,a]=e.split("\t").map((e=>e.trim()));if(o.includes(t.trim()))switch(t){case"PT_NO":i.value=a;break;case"SEX":u.value=a;break;case"AGE":m.value=a;break}else{const e=t.includes("%")?"%":"";l.value.push({classNm:t,count:a,unit:e})}}));const n={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};await Bf(n)}d.value=!1},T=async()=>{try{const e=await xe();if(e&&e.data){const t=e.data;p.value=t[0].cbcFilePath}}catch(e){console.error(e)}},P=async()=>{try{const e=await Ae();e&&e.data&&(b.value=e.data)}catch(e){console.error(e)}};async function A(e){try{const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(t),u=a+l+s+o+n+i+r+c,d=await uu({userId:Number(g.value.id),runingInfoDtoItems:e,dayQuery:u});d||console.error("백엔드가 디비에 저장 실패함")}catch(t){console.error("Error:",t)}}return(e,t)=>((0,s.uX)(),(0,s.CE)("div",Ff,[d.value?((0,s.uX)(),(0,s.CE)("div",Uf,Xf)):(0,s.Q3)("",!0),Gf,"0002"===I.value&&0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",Hf,[(0,s.Lk)("table",Vf,[jf,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.tclsscrnnm._cdata),1),(0,s.Lk)("td",null,(0,n.v_)(e.inptrslt._cdata),1)])))),128))])])):"0007"===I.value&&0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",Yf,[(0,s.Lk)("table",qf,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.classNm),1),(0,s.Lk)("td",null,[(0,s.eW)((0,n.v_)(e.count)+" ",1),""!==e.cham?((0,s.uX)(),(0,s.CE)("span",Qf," ("+(0,n.v_)(e.cham)+") ",1)):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,n.v_)(e.unit),1)])])))),128))])])):0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",Jf,[(0,s.Lk)("table",zf,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.classNm),1),(0,s.Lk)("td",null,(0,n.v_)(e.count)+" "+(0,n.v_)(e.unit),1)])))),128))])])):(0,s.Q3)("",!0),0===l.value.length?((0,s.uX)(),(0,s.CE)("div",Zf," No Data ")):(0,s.Q3)("",!0)]))}});const tI=eI;var aI=tI;const lI={key:0,class:"wbcContent"},sI={class:"topClintInfo"};var oI=(0,s.pM)({__name:"listDetailRbc",setup(e){const t=(0,o.KR)({}),a=(0,c.Pj)(),l=(0,o.KR)(null),i=(0,o.KR)([]),r=(0,o.KR)(!1),u=(0,o.KR)(!1),d=(0,s.EW)((()=>a.state.commonModule.cbcLayer)),m=(0,s.EW)((()=>a.state.commonModule.selectedSampleId)),v=(0,o.KR)(!1),p=(0,o.KR)(!1),f=(0,o.KR)(!1),I=(0,o.KR)(0);(0,s.sV)((async()=>{v.value=!1,await b(),await y()}));const y=async()=>{l.value=t.value},b=async()=>{try{const e=await vu(String(m.value));t.value=e.data}catch(e){console.log(e),t.value=null}v.value=!0},C=e=>{u.value=e},h=async e=>{l.value=e,t.value=e,r.value=!r.value,I.value=0},S=e=>{i.value=e},k=async e=>{const s=await vu(String(m.value));t.value=s.data,l.value=s.data;let o=[];o=e,await a.dispatch("commonModule/setCommonInfo",{classInfoArr:o})},N=()=>{r.value=!r.value},_=e=>{f.value=e},E=e=>{I.value=e};return(e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Pf,{onRefreshClass:h}),v.value?((0,s.uX)(),(0,s.CE)("div",lI,[(0,s.Lk)("div",sI,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,(0,n.v_)((0,o.R1)(g)(t.value?.testType)),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.barcodeNo),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.patientId||"patientId No Data"),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.cbcPatientNo),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.patientName),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.cbcPatientNm)+" "+(0,n.v_)(t.value?.cbcSex)+" "+(0,n.v_)(t.value?.cbcAge),1),(0,s.Lk)("li",null,(0,n.v_)(t.value?.analyzedDttm),1)])]),d.value?((0,s.uX)(),(0,s.Wv)(aI,{key:0,selectItems:t.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcRight shadowBox"+(d.value?" cbcLayer":""))},[(0,s.bF)(Cg,{allUnCheck:p.value,onIsBeforeUpdate:C,onClassInfoArrUpdate:S,onClassInfoArrUpdateRe:k,selectItems:t.value,type:"listTable",allCheckClear:r.value,rbcInfo:l.value,notCanvasClickVal:f.value,currentRbcPageNumber:I.value},null,8,["allUnCheck","selectItems","allCheckClear","rbcInfo","notCanvasClickVal","currentRbcPageNumber"])],2),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcLeft"+(d.value?" cbcLayer":""))},[(0,s.bF)(bf,{onNotCanvasClick:_,onUnChecked:N,isBefore:u.value,onChangeCurrentRbcImagePageNumber:E,classInfoArr:i.value,selectItems:t.value,type:"listTable",rbcInfo:l.value},null,8,["isBefore","classInfoArr","selectItems","rbcInfo"])],2)])):(0,s.Q3)("",!0)],64))}});const nI=oI;var iI=nI;const rI="li",cI="012",uI="H59",dI=[{id:"01",title:"NS",name:"Neutrophil-Segmented",cd:"LHR10501"},{id:"02",title:"ME",name:"Metamyelocyte",cd:"LHR10507"},{id:"03",title:"MY",name:"Myelocyte",cd:"LHR10508"},{id:"04",title:"PR",name:"Promyelocyte",cd:"LHR10509"},{id:"05",title:"LY",name:"Lymphocyte",cd:"LHR10503"},{id:"61",title:"LR",name:"Reactive lymphocyte",cd:"LHR10544"},{id:"62",title:"LA",name:"Abnormal lymphocyte",cd:"LHR10543"},{id:"07",title:"MO",name:"Monocyte",cd:"LHR10504"},{id:"08",title:"EO",name:"Eosinophil",cd:"LHR10505"},{id:"09",title:"BA",name:"Basophil",cd:"LHR10506"},{id:"10",title:"BL",name:"Blast",cd:"LHR10510"},{id:"11",title:"PC",name:"Plasma cell",cd:"LHR10517"}],mI=e=>{const t=new Set;return e.filter((e=>!t.has(e.id)&&(t.add(String(e.id)),!0)))},vI=["src"],pI={key:1,class:"mt1",style:{height:"209.5px"}},gI={class:"mt1 mb2 flexSpaceBetween"},fI={class:"wbcClassInfoLeft"},II={class:"leftWbcInfo"},yI={style:{position:"relative"}},bI={key:0,class:"memoModal"},CI={class:"wbcClassScroll"},hI=(0,s.Fv)('<ul class="nth1Child classAttribute"><li>Class</li><li class="wbcTitleText"><p class="firstP">Before</p><p>(Count | Percent)</p></li><li class="wbcTitleText"><p class="firstP">After</p><p>(Count | Percent)</p></li></ul>',1),SI=["onDragstart","onDrop"],kI=["onClick"],NI={style:{display:"flex","justify-content":"space-evenly"}},_I={class:"grayText w20 textLeft"},EI={class:"grayText w50 textLeft"},wI={style:{display:"flex","justify-content":"space-evenly"}},RI={class:"wbcClassDbDiv classTotalColor"},LI={class:"nth1Child"},TI=(0,s.Lk)("li",null,"Total",-1),PI={class:"classInfoWbc"},AI={class:"w20 textLeft"},DI=(0,s.Lk)("span",{class:"w50 textLeft"},"100%",-1),MI={class:"classInfoWbc"},xI={class:"w20 textLeft"},KI=(0,s.Lk)("span",{class:"w50 textLeft"},"100%",-1),OI={key:0},BI=["onDragstart","onDrop"],FI=["onClick"],UI={class:"grayText"},$I={key:1},WI=["onClick"],XI={class:"categoryNm",style:{cursor:"default"}},GI={key:0,class:"mb1 liTitle",style:{cursor:"default"}},HI={class:"wFit",style:{cursor:"default"}},VI={style:{width:"29%"}},jI={key:0,class:"mb1 liTitle"},YI={class:"grayText",style:{cursor:"default","padding-left":"-20px"}},qI={key:0},QI={class:"degree",style:{width:"27%"}},JI={key:0,class:"mb1 liTitle"},zI={key:0};var ZI=(0,s.pM)({__name:"classInfo",props:["wbcInfo","selectItems","type","isCommitChanged","classCompareShow"],setup(e,{emit:t}){const a=e,i=(0,c.Pj)(),r=(0,s.EW)((()=>i.state.userModule)),u=t,d=(0,o.KR)(a.selectItems),m=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),v=(0,s.EW)((()=>i.state.commonModule.inhaTestCode)),p=(0,o.KR)([]),g=(0,s.EW)((()=>i.state.commonModule.deviceSerialNm)),f=(0,s.EW)((()=>i.state.commonModule.siteCd)),y=(0,s.EW)((()=>i.state.commonModule.selectedSampleId)),b=(0,o.KR)(""),C=(0,o.KR)(""),h=(0,o.KR)(""),S=(0,o.KR)(!1),k=(0,o.KR)([]),N=(0,o.KR)([]),_=(0,o.KR)([]),E=(0,o.KR)(!1),w=(0,o.KR)(-1),R=(0,o.KR)(0),L=(0,o.KR)(!1),T=(0,o.KR)(""),P=(0,o.KR)(""),A=(0,o.KR)(!1),D=(0,o.KR)(""),M=(0,o.KR)(""),x=(0,o.KR)([]),K=(0,o.KR)(!1),O=(0,o.KR)(0),B=(0,o.KR)(0),F=(0,o.KR)(""),U=(0,o.KR)([]),$=(0,o.KR)([]),W=(0,o.KR)([]),X=(0,o.KR)([]),H=(0,o.KR)(!1),Y=(0,o.KR)(!1),q=(0,o.KR)(!1);(0,s.KC)((async()=>{H.value=!1,K.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{await(0,s.dY)(),await Te(),await $e(),await Q(),await ye(),await be(),H.value=!1})),(0,s.wB)((()=>a.isCommitChanged),(()=>{d.value.submitState="Submit"})),(0,s.wB)(r.value,(e=>{C.value=e.id})),(0,s.wB)((()=>a.wbcInfo),(e=>{if(0!==Object.keys(e).length){Pe(e),h.value=a.selectItems?.wbcMemo;const t=""!==a.selectItems?.img_drive_root_path&&a.selectItems?.img_drive_root_path?a.selectItems?.img_drive_root_path:m.value;if(b.value=I("barcode_image.jpg",t,a.selectItems?.slotId,wt.barcodeDirName),i.dispatch("commonModule/setCommonInfo",{testType:a.selectItems.testType}),""===a.selectItems?.submitState){const e=vu(String(a.selectItems?.id)),t={submitState:"checkFirst"},l={...e.data,...t};we(l,!0)}}}));const Q=async()=>{""===v.value&&"0011"===f.value&&Je.publish("classInfoCbcDataGet",!0),Je.subscribe("appVueSlideDataSaveLisSave",ve),h.value=a.selectItems?.wbcMemo;const e=""!==a.selectItems?.img_drive_root_path&&a.selectItems?.img_drive_root_path?a.selectItems?.img_drive_root_path:m.value;if(b.value=I("barcode_image.jpg",e,a.selectItems?.slotId,wt.barcodeDirName),a.selectItems?.submitState&&(q.value="lis"===a.selectItems.submitState),""===a.selectItems?.submitState||!a.selectItems?.submitState){const e=await vu(String(a.selectItems?.id)),t={submitState:"checkFirst"},l={...e.data,...t};await we(l,!0)}},J=()=>{A.value=!0,M.value=G.IDS_MSG_UPLOAD_LIS,F.value="lis"},z=e=>{u("scrollEvent",e)},ee=()=>K.value?"BM Classification":"WBC Classification",te=(e,t)=>{w.value=e,R.value=t.clientY-t.target.getBoundingClientRect().top},ae=(e,t)=>{if(E.value&&(t.preventDefault(),-1!==w.value)){const t=k.value.splice(w.value,1)[0];k.value.splice(e,0,t),w.value=-1,Fe()}},le=()=>{E.value=!E.value},se=async()=>{const e=document.createElement("textarea");e.value=a.selectItems.barcodeNo,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),Xe(G.IDS_MSG_SUCCESS)},oe=()=>{Y.value=!0,A.value=!0,M.value=G.IDS_MSG_CONFIRM_SLIDE,F.value="commit"},ne=()=>{"commit"===F.value?Se():ie(),A.value=!1},ie=()=>{"0002"===f.value?ce():""===f.value||"0000"===f.value?re():ue()},re=()=>{const e=dI,{wbcInfoAfter:t}=a.selectItems??{};let l=window.APP_API_BASE_URL||"http://192.168.0.131:3002";Z.A.get(`${l}/cbc/liveTest`,{params:{baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live",submit_id:"TRLII00124",business_id:"li",instcd:"012"},headers:{"Content-Type":"application/json"}}).then((async function(l){const s=l.data.trim(),o=JSON.parse((0,Af.xml2json)(s,{compact:!0})),n=o.root.spcworklist.worklist,i=["LHR10501","LHR10502","LHR10503","LHR10504","LHR10505","LHR10506"],r=n.filter((function(e){return"LHR100"===e.testcd._cdata}));t.forEach((function(t){t.testcd="",e.forEach((function(e){String(t.id)===String(e.id)&&(t.testcd=e.cd)}))}));let c=[];t.forEach((function(e){i.forEach((function(t){(e.testcd===t||Number(e.count)>0&&""!==e.testcd)&&c.push({testcd:e.testcd,percent:e.percent,name:e.name})}))}));const u=new Set(c.map((e=>e.testcd)));c=Array.from(u).map((e=>c.find((t=>t.testcd===e))));const d=c.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent)))).reduce(((e,t)=>e+t),0),m=c.map((e=>"Neutrophil"===e.name?{...e,percent:100-d}:{...e,percent:Math.round(parseFloat(e.percent))}));c=m;const v=c.filter((e=>"LHR10501"===e.testcd));if(v.length>0&&r.length>0){const e=(Number(r[0].inptrslt._cdata)*v[0].percent/100).toFixed(2);c.push({testcd:"LHR10599",percent:e,name:"ANC 계산"})}const p=await vu(String(a.selectItems?.id)),g={submitState:"lis"};q.value=!0;const f={id:p.data.id,...g};await we(f,!0)})).catch((function(e){console.log("error.config",e.config),Ge(e.message)}))},ce=()=>{const e=dI,{barcodeNo:t,wbcInfoAfter:l}=a.selectItems??{};let s=window.APP_API_BASE_URL||"http://192.168.0.131:3002";Z.A.get(`${s}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00124",business_id:"li",instcd:"012",bcno:t,baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"},headers:{"Content-Type":"application/json"}}).then((async function(o){const n=o.data.data.trim(),i=JSON.parse((0,Af.xml2json)(n,{compact:!0})),c=i.root.spcworklist.worklist,u=["LHR10501","LHR10502","LHR10503","LHR10504","LHR10505","LHR10506"],d=c.filter((function(e){return"LHR100"===e.testcd._cdata}));l.forEach((function(t){t.testcd="",e.forEach((function(e){String(t.id)===String(e.id)&&(t.testcd=e.cd)}))}));let m=[];l.forEach((function(e){u.forEach((function(t){(e.testcd===t||Number(e.count)>0&&""!==e.testcd)&&m.push({testcd:e.testcd,percent:e.percent})}))}));const v=new Set(m.map((e=>e.testcd)));m=Array.from(v).map((e=>m.find((t=>t.testcd===e))));const p=m.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent)))).reduce(((e,t)=>e+t),0),g=m.map((e=>"Neutrophil"===e.name?{...e,percent:100-p}:{...e,percent:Math.round(parseFloat(e.percent))}));m=g;const f=m.filter((e=>"LHR10501"===e.testcd));if(f.length>0&&d.length>0){const e=(Number(d[0].inptrslt._cdata)*f[0].percent/100).toFixed(2);m.push({testcd:"LHR10599",percent:e,name:"ANC 계산"})}const I=`D:\\UIMD_Data\\UI_Log\\CBCLookUP\\${t}.txt`,y={filePath:I,data:{cbcJson:i,cbcWorkList:c}};await Bf(y),Ce(r.value.employeeNo).then((function(e){if("succ"===e){const e={empNo:r.value.employeeNo,barcodeNo:t,wbcInfo:m},o=new Date,n=`${o.getFullYear()}`;let u=`${o.getMonth()+1}`;1===u.length&&(u=`0${u}`);let d=`${o.getDate()}`;1===d.length&&(d=`0${d}`);const v=String.fromCharCode(23),p=String.fromCharCode(23,23),g=String.fromCharCode(3),I=e.wbcInfo.filter((e=>null!==e.testcd&&""!==e.testcd)).map((e=>`${e.testcd}${v}${e.percent}${p}${n}${u}${d}${g}`)).join(""),y={submit_id:"TXLII00101",business_id:rI,ex_interface:`${e.empNo}|${cI}`,instcd:cI,userid:e.empNo,eqmtcd:uI,bcno:e.barcodeNo,result:I,testcont:"MANUAL DIFFERENTIAL COUNT RESULT",testcontcd:"01",execdeptcd:"H1",baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"};Z.A.get(`${s}/cbc/lisCbcMarys`,{params:y,headers:{"Content-Type":"application/json"}}).then((async function(e){const s=e.data.data,o=JSON.parse((0,Af.xml2json)(s,{compact:!0})),n=o.root.ResultFlag.resultflag._text,u={empNo:r.value.employeeNo,barcodeNo:t,wbcTemp:m,frontendSendData:y,processSendData:I,uimdDefaultData:l,nsPercentItem:f,cbcJson:i,cbcWorkList:c},d=`D:\\UIMD_Data\\UI_Log\\LISFinalReport\\${t}.txt`,v={filePath:d,data:{frontendData:u,lisLastReportVal:e}};if(await Bf(v),"Y"===n){const e=await vu(String(a.selectItems?.id)),t={submitState:"lis"};q.value=!0;const l={...e.data,...t};await we(l,!0),Xe(G.IDS_MSG_SUCCESS)}else{const e=o.root.ResultFlag.error2._text.indexOf("!"),t=-1!==e?o.root.ResultFlag.error2._text.substring(0,e+1):o.root.ResultFlag.error2._text,a="1"===o.root.ResultFlag.error2._text?"LIS 전송이 실패 했습니다.":t;Ge(a)}})).catch((function(e){Ge(e.message)}))}else Ge(G.IDS_ERROR_PLEASE_CONFIRM_YOUR_USER_ID)}))})).catch((function(e){console.log("error.config",e.config),Ge(e.message)}))},ue=()=>{if("0019"===f.value){let e=`H|\\^&||||||||||P||${a.selectItems?.barcodeNo}\n`,t=0;const l=e=>""===e.LIS_CD?"":a.selectItems?.wbcInfoAfter.filter((t=>e.IA_CD===t.id&&(Number(t.percent)>0||Number(t.count)))).map((a=>{const l=`R|${++t}|^^^^${e.LIS_CD}|${a.count}|||||||^${r.value.name}\n`,s=`R|${++t}|^^^^${e.LIS_CD}%|${a.percent}|%||||||^${r.value.name}\n`;return l+s})).join("");e+=U.value.map(l).join(""),e+="L|1|N",fe(e)}else if("0006"===f.value){const e=ge();fe(e)}else"0011"===f.value?pe(a.selectItems?.wbcInfoAfter,a.selectItems?.rbcInfoAfter,a.selectItems?.barcodeNo):me()},me=async()=>{const e=W.value,t=await Kf(e);if(t){const e={sendingApp:"PBIA",sendingFacility:"PBIA",receivingApp:"LIS",receivingFacility:"LIS",dateTime:j(),security:"",messageType:["ADT","R02"],messageControlId:a.selectItems?.barcodeNo,processingId:"P",hl7VersionId:"2.5",selectedItem:{},wbcInfo:a.selectItems?.wbcInfoAfter,result:U.value},t=await Vc(e);if(t)if(W.value.includes("http"))await Ie(t);else{const e={filepath:`${W.value}\\${a.selectItems.barcodeNo}.hl7`,msg:t};try{await jc(e),Xe(G.IDS_MSG_SUCCESS)}catch(l){Ge(l.response.data.message)}}}},ve=async(e,t,a)=>{await ye(),await pe(e,t,a)},pe=async(e,t,l)=>{if(console.log("인하대 테스트 wbcInfoAfter",e),console.log("인하대 테스트 rbcInfoAfter",t),console.log("인하대 테스트 barcodeNo",l),""===W.value)return void Ge(G.UPLOAD_PLEASE_LIS);let s="";const o=v.value.split(","),n=[];o.forEach((e=>{if(e.length>0){const[t,a,l,s]=e.split("|");let o="";"L0210"===t?o=`${t}|${a}5|`:"H1151"===t?o=`H9511|${a}|`:"H1152"===t?o=`H9512|${a}|`:"H1153"===t?o=`H9513|${a}|`:"H1154"===t?o=`H9514|${a}|`:"H1155"===t?o=`H9515|${a}|`:"H1165"===t?o=`H9510|${a}|`:"H1162"===t?o=`H9570|${a}|`:["H1101","H1102","H1103","H1104","H1105","H1106","H1121","H1122","H1123"].includes(t)&&(o=`${t}|${a}|`),o&&n.push(o)}})),p.value="",p.value=n.join(","),s+=p.value,console.log("tmpList 가공 매칭 후",n),console.log("inhaTestSendCode.value cbc 값 얻어와서 매칭 시킨 후 변경된 배열",p.value),console.log("inhaTestSendCode.value",p.value);let i="";const r=(e,t)=>{const a=e.LIS_CD,l=Number(t.count),o=t.percent;["H9600","H9365","H9366"].includes(a)?s+=a+"|"+(l>0?"1":" ")+"|,":["13","14"].includes(e.IA_CD)?s+=a+"|"+(l>Number(e.MIN_COUNT)?o:" ")+"|,":s+=a+"|"+(o>0?o:" ")+"|,"};U.value.forEach((t=>{e.forEach((e=>{t.IA_CD===e.id&&r(t,e)}))}));const c=["H9531","H9535","H9594","H9571","H9574","H9595"];$.value.forEach((function(e){""!==e.LIS_CD&&t.forEach((function(t){if(e.IA_CATEGORY_CD===t.IA_CATEGORY_CD)for(const a of t.classInfo)if(e.IA_CLASS_CD===a.IA_CLASS_CD){const t=0===Number(a.degree)?" ":c.includes(e.LIS_CD)?"0":a.degree;i+=`${e.LIS_CD}|${t}|,`,s+=`${e.LIS_CD}|${t}|,`}}))})),console.log("rbc wbc 중간 resultStr 값",s);const u={H9531:"H9571",H9532:"H9572",H9533:"H9573",H9535:"H9574",H9536:"H9575",H9537:"H9576",H9534:"H9577",H9538:"H9578",H9542:"H9518",H9544:"H9520",H9546:"H9517",H9548:"H9519",H9550:"H9522",H9552:"H9521",H9554:"H9525",H9556:"H9524",H9558:"H9526",H9560:"H9523",H9562:"H9528",H9564:"H9530",H9594:"H9595"};let d=i.replace(/H9531|H9532|H9533|H9535|H9536|H9537|H9534|H9538|H9542|H9544|H9546|H9548|H9550|H9552|H9554|H9556|H9558|H9560|H9562|H9564|H9594/g,(e=>u[e]));s+=i,s+=d,console.log("rbc wbc 최종 resultStr 값",s);try{let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const t={machine:"ADUIMD",episode:l,result:s,baseUrl:`${W.value}/api/MifMain/File`},o=await Z.A.post(`${e}/cbc/executePostCurl`,t),n=o.data[0];if(console.log("res 최종값",o),"0"===n?.returnCode){const e=`D:\\UIMD_Data\\UI_Log\\LIS_IA\\${a.selectItems?.barcodeNo}.txt`,t={filePath:e,res:n};await Bf(t);const l=await vu(String(a.selectItems?.id)),s={submitState:"lis"};q.value=!0;const o={id:l.data.id,...s};await we(o,!0),Xe(G.IDS_MSG_SUCCESS)}else Xe("return code : "+n?.returnCode)}catch(m){Xe(m.message)}},ge=()=>{let e=`H|\\^&||||||||||P||${a.selectItems?.barcodeNo}\n`,t=0,l=0,s=0;if(a.selectItems?.wbcInfoAfter.forEach((e=>{["02","03","04","10"].includes(e.id)&&(l+=Number(e.percent)),"72"===e.id&&(s=Number(e.percent))})),l>0&&s<6){const e=(e,t)=>{const l=a.selectItems?.wbcInfoAfter.find((t=>t.id===e));l&&(l.percent=t)};e("71",(Number(a.selectItems?.wbcInfoAfter.find((e=>"71"===e.id))?.percent)+s).toString()),e("72","0")}const o=(a,l)=>{""!==a.LIS_CD&&(["01","71","05","07","08","09"].includes(l.id)||Number(l.percent)>0)&&(e+=`R|${++t}|^^^^${a.LIS_CD}|${l.count}|||||||^${r.value.name}\n`,e+=`R|${++t}|^^^^${a.LIS_CD}%|${l.percent}|%||||||^${r.value.name}\n`)};return U.value.forEach((e=>{a.selectItems?.wbcInfoAfter.forEach((t=>{e.IA_CD===t.id&&o(e,t)}))})),e+="L|1|N"},fe=async e=>{const t=`D:\\UIMD_Data\\UI_Log\\LIS_IA\\${a.selectItems?.barcodeNo}.txt`,l={filePath:t,data:e};if(await Bf(l),W.value.includes("http"))await Ie(e);else{const t=W.value,l=await Kf(t);if(l){const l={path:t,filename:`${t}/${a.selectItems?.barcodeNo}.lst2msg`,content:e},s=await Of(l);if(s){const e=await vu(String(a.selectItems?.id)),t={submitState:"lis"},l={...e.data,...t};await we(l,!0),Xe(G.IDS_MSG_SUCCESS),L.value||u("nextPage")}else Ge("lis file err")}}},Ie=async e=>{const t={barcodeNo:a.selectItems?.barcodeNo,userId:r.value.name,deviceBarcode:g.value,resultMsg:e,baseUrl:W.value};try{let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const a=await Z.A.post(`${e}/cbc/executePostCurl`,t);"E000"===a.data.errorCode?Xe(G.IDS_MSG_SUCCESS):Ge(a.data.errorMessage)}catch(l){Ge(l.message)}},ye=async()=>{try{const e=await We(),t=await Le();if(e&&e.data&&t&&t.data){const a=e.data,l=t.data;if(a){let e=[];for(const t of a)e.push({CD_NM:t.fullNm,IA_CD:t?.id,LIS_CD:t?.key,MIN_COUNT:0});U.value=e}if(l){let e=[];for(const t of l)e.push({CATEGORY_NM:t.categoryNm,CLASS_NM:t?.fullNm,IA_CATEGORY_CD:t?.categoryId,IA_CLASS_CD:t?.id,LIS_CD:t?.key});$.value=e}}}catch(e){console.error(e)}},be=async()=>{try{const e=await xe();e&&e.data&&0!==e.data.length&&(W.value=e.data[0].lisFilePath)}catch(e){console.error(e)}},Ce=async e=>new Promise(((t,a)=>{if("0002"===f.value){let l=window.APP_API_BASE_URL||"http://192.168.0.131:3002";Z.A.get(`${l}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00104",business_id:"li",instcd:"012",userid:e,baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"},headers:{"Content-Type":"application/json"}}).then((function(e){const a=e.data.data,l=JSON.parse((0,Af.xml2json)(a,{compact:!0})),s=l.root.getUsernm.usernm._text;t(null===s||""===s?"fail":"succ")})).catch((function(e){console.log("checkUserAuth :"+e.message),a(new Error(e.message))}))}})),he=()=>{A.value=!1},Se=async()=>{const e=V()().local(),t=await vu(String(a.selectItems?.id)),l={submitState:"Submit",submitOfDate:e.format(),submitUserId:r.value.name},s={...t.data,...l};await we(s),d.value.submitState="Submit",u("submitStateChanged","Submit")},ke=async()=>{const e=h.value.replaceAll("\r\n","<br>"),t={wbcMemo:e},l=await vu(String(a.selectItems?.id)),s={...l.data,...t};await we(s),S.value=!1},Ne=()=>{S.value=!S.value},_e=()=>{S.value=!1},Ee=e=>"Artifact(Smudge)"===e&&"0006"===f.value?"Artifact":e,we=async(e,t)=>{try{const a=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:l,endDate:s,page:o,searchText:n,nrCount:i,testType:c,wbcInfo:u,wbcTotal:d}=JSON.parse(a),m=l+s+o+n+i+c+u+d,v=await uu({userId:Number(r.value.id),runingInfoDtoItems:[e],dayQuery:m});if(v){t||Xe("success");const a=e;h.value=a.wbcMemo}else console.error("백엔드가 디비에 저장 실패함")}catch(a){console.error("Error:",a)}},Re=(e,t)=>{let a=JSON.parse(JSON.stringify(e));return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),a},Te=async()=>{try{const e=await He();e&&(0===e?.data.length?x.value=[]:x.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}},Pe=async e=>{await Te();const t=await gu(String(y.value));await i.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(t?.data?.id)}),d.value=t.data;const l=d.value.wbcInfoAfter.filter((e=>90<=Number(e.id)&&Number(e.id)<=95));d.value.wbcInfoAfter=e;const s=X.value.filter((e=>""!==e.abbreviation&&""!==e.fullNm));let o=mI(d.value.wbcInfo.wbcInfo[0]||[]),n=mI(d.value?.wbcInfoAfter||t.data.wbcInfo.wbcInfo[0]||[]);if(o=mI(o),n=mI(n),s.length>0&&0===l.length)for(const a of s)if(n.find((e=>e.id!=a.customNum))){const e={id:String(a.customNum),name:a.fullNm,count:"0",title:a.abbreviation,images:[]};o.push(e),n.push(e)}if(s.length>0&&l.length>0)for(const a of l)if(n.find((e=>e.id!=a.id))){const e={id:String(a.id),name:a.name,count:"0",title:a.title,images:[]};o.push(e),n.push(a)}const r=0!==x.value.length?x.value:"bm"===window.PROJECT_TYPE?La:Ra,c=0!==x.value.length?x.value:"bm"===window.PROJECT_TYPE?wa:Ea;N.value=n,_.value=o;const u=De(n,"wbc"),m=De(o,"wbc");Be("before",m),Be("after",u);for(const a of m)Me(a,O.value);for(const a of u)Me(a,B.value);const v=mc.find((e=>"서울성모병원"===e.hospitalNm))?.siteCd===f.value,p=mc.find((e=>"인하대병원"===e.hospitalNm))?.siteCd===f.value;v?(_.value=Eu(m,_.value),N.value=Eu(u,N.value)):p&&(N.value=await _u(d.value,N.value),_.value=Eu(m,_.value)),k.value=[],N.value=Re(N.value,c),_.value=Re(_.value,r);for(const[a,i]of _.value.entries()){const e=N.value[a];if(!e)continue;const t=Ae(i,e),l={id:i.id,name:i.name,title:i.title,count:{before:i.count,after:e.count},images:{before:i.images,after:e.images},percent:{before:i.percent,after:e.percent},isChanged:t};k.value.push(l)}if(""===a.selectItems?.submitState||!a.selectItems?.submitState){const e=await vu(String(a.selectItems?.id)),t={submitState:"checkFirst"},l={...e.data,...t};await we(l,!0)}},Ae=(e,t)=>{if(Number(e.count)!==Number(t.count))return!0;const a=e.images.slice().map((e=>e.fileName)),l=t.images.slice().map((e=>e.fileName)),s=new Set(a),o=new Set(l);if(s.size!==o.size)return!0;{const e=[...s].every((e=>o.has(e)));return!e}},De=(e,t)=>{const a=["NR","GP","PA","AR","MA","SM"];return"nonWbc"===t?e.filter((e=>a.includes(e.title))):e.filter((e=>!a.includes(e.title)))},Me=(e,t)=>{if(K.value&&"OT"!==e.title){const a=(Number(e.count)/Number(t)*100).toFixed(1);e.percent=Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a}else{const a=mc.find((e=>"인하대병원"===e.hospitalNm))?.siteCd===f.value;if(a)return;const l=Oe(f.value,d.value?.testType);if(!l.includes(e.title)){const a=(Number(e.count)/Number(t)*100).toFixed(1);e.percent=Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a}}},Ke=e=>{const t=Oe(f.value,d.value?.testType);return!t.includes(e)},Oe=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},Be=(e,t)=>{"before"===e?O.value=0:"after"===e&&(B.value=0),t.forEach((t=>{if(K.value)"OT"!==t.title&&("before"===e?O.value+=Number(t.count):B.value+=Number(t.count));else{const a=Oe(f.value,d.value?.testType),l=a.includes(t.title);l||("before"===e?O.value+=Number(t.count):B.value+=Number(t.count))}}))};async function Fe(){let e=JSON.parse(JSON.stringify([...N.value])),t=0;e.forEach((e=>{e.images.forEach((e=>{if(K.value)"OT"!==e.title&&(t+=1);else{const a=Oe(f.value,d.value?.testType);a.includes(e.title)||(t+=1)}}))})),e.forEach((a=>{a.images.forEach((e=>{delete e.width,delete e.height,delete e.filter})),Me(a,t);const l=mc.find((e=>"서울성모병원"===e.hospitalNm))?.siteCd===f.value;l&&(N.value=Eu(e,N.value))})),d.value.wbcInfoAfter=e,await i.dispatch("commonModule/setCommonInfo",{classInfoSort:[...N.value]});const a=Re(x.value,k.value);a.forEach(((e,t)=>{e.orderIdx=t}));const l=await vu(String(y.value));l&&(l.data.wbcInfoAfter=e),await Ve(a),await Ue(e,[l.data]),u("classOrderChanged"),await i.dispatch("commonModule/setCommonInfo",{classInfoSort:[]})}async function Ue(e,t){try{const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(e),u=a+l+s+o+n+i+r+c,d=await uu({userId:Number(C.value),runingInfoDtoItems:t,dayQuery:u});d||console.error("백엔드가 디비에 저장 실패함")}catch(a){console.error("Error:",a)}}const $e=async()=>{try{const e=await de();X.value=e.data}catch(e){console.log(e)}},Xe=e=>{L.value=!0,T.value="success",P.value=e,window.scrollTo({top:0,behavior:"smooth"})},Ge=e=>{L.value=!0,T.value="error",P.value=e},je=()=>{L.value=!1},Ye=()=>{H.value=!0};return(t,a)=>{const o=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,["report"===e.type||H.value?"report"!==e.type&&H.value?((0,s.uX)(),(0,s.CE)("div",pI)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,class:"mt1",onError:Ye,src:b.value},null,40,vI)),(0,s.Lk)("div",gI,[(0,s.Lk)("h3",fI,(0,n.v_)(ee()),1),(0,s.Lk)("ul",II,[(0,s.Lk)("li",{onClick:se},[(0,s.bF)(o,{icon:["fas","copy"]})]),(0,s.Lk)("li",yI,[(0,s.bF)(o,{icon:["fas","comment-dots"],class:"memoOpenBtn",onClick:Ne}),S.value?((0,s.uX)(),(0,s.CE)("div",bI,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>h.value=e)},null,512),[[l.Jo,h.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:ke},"OK"),(0,s.Lk)("button",{class:"memoModalBtn",onClick:_e},"CANCEL")])):(0,s.Q3)("",!0)]),(0,s.Lk)("li",{onClick:oe,class:(0,n.C4)({submitted:"Submit"===d.value?.submitState})},[(0,s.bF)(o,{icon:["fas","square-check"]})],2),(0,s.Lk)("li",{onClick:J,class:(0,n.C4)({submitted:"lis"===d.value?.submitState||q.value})},[(0,s.bF)(o,{icon:["fas","upload"]})],2),(0,s.Lk)("li",null,[E.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(o,{key:0,icon:["fas","lock"],onClick:le})),E.value?((0,s.uX)(),(0,s.Wv)(o,{key:1,icon:["fas","lock-open"],onClick:le})):(0,s.Q3)("",!0)])])]),(0,s.Lk)("div",CI,[hI,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv",draggable:"true",onDragstart:e=>te(t,e),onDragover:a[1]||(a[1]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>ae(t,e)},[Ke(e.title)?((0,s.uX)(),(0,s.CE)("ul",{key:0,class:(0,n.C4)({nth1Child:!0,cursorMove:E.value}),onClick:t=>z(e.id),title:"BLUE text: changed element"},[(0,s.Lk)("li",null,(0,n.v_)(e?.name),1),(0,s.Lk)("li",NI,[(0,s.Lk)("span",_I,(0,n.v_)(Number(e.count.before)||0),1),(0,s.Lk)("span",EI,(0,n.v_)(Number(e?.percent.before)?e?.percent.before+"%":"0"),1)]),(0,s.Lk)("li",wI,[(0,s.Lk)("span",{class:(0,n.C4)(["w20","textLeft",e.isChanged&&"blueText"])},(0,n.v_)(Number(e?.count.after)||0),3),(0,s.Lk)("span",{class:(0,n.C4)(["w50","textLeft",e.isChanged&&"blueText"])},(0,n.v_)(Number(e?.percent.after)?e?.percent.after+"%":"0"),3)])],10,kI)):(0,s.Q3)("",!0)],40,SI)))),128)),(0,s.Lk)("div",RI,[(0,s.Lk)("ul",LI,[TI,(0,s.Lk)("li",PI,[(0,s.Lk)("span",AI,(0,n.v_)(Number(O.value)||0),1),DI]),(0,s.Lk)("li",MI,[(0,s.Lk)("span",xI,(0,n.v_)(Number(B.value)||0),1),KI])])]),K.value?((0,s.uX)(),(0,s.CE)("div",OI,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv mb2",draggable:"true",onDragstart:e=>te(t,e),onDragover:a[2]||(a[2]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>ae(t,e)},["OT"===e?.title?((0,s.uX)(),(0,s.CE)("ul",{key:0,class:"nth1Child",onClick:t=>z(e.id)},[(0,s.Lk)("li",null,(0,n.v_)(e?.name),1),(0,s.Lk)("li",UI,(0,n.v_)(Number(e?.count.before)||0),1),(0,s.Lk)("li",{class:(0,n.C4)(e.isChanged&&"blueText")},(0,n.v_)(Number(e?.count.after)||0),3)],8,FI)):(0,s.Q3)("",!0)],40,BI)))),128))])):(0,s.Q3)("",!0),K.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",$I,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(De(k.value,"nonWbc"),((e,t)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories",onClick:t=>z(e.id)},[(0,s.Lk)("ul",XI,[0===t?((0,s.uX)(),(0,s.CE)("li",GI,"non-WBC")):(0,s.Q3)("",!0),(0,s.Lk)("li",HI,(0,n.v_)(Ee(e.name)),1)]),(0,s.Lk)("ul",VI,[0===t?((0,s.uX)(),(0,s.CE)("li",jI)):(0,s.Q3)("",!0),(0,s.Lk)("li",YI,[(0,s.eW)((0,n.v_)(Number(e?.count.before)||0)+" ",1),"NR"===e?.title||"GP"===e?.title?((0,s.uX)(),(0,s.CE)("span",qI," / "+(0,n.v_)(Number(d.value?.wbcInfo?.maxWbcCount)||0)+" WBC",1)):(0,s.Q3)("",!0)])]),(0,s.Lk)("ul",QI,[0===t?((0,s.uX)(),(0,s.CE)("li",JI)):(0,s.Q3)("",!0),(0,s.Lk)("li",{class:(0,n.C4)(e.isChanged&&"blueText"),style:{cursor:"default"}},[(0,s.eW)((0,n.v_)(Number(e?.count.after)||0)+" ",1),"NR"===e?.title||"GP"===e?.title?((0,s.uX)(),(0,s.CE)("span",zI," / "+(0,n.v_)(Number(d.value?.wbcInfo?.maxWbcCount)||0)+" WBC",1)):(0,s.Q3)("",!0)],2)])],8,WI)),[[l.aG,"0006"!==d.value?.siteCd&&"SM"!==e?.title]]))),128))]))]),L.value?((0,s.uX)(),(0,s.Wv)(at,{key:2,"is-visible":L.value,type:T.value,message:P.value,onHide:je,"onUpdate:hideAlert":je},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),A.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:3,"is-visible":A.value,type:D.value,message:M.value,onHide:he,onOkConfirm:ne},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const ey=ZI;var ty=ey;const ay={class:"reportDiv"},ly={class:"wbcDiv shadowBox"},sy={key:0,class:"rbcDiv shadowBox"},oy={class:"reportDetail shadowBox"},ny={class:"reportTitle"},iy=(0,s.Lk)("span",null,"[Hospital]",-1),ry={class:"reportDivTop"},cy={key:0,class:"reportH3"},uy={key:1,class:"reportH3"},dy={class:"reportTable"},my=(0,s.Lk)("th",null,"Slot ID",-1),vy=(0,s.Lk)("th",null,"Ordered date",-1),py=(0,s.Lk)("th",null,"Signed by ID",-1),gy=(0,s.Lk)("th",null,"Signed date",-1),fy=(0,s.Lk)("th",null,"Patient ID",-1),Iy=(0,s.Lk)("th",null,"Ordered Classification",-1),yy=(0,s.Lk)("th",null,"Name",-1),by=(0,s.Lk)("th",null,"Birth",-1),Cy=(0,s.Lk)("th",null,"Gender",-1),hy={class:"reportH3 mb1 pl0"},Sy={class:"tableClass mt22"},ky=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"40%"}),(0,s.Lk)("col",{width:"20%"}),(0,s.Lk)("col",{width:"20%"})],-1),Ny=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"reportWbcclassificationSmallTitle"},[(0,s.Lk)("th",null,"Class"),(0,s.Lk)("th",null,"Count"),(0,s.Lk)("th",null,"Percent")])],-1),_y=(0,s.Lk)("td",null,"Total",-1),Ey=(0,s.Lk)("td",null,"100.00",-1),wy={key:0,class:"reportH3 mb1 pl0"},Ry={key:1,class:"tableClass"},Ly=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"40%"}),(0,s.Lk)("col",{width:"20%"}),(0,s.Lk)("col",{width:"20%"})],-1),Ty={key:0},Py=(0,s.Lk)("td",null,"-",-1),Ay={key:0,class:"rbcRight"},Dy=(0,s.Lk)("h3",{class:"reportH3 pl0"},"RBC classification result",-1),My={class:"printRbcCategory"},xy={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Ky={style:{cursor:"default"}},Oy={class:"printRbcClass"},By={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Fy={style:{cursor:"default"}},Uy={key:0,style:{cursor:"default"}},$y={key:1,style:{cursor:"default"}},Wy={class:"printRbcDegree"},Xy={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Gy={style:{cursor:"default"}},Hy={key:0,style:{cursor:"default"}},Vy={key:1},jy={class:"printTotalText",style:{cursor:"default"}},Yy={class:"printRbcCount"},qy={key:0,class:"mb1 liTitle",style:{cursor:"default"}},Qy={style:{cursor:"default"}},Jy={key:0,style:{cursor:"default"}},zy={key:1,style:{cursor:"default"}},Zy={class:"printRbcPercent"},eb={key:0,class:"mb1 liTitle",style:{cursor:"default"}},tb={style:{cursor:"default"}},ab={key:0,style:{cursor:"default"}},lb={key:1,style:{cursor:"default"}},sb={style:{cursor:"default"}};var ob=(0,s.pM)({__name:"report",setup(e){const t=e=>e?.name,a=(0,c.Pj)(),i=(0,o.KR)([]),r=(0,o.KR)(null),u=(0,o.KR)(!1),d=(0,o.KR)([]),m=(0,s.EW)((()=>a.state.commonModule.siteCd)),v=(0,s.EW)((()=>a.state.commonModule.cbcLayer)),p=(0,s.EW)((()=>a.state.commonModule.selectedSampleId)),I=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),y=(0,s.EW)((()=>a.state.commonModule.rbcInfoAfterData)),b=((0,s.EW)((()=>a.state.commonModule.classInfoSort)),(0,s.nI)(),(0,o.KR)(!1)),C=(0,o.KR)([]),h=(0,o.KR)(!0),S=["NR","GP","PA","AR","MA","SM"],k=(0,o.KR)([]),N=(0,o.KR)(null),_=(0,o.KR)([]),E=(0,o.KR)(0),w=(0,o.KR)(0),R=(0,o.KR)(0),L=(0,o.KR)(0),T=(0,o.KR)(0),P=(0,o.KR)(0),A=(0,o.KR)(0),D=(0,o.KR)(0),M=(0,o.KR)([]),x=(0,o.KR)(!1);(0,s.KC)((()=>{b.value="bm"===window.PROJECT_TYPE}));const K=e=>{N.value&&!N.value.contains(e.target)&&u.value&&q()};(0,s.sV)((async()=>{await O(),h.value=!1,await z(),await Z(),b.value||(await $(),await ae(),await te(),await F()),document.addEventListener("click",K)})),(0,s.hi)((()=>{document.removeEventListener("click",K)}));const O=async()=>{try{const e=await vu(String(p.value));i.value=e.data,d.value=e.data}catch(e){console.log(e)}},B=()=>{const e=mc.find((e=>"서울성모병원"===e.hospitalNm))?.siteCd===m.value,t=mc.find((e=>"인하대병원"===e.hospitalNm))?.siteCd===m.value;e?i.value.wbcInfoAfter=Eu(i.value?.wbcInfoAfter,i.value?.wbcInfoAfter):t&&(i.value.wbcInfoAfter=_u(i.value,i.value?.wbcInfoAfter)),r.value=i.value.wbcInfoAfter},F=async()=>{const e=await U();T.value=e?.artifact+e?.doubleNormal},U=async()=>{const e=""!==i.value?.img_drive_root_path&&i.value?.img_drive_root_path?i.value?.img_drive_root_path:I.value,t=`${e}/${i.value?.slotId}/03_RBC_Classification/${i.value?.slotId}.json`,a=await Wc({fullPath:t}),l=a.data[0].rbcClassList,s={artifact:0,doubleNormal:0};if(l)return l.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?s.artifact+=1:"DoubleNormal"===t.classNm&&(s.doubleNormal+=1)})),s},$=async()=>{const e=""!==i.value?.img_drive_root_path&&i.value?.img_drive_root_path?i.value?.img_drive_root_path:I.value,t=`${e}/${i.value?.slotId}/03_RBC_Classification/${i.value?.slotId}_new.json`,a=await Wc({fullPath:t}),l=`${e}/${i.value?.slotId}/03_RBC_Classification/${i.value?.slotId}.json`,s=await Wc({fullPath:l});if("not file"!==a.data){const e=a?.data;for(const t of s.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}_.value=s.data[0].rbcClassList}else _.value=s?.data[0].rbcClassList;if(!_.value||!Array.isArray(_.value))return;let o=0,n=0,r=0,c=0;_.value.forEach((e=>{const t=e.classInfo.length>0?(e.classInfo[e.classInfo.length-1].index||"").replace(/[^\d]/g,""):"";switch(e.categoryId){case"01":o=t;break;case"02":n=t;break;case"03":r=t;break;case"05":c=t;break;default:break}})),E.value=Number(o)+1,w.value=Number(o)+1,R.value=n,L.value=Number(r)+Number(c)+2,y.value.forEach((e=>{e.classInfo.forEach((e=>{e.originalDegree=0}))})),_.value.forEach((e=>{const t=y.value.find((t=>t.categoryId===e.categoryId));t&&e.classInfo.forEach((e=>{const a=t.classInfo.find((t=>t.classId===e.classId));a&&a.originalDegree++}))})),await W()},W=async()=>{let e=0,t=0;for(const a of _.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;A.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}D.value=Math.floor(e/parseFloat(A.value)*1e3),P.value=t},X=e=>{const t=(Number(e)/Number(E.value)*100).toFixed(1);return Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t},G=async()=>{await z(),await Z()},H=e=>{const t=V(m.value,i.value?.testType);return!t.includes(e)},V=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},j=async e=>{await O(),await z(),await Z(),b.value||await $()},q=()=>{u.value=!1},Q=()=>b.value?"BM Classification":"WBC Classification",J=e=>{e.stopPropagation(),u.value=!0},z=async()=>{try{const e=await He();e&&(0===e?.data.length?C.value=[]:C.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}};async function Z(e){if(i.value?.wbcInfoAfter&&0!==i.value?.wbcInfoAfter.length){let e=0!==C.value.length?C.value:"bm"===window.PROJECT_TYPE?La:Ra;const t=ee(i.value?.wbcInfoAfter,e);if(k.value=t.filter((e=>S.includes(e.title))),i.value.wbcInfoAfter=t,r.value=t,!k.value||0===k.value.length){const t=ee(i.value?.wbcInfo.wbcInfo[0],e);k.value=t.filter((e=>S.includes(e.title)))}}else{let e=0!==C.value.length?C.value:"bm"===window.PROJECT_TYPE?La:Ra;const t=ee(i.value?.wbcInfo.wbcInfo[0],e);k.value=t.filter((e=>S.includes(e.title))),i.value.wbcInfoAfter=t,r.value=t}await B(),d.value=i.value?.rbcInfoAfter&&0!==i.value?.rbcInfoAfter.length?i.value?.rbcInfoAfter:i.value?.rbcInfo.rbcClass}const ee=(e,t)=>{let a=JSON.parse(JSON.stringify(e));return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),a},te=async()=>{let e=E.value,t=w.value,a=R.value;i.value?.rbcInfoAfter.forEach(((l,s)=>{l.classInfo.forEach(((s,o)=>{M.value&&M.value.forEach((o=>{if(o.categoryId===l.categoryId&&o.classId===s.classId){const l=Number(s.degree);let n=0;n="01"===o.categoryId?Number((l/t*100).toFixed(2)):"02"===o.categoryId?Number((l/a*100).toFixed(2)):Number((l/e*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),i.value.rbcInfoAfter.forEach(((l,s)=>{l.classInfo.forEach(((s,o)=>{M.value&&M.value.forEach((o=>{if(o.categoryId===l.categoryId&&o.classId===s.classId){const l=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((l/t*100).toFixed(2)):"02"===o.categoryId?Number((l/a*100).toFixed(2)):Number((l/e*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),i.value.rbcInfoAfter.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))}))},ae=async()=>{try{const e=await re(),t=e.data;M.value=t}catch(e){console.log(e)}},le=e=>{e&&(x.value=!x.value)};return(e,a)=>{const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Pf,{onRefreshClass:j}),(0,s.Lk)("div",{class:(0,n.C4)("reportSection"+(v.value?" cbcLayer":""))},[v.value?((0,s.uX)(),(0,s.Wv)(aI,{key:0,selectItems:i.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",ay,[(0,s.Lk)("div",ly,[h.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(ty,{key:0,wbcInfo:r.value,selectItems:i.value,type:"report",onClassOrderChanged:G,onSubmitStateChanged:le,isCommitChanged:x.value},null,8,["wbcInfo","selectItems","isCommitChanged"]))]),b.value||"04"!==i.value.testType?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",sy,[h.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(Cg,{key:0,rbcInfo:d.value,selectItems:i.value,type:"report",onSubmitStateChanged:le,isCommitChanged:x.value},null,8,["rbcInfo","selectItems","isCommitChanged"]))])),(0,s.Lk)("div",oy,[(0,s.Lk)("div",ny,[iy,(0,s.eW)(),(0,s.Lk)("span",null,"DM Serial Nbr : "+(0,n.v_)(i.value?.slotId),1),(0,s.bF)(c,{icon:["fas","print"],onClick:J,class:"printStart"})]),(0,s.Lk)("div",ry,[b.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("h3",cy,"Analysis Report from UIMD PB system")),b.value?((0,s.uX)(),(0,s.CE)("h3",uy,"Analysis Report from UIMD BM system")):(0,s.Q3)("",!0),(0,s.Lk)("table",dy,[(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[my,(0,s.Lk)("td",null,(0,n.v_)(i.value?.slotId),1)]),(0,s.Lk)("tr",null,[vy,(0,s.Lk)("td",null,(0,n.v_)((0,o.R1)(Y)(i.value?.orderDttm)),1)]),(0,s.Lk)("tr",null,[py,(0,s.Lk)("td",null,(0,n.v_)(i.value?.submitUserId),1)]),(0,s.Lk)("tr",null,[gy,(0,s.Lk)("td",null,(0,n.v_)(i.value?.submitOfDate),1)]),(0,s.Lk)("tr",null,[fy,(0,s.Lk)("td",null,(0,n.v_)(i.value?.patientId),1)]),(0,s.Lk)("tr",null,[Iy,(0,s.Lk)("td",null,(0,n.v_)(b.value?(0,o.R1)(f)(i.value?.testType):(0,o.R1)(g)(i.value?.testType)),1)]),(0,s.Lk)("tr",null,[yy,(0,s.Lk)("td",null,(0,n.v_)(i.value?.patientName),1)]),(0,s.Lk)("tr",null,[by,(0,s.Lk)("td",null,(0,n.v_)(i.value?.birthDay),1)]),(0,s.Lk)("tr",null,[Cy,(0,s.Lk)("td",null,(0,n.v_)(""===i.value?.gender?"":"01"===i.value?.gender?"Male":"Female"),1)])])])]),(0,s.Lk)("div",{class:(0,n.C4)(["reportDivBottom","04"!==i.value.testType&&"reportDiff"])},[(0,s.Lk)("div",{class:(0,n.C4)(["wbcLeft",b.value&&"wbcLeftBm"])},[(0,s.Lk)("h3",hy,(0,n.v_)(Q())+" result",1),(0,s.Lk)("table",Sy,[ky,Ny,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value.wbcInfoAfter,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:"wbcClassDbDiv"},[H(e.title)?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("td",null,(0,n.v_)(e?.name),1),(0,s.Lk)("td",null,(0,n.v_)(e?.count),1),(0,s.Lk)("td",null,(0,n.v_)(Number(e?.percent)||"0"),1)],64)):(0,s.Q3)("",!0)])))),128)),(0,s.Lk)("tr",null,[_y,(0,s.Lk)("td",null,(0,n.v_)(i.value?.wbcInfo?.totalCount||0),1),Ey])])]),i.value?.wbcInfo?.nonRbcClassList||b.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("h3",wy,"non-WBC")),b.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("table",Ry,[Ly,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.value,((e,a)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,n.v_)(t(e)),1),(0,s.Lk)("td",null,[(0,s.eW)((0,n.v_)(Number(e?.count)||0)+" ",1),"NR"===e?.title||"GP"===e?.title?((0,s.uX)(),(0,s.CE)("span",Ty," /"+(0,n.v_)(i.value?.wbcInfo?.maxWbcCount)+" WBC",1)):(0,s.Q3)("",!0)]),Py],512)),[[l.aG,"0006"!==m.value&&"SM"!==e?.title]]))),128))])]))],2),b.value||"04"!==i.value.testType?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Ay,[Dy,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([y.value],((t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"categories"},[(0,s.Lk)("ul",My,[(0,s.eW)((0,n.v_)(e.type)+" ",1),0===a?((0,s.uX)(),(0,s.CE)("li",xy,"Category")):(0,s.Q3)("",!0),(0,s.Lk)("li",Ky,(0,n.v_)(t?.categoryNm),1)]),(0,s.Lk)("ul",Oy,[0===a?((0,s.uX)(),(0,s.CE)("li",By,"Class")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Fy,(0,n.v_)(e?.classNm),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",Uy," Others ")):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",$y," Malaria ")):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",Wy,[0===a?((0,s.uX)(),(0,s.CE)("li",Xy,"Degree")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Gy,(0,n.v_)(Number(e?.degree)||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",Hy," - ")):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",Vy," - ")):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",jy,"Total",512),[[l.aG,"Shape"!==t.categoryNm]])]),(0,s.Lk)("ul",Yy,[0===a?((0,s.uX)(),(0,s.CE)("li",qy,"Count")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Qy,(0,n.v_)(Number(e?.originalDegree)||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",Jy,(0,n.v_)(Number(T.value)||0),1)):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",zy,(0,n.v_)(Number(P.value)||0),1)):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",{style:{cursor:"default"}},(0,n.v_)(Number(w.value)||0),513),[[l.aG,"Size"===t?.categoryNm||"Chromia"===t?.categoryNm]]),(0,s.bo)((0,s.Lk)("li",{style:{cursor:"default"}},(0,n.v_)(Number(L.value)||0),513),[[l.aG,"Inclusion Body"===t?.categoryNm]])]),(0,s.Lk)("ul",Zy,[0===a?((0,s.uX)(),(0,s.CE)("li",eb,"Percent")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",tb,(0,n.v_)(X(Number(e?.originalDegree))||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",ab,(0,n.v_)(X(T.value)||0),1)):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",lb,(0,n.v_)(X(P.value)||0),1)):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",sb,"100%",512),[[l.aG,"Shape"!==t.categoryNm]])])])))),128))],64)))),128))]))],2)])])],2),(0,s.Lk)("div",{ref_key:"printContent",ref:N},[u.value?((0,s.uX)(),(0,s.Wv)(Cm,{key:0,onPrintClose:q})):(0,s.Q3)("",!0)],512)],64)}}});const nb=ob;var ib=nb,rb=a(2543);const cb={key:0,class:"loaderBackground"},ub=(0,s.Lk)("div",{class:"loader"},null,-1),db=(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1),mb=[ub,db],vb={class:"wbcInfoDbUl"},pb=["onClick","onDrop"],gb={class:"circle"},fb={key:1,class:"cellImgBox"},Ib={key:0},yb={class:"mt1"},bb=["onInput","checked"],Cb=["onDrop"],hb=["onClick","onDblclick","onContextmenu"],Sb={style:{position:"relative"}},kb={key:0,class:"titleImg"},Nb=["src","width","height","onDragstart","onError","onLoad"],_b={key:2,class:"divCompare"},Eb={class:"divCompareChild"},wb=["value"],Rb={class:"cellImgBox"},Lb={class:"mt1"},Tb=["checked"],Pb=["onClick","onDblclick","onContextmenu"],Ab={style:{position:"relative"}},Db={key:0,class:"titleImg"},Mb=["src","width","height","onDragstart","onError"],xb={class:"divCompareChild"},Kb=["value"],Ob={class:"cellImgBox"},Bb={class:"mt1"},Fb=["checked"],Ub=["onClick","onDblclick","onContextmenu"],$b={style:{position:"relative"}},Wb={key:0,class:"titleImg"},Xb=["src","width","height","onDragstart","onError"];var Gb=(0,s.pM)({__name:"ImageGallery",props:{wbcInfo:{},updateWbcInfo:{type:Function},classCompareShow:{type:Boolean},selectedTitle:{},hiddenImages:{},setRef:{type:Function},replaceFileNamePrefix:{type:Function},onDragOver:{type:Function},isBorderChanged:{type:Function},isSelected:{type:Function},totalCount:{},wbcReset:{type:Boolean},slotId:{},iaRootPath:{},projectTypeReturn:{},projectType:{},apiBaseUrl:{},wbcInfoRefresh:{},imageSize:{}},setup(e,{expose:t,emit:a}){const i=(0,o.KR)([]),r=(0,c.Pj)(),u=(0,s.EW)((()=>r.state.commonModule.siteCd)),d=(0,o.KR)(null),m=(0,o.KR)("Neutrophil-Segmented"),v=(0,o.KR)({}),p=(0,o.KR)("Neutrophil-Band"),g=(0,o.KR)(0),f=(0,o.KR)(0),I=(0,o.KR)({}),y=(0,o.KR)([]),b=(0,o.KR)("Neutrophil-Segmented"),C=(0,o.KR)("Neutrophil-Band"),h=(0,o.KR)(!0),S=e=>{const t=i.value[e];t&&t.scrollIntoView({behavior:"smooth"})};t({scrollToElement:S});const k=e,N=a,_=(0,o.KR)([]),{wbcInfo:E,wbcReset:w}=(0,o.QW)(k),R=(0,o.KR)({...k.hiddenImages});(0,s.wB)(k.hiddenImages,(e=>{R.value={...e},h.value=!1}));const L=(0,rb.debounce)((async e=>{const t=Date.now();h.value=!1,_.value=[],_.value=mI(e).map(((e,a)=>({...e,uniqueKey:`item_${a}_${t}`,images:e.images.map(((e,l)=>({...e,uniqueKey:`image_${a}_${l}_${t}`})))||[]}))),_.value?.some((e=>"NE"===e.title))&&(m.value=b.value="Metamyelocyte",p.value=C.value="Myelocyte"),await D("first",null),await D("last",null)}),10);(0,s.wB)(E,L,{deep:!0}),(0,s.wB)((()=>k.wbcReset),(async e=>{if(e){if(k.wbcInfoRefresh)return;_.value=[],await(0,s.dY)(),_.value=k.wbcInfo.map(((e,t)=>({...e,uniqueKey:`item_${t}_${Date.now()}`,images:e.images.map(((e,a)=>({...e,uniqueKey:`image_${t}_${a}_${Date.now()}`})))||[]}))),await(0,s.dY)(),D("first",null),D("last",null)}}));const T=e=>{N("update:cellRef",d),D("first",null),D("last",null),y.value=k.wbcInfo.filter((e=>"0006"!==u.value&&"SM"!==e?.title)),e===k.wbcInfo.length-1||e<k.wbcInfo.length-1?h.value=!1:h.value=!0};function P(e,t,a,l,s){if(!E.value||0===E.value.length)return"";const o=k.slotId||"",n=`${k.iaRootPath}/${o}/${k.projectTypeReturn}/${t}_${a}`;let i="";return i="getImageRealTime"===l||"pb"===k.projectType?`${k.apiBaseUrl}/images/getImageRealTime?folder=${n}&imageName=${e}`:`${k.apiBaseUrl}/images?folder=${n}&imageName=${e}`,i}const A=e=>t=>{t&&(i.value[e]=t)},D=async(e,t)=>{const a=(e,a,l,s)=>{m.value!==p.value?(a.value=t?t.target.value:e.value,l.value=k.wbcInfo.find((t=>t?.name===e.value)),s.value=k.wbcInfo.findIndex((t=>t?.name===e.value))):e.value=a.value};"first"===e?a(m,b,v,g):a(p,C,I,f),"0"===k.totalCount&&(h.value=!1)};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[h.value?((0,s.uX)(),(0,s.CE)("div",cb,mb)):(0,s.Q3)("",!0),(0,s.Lk)("ul",vb,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(_.value,(a=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a.id},["0006"!==u.value&&"SM"!==a?.title?((0,s.uX)(),(0,s.CE)("li",{key:0,onClick:e=>S(a.id),onDragover:t[0]||(t[0]=(0,l.D$)((t=>e.$emit("onDragOverCircle")),["prevent"])),onDrop:t=>e.$emit("onDropCircle",a)},[(0,s.Lk)("div",gb,[(0,s.Lk)("p",null,(0,n.v_)(a?.title),1),(0,s.Lk)("p",null,(0,n.v_)(a?.count),1)])],40,pb)):(0,s.Q3)("",!0)],64)))),128))]),e.classCompareShow?((0,s.uX)(),(0,s.CE)("div",_b,[(0,s.Lk)("div",Eb,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e),onChange:t[3]||(t[3]=e=>D("first",e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.name},(0,n.v_)(e?.name),9,wb)))),128))],544),[[l.u1,m.value]]),(0,s.Lk)("ul",Rb,[(0,s.Lk)("li",null,[(0,s.Lk)("div",null,[(0,s.Lk)("p",Lb,[(0,s.Lk)("input",{type:"checkbox",onInput:t[4]||(t[4]=t=>e.$emit("allCheckChange",t,v.value?.title)),checked:e.selectedTitle===v.value?.title},null,40,Tb),(0,s.Lk)("label",null,(0,n.v_)(v.value?.title)+" ("+(0,n.v_)(v.value?.count)+") ",1)])]),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+v.value?.title),onDragover:t[6]||(t[6]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:t[7]||(t[7]=()=>e.$emit("onDrop",g.value))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.value.images,((o,i)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:o?.fileName},[o&&!R.value[`${v.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(o),"selected-image":e.isSelected(o),wbcImgWrapLi:!0}),onClick:()=>e.$emit("selectImage",g.value,i,v.value),onDblclick:()=>e.$emit("openModal",o,v.value),onContextmenu:(0,l.D$)((t=>e.$emit("handleRightClick",t,o,v.value)),["prevent"])},[(0,s.Lk)("div",Ab,[o?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",Db,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(o.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(o.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(o.fileName)!==v.value?.title]]):(0,s.Q3)("",!0),o&&o.fileName&&!R.value[`${v.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{key:1,src:P(o.fileName,v.value.id,v.value.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:o.filter}),onDragstart:()=>e.$emit("onDragStart",g.value,i),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",v.value.id,o.fileName,v.value.title),onLoad:t[5]||(t[5]=e=>T(g.value))},null,44,Mb)):(0,s.Q3)("",!0),o&&o.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(o.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,Pb)):(0,s.Q3)("",!0)],64)))),128))],34)])])]),(0,s.Lk)("div",xb,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>p.value=e),onChange:t[9]||(t[9]=e=>D("last",e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.name},(0,n.v_)(e?.name),9,Kb)))),128))],544),[[l.u1,p.value]]),(0,s.Lk)("ul",Ob,[(0,s.Lk)("li",null,[(0,s.Lk)("div",null,[(0,s.Lk)("p",Bb,[(0,s.Lk)("input",{type:"checkbox",onInput:t[10]||(t[10]=t=>e.$emit("allCheckChange",t,I.value?.title)),checked:e.selectedTitle===I.value?.title},null,40,Fb),(0,s.eW)(" "+(0,n.v_)(I.value?.title)+" ("+(0,n.v_)(I.value?.count)+") ",1)])]),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+I.value?.title),onDragover:t[12]||(t[12]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:t[13]||(t[13]=()=>e.$emit("onDrop",f.value))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(I.value.images,((o,i)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:o?.fileName},[o&&!R.value[`${I.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(o),"selected-image":e.isSelected(o),wbcImgWrapLi:!0}),onClick:()=>e.$emit("selectImage",f.value,i,I.value),onDblclick:()=>e.$emit("openModal",o,I.value),onContextmenu:(0,l.D$)((t=>e.$emit("handleRightClick",t,o,I.value)),["prevent"])},[(0,s.Lk)("div",$b,[o?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",Wb,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(o.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(o.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(o.fileName)!==I.value?.title]]):(0,s.Q3)("",!0),o&&o.fileName&&!R.value[`${I.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{key:1,src:P(o.fileName,I.value.id,I.value.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:o.filter}),onDragstart:()=>e.$emit("onDragStart",f.value,i),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",I.value.id,o.fileName,I.value.title),onLoad:t[11]||(t[11]=e=>T(f.value))},null,44,Xb)):(0,s.Q3)("",!0),o&&o.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(o.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,Ub)):(0,s.Q3)("",!0)],64)))),128))],34)])])])])):((0,s.uX)(),(0,s.CE)("ul",fb,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(_.value,((o,i)=>((0,s.uX)(),(0,s.CE)("li",{key:o.id,ref_for:!0,ref:A(o.id)},["0"!==o?.count&&0!==o?.count?((0,s.uX)(),(0,s.CE)("div",Ib,[(0,s.Lk)("p",yb,[(0,s.Lk)("input",{type:"checkbox",onInput:t=>e.$emit("allCheckChange",t,o.title),checked:e.selectedTitle===o.title},null,40,bb),(0,s.eW)(" "+(0,n.v_)(o?.title)+" ("+(0,n.v_)(o?.count)+") ",1)])])):(0,s.Q3)("",!0),"0"!==o?.count&&0!==o?.count&&o.images?((0,s.uX)(),(0,s.CE)("ul",{key:1,class:(0,n.C4)("wbcImgWrap "+o?.title),onDragover:t[1]||(t[1]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:()=>e.$emit("onDrop",i)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.images,((t,r)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t.uniqueKey},[t.uniqueKey&&!R.value[`${o.id}-${t.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(t),"selected-image":e.isSelected(t),wbcImgWrapLi:!0}),onClick:()=>e.$emit("selectImage",i,r,o),onDblclick:()=>e.$emit("openModal",t,o),onContextmenu:(0,l.D$)((a=>e.$emit("handleRightClick",a,t,o)),["prevent"])},[(0,s.Lk)("div",Sb,[t?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",kb,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(t.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(t.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(t.fileName)!==o?.title]]):(0,s.Q3)("",!0),t&&t.fileName&&!R.value[`${o.id}-${t.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{key:t.uniqueKey,src:P(t.fileName,o.id,o.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:t.filter}),onDragstart:()=>e.$emit("onDragStart",i,r),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",o.id,t.fileName,o.title),onLoad:e=>T(i)},null,44,Nb)):(0,s.Q3)("",!0),t&&t.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(t.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,hb)):(0,s.Q3)("",!0)],64)))),128))],42,Cb)):(0,s.Q3)("",!0)])))),128))]))],64)}}});const Hb=Gb;var Vb=Hb;const jb={class:"moveImgIsBool"},Yb={class:"wbcContent"},qb={class:"topClintInfo"},Qb={class:"imgMenuSetDiv"},Jb={class:"sizeContainer"},zb=(0,s.Lk)("div",{class:"sizeTitle"},"Size",-1),Zb={class:"customImgSet size"},eC=["value"],tC={class:"imgSetWrap",ref:"imgSetWrap"},aC={class:"imgSet"},lC={class:"customImgSet"},sC={class:"customImgSet rgb"},oC={class:"alignItemsCenter"},nC=(0,s.Lk)("label",null,"R",-1),iC={class:"alignItemsCenter"},rC=(0,s.Lk)("label",null,"G",-1),cC={class:"alignItemsCenter"},uC=(0,s.Lk)("label",null,"B",-1),dC=["onClick"],mC={class:"wbcModalImageContent"},vC=["src"],pC={class:"buttons"},gC={class:"rangeBox"};var fC=(0,s.pM)({__name:"listDetail",setup(e){const t=(0,o.KR)(""),a=(0,o.KR)(null),i=(0,o.KR)(null),r=(0,o.KR)(null),u=(0,c.Pj)(),d=(0,o.KR)(""),m=(0,s.EW)((()=>u.state.userModule)),v=(0,s.EW)((()=>u.state.commonModule.cbcLayer)),p=(0,s.EW)((()=>u.state.commonModule.moveImgIsBool)),I=(0,s.EW)((()=>u.state.commonModule.classInfoSort)),y=(0,o.KR)(u.state.commonModule.iaRootPath),b=(0,s.EW)((()=>u.state.commonModule.siteCd)),C=(0,s.EW)((()=>u.state.commonModule.selectedSampleId)),h=(0,o.KR)(null),S=(0,o.KR)(null),k=(0,o.KR)(!1),N=(0,o.KR)(!1),_=(0,o.KR)(null),E=(0,o.KR)(!1),w=(0,o.KR)(null),R=(0,o.KR)([]),L=(0,o.KR)(null),T=(0,o.KR)([]),P=(0,o.KR)([]),A=[],D=(0,o.KR)(150),M=(0,o.KR)(100),x=(0,o.KR)([0,0,0]),K=(0,o.KR)("ME"),O=(0,o.KR)(""),B=(0,o.KR)(null),F=(0,o.KR)(!1),U=(0,o.KR)(!1),$=(0,o.KR)(""),W=(0,o.KR)("200px"),X=(0,o.KR)("200px"),G=(0,o.KR)(!1),H="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL,V=(0,o.KR)([]),j=(0,o.KR)([]),Y=(0,o.KR)([]),q=((0,s.nI)(),(0,o.KR)("bm")),Q=(0,o.KR)("0.9"),J=(0,o.KR)(200),z=(0,o.KR)([]),Z=(0,o.KR)([]),ee=(0,o.KR)([]),te=(0,o.KR)(!1),ae=(0,o.KR)({}),le=(0,o.KR)(!1),se=(0,o.KR)(0),oe=(0,o.KR)(0),ne=(0,o.KR)(null),ie=(0,o.KR)(!1),re=(0,o.KR)(!1),ce=(0,o.KR)(!0),ue=(0,o.KR)(null),me=(0,o.KR)(!1),ve=(0,o.KR)(""),ge=(0,o.KR)(""),fe=(0,o.KR)(!1),Ie=(0,o.KR)(!0);(0,s.KC)((async()=>{ce.value=!1,q.value=window.PROJECT_TYPE})),(0,s.sV)((async()=>{await be(),a.value=[],window.addEventListener("keydown",ut),window.addEventListener("keyup",mt),document.body.addEventListener("click",ct),await Me(!1,null),document.addEventListener("click",Te),E.value=!0,await Ne(),F.value=!1,await je(!0)})),(0,s.hi)((async()=>{document.addEventListener("click",Te)})),(0,s.wB)(M,(e=>{localStorage.setItem("imgBrightness",String(e))})),(0,s.wB)(D,(e=>{localStorage.setItem("imageSize",String(e))})),(0,s.wB)(x,(e=>{const t=e[0],a=e[1],l=e[2];localStorage.setItem("imageRgb",JSON.stringify([t,a,l]))}),{deep:!0}),(0,s.wB)((()=>p.value),(e=>{e?Su():ku()}));const ye=()=>{const e=J.value;W.value=`${e}px`,X.value=`${e}px`},be=async()=>{try{const e=await pu(String(C.value));r.value=e.data;const t=""!==r.value?.img_drive_root_path&&null!==r.value?.img_drive_root_path&&r.value?.img_drive_root_path?r.value?.img_drive_root_path:u.state.commonModule.iaRootPath;y.value=t}catch(e){console.log(e)}},Ce=e=>{B.value=e.value},he=()=>{re.value=!re.value},Se=e=>Math.floor((e-50)/240*170+30)+"%",ke=e=>Math.floor(240*(e-30)/170+50),Ne=async()=>{const e=localStorage.getItem("imgBrightness"),t=localStorage.getItem("imageRgb"),l=localStorage.getItem("imageSize");t&&(x.value=JSON.parse(t)),e&&(M.value=Number(e)),l&&(D.value=Number(l));const s=x.value[0],o=x.value[1],n=x.value[2];a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(0.9) drop-shadow(0 0 0 rgb(${s}, ${o}, ${n})) brightness(${M.value}%)`,e.width=Number(D.value),e.height=Number(D.value)}))}))},_e=()=>{ie.value=!0},Ee=()=>{ie.value=!1},we=(e,t,a)=>{e.preventDefault(),Pe(e,a)};function Re(e,t,a){ae.value[`${e}-${t}`]=!0}const Le=()=>{te.value=!te.value},Te=e=>{e.target.closest(".imgSetWrap")||(G.value=!1,t.value=""),e.target.closest(".sizeContainer, .sizeButton")||(te.value=!1)};document.addEventListener("click",(e=>{le.value&&(le.value=!1)}));const Pe=(e,t)=>{const a=506,l=window.innerHeight,s=e.clientX,o=e.clientY;le.value=!0;let n=s,i=o;i=o+a>l?o-a:o;const r=200;n+r>window.innerWidth&&(n=window.innerWidth-r),se.value=n,oe.value=i,ne.value=t},Ae=async(e,t)=>{if(!T.value||0===Object.entries(T.value).length)return me.value=!0,ve.value="error",void(ge.value="Please select an image");const l=a.value.find((t=>t.id===e.id));if(ne.value.title===l.title)return me.value=!0,ve.value="error",void(ge.value="Transfer to different classes is the only option available.");await it();const s=a.value[t];if(ne.value){const t=a.value.findIndex((t=>t.id===e.id));await ht(t,T.value,s,a.value[t],!1,"",a.value),le.value=!1}le.value=!1},De=async(e,t)=>{let a=e.slice();a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),e.splice(0,e.length,...a)},Me=async(e,t)=>{a.value=[];try{const l=await de(),s=l.data,o=s.filter((e=>e.abbreviation)),n=sessionStorage.getItem("customClass"),i=JSON.parse(n);i&&i.forEach((e=>{const t=s.find((t=>t.customNum===e.customNum&&t.abbreviation!==e.abbreviation));if(t){if(""===e?.abbreviation)return;const t=`${y.value}/${r.value?.slotId}/${At(q.value)}/${e.customNum}_${e?.abbreviation}`;xf({path:t})}})),sessionStorage.setItem("customClass",JSON.stringify(s)),V.value=s;let c=0!==r.value?.wbcInfoAfter.length?r.value?.wbcInfoAfter:r.value?.wbcInfo.wbcInfo[0];if(0!==o.length)for(const e of o){const{fullNm:t,abbreviation:l,customNum:s}=e,o=`${y.value}/${r.value?.slotId}/${At(q.value)}/${s}_${l}`;await Mf({path:o});const n={id:s,name:t,count:"0",images:[],title:l},i=c.find((e=>e.id==n.id&&e.name===n.name));i||(c.push(n),a.value=c,await _t("notWbcAfterSave"))}else{const e=[],t="bm"===window.PROJECT_TYPE?wa:Ea;c.forEach((a=>{const l=t.find((e=>e.id===a.id));if(!l){const t=`${y.value}/${r.value?.slotId}/${At(q.value)}/${a}_${a?.title}`;xf({path:t}),e.push(a)}})),e.forEach((e=>{const t=c.indexOf(e);t>-1&&c.splice(t,1)})),r.value.wbcInfoAfter=c,a.value=r.value.wbcInfoAfter,await _t()}await xe(),await pt(),await vt(o,e,t)}catch(l){console.log(l)}},xe=async()=>{try{const e=await pe();e&&e?.data&&(j.value=e.data)}catch(e){console.log(e)}};function Ke(e){const t=e.fileName.split("_")[0],a=r.value.wbcInfoAfter.find((e=>"NE"===e.title)),l={NES:a?"NE":"NS",NEB:"NB"},s=Object.keys(l).reduce(((e,t)=>e.replace(t,l[t])),t);return e.title!==s}function Oe(e){const t=r.value.wbcInfoAfter.find((e=>"NE"===e.title)),a={NES:t?"NE":"NS",NEB:"NB"},l=e.split("_")[0],s=Object.keys(a).reduce(((e,t)=>e.replace(t,a[t])),l);return s}const Be=(e,t)=>{U.value=!0,$.value=wt(e.fileName,t.id,t.title,"getImageRealTime")},Fe=()=>{U.value=!1},Ue=e=>{e.target.classList.contains("wbc-modal-content")&&(U.value=!1)},$e=e=>{e.deltaY<0?Xe():Ge()},We=()=>{G.value=!G.value},Xe=()=>{let e=Math.min(parseFloat(W.value)+50,600),t=Math.min(parseFloat(X.value)+50,600);W.value=`${e}px`,X.value=`${t}px`,J.value=Number(e)},Ge=()=>{let e=Math.max(parseFloat(W.value)-50,200),t=Math.max(parseFloat(X.value)-50,200);W.value=`${e}px`,X.value=`${t}px`,J.value=Number(e)};(0,s.wB)(m.value,((e,t)=>{d.value=e.id})),(0,s.wB)((()=>I.value),(async e=>{E.value=!0,await pt();const t=0!==ee.value.length?ee.value:"bm"===window.PROJECT_TYPE?La:Ra;await De(a.value,t)}));const Ve=async e=>{Ie.value=!1,F.value=!1,await be(),Ie.value=!0,await je(!0),re.value=!1,r.value=e;const t=""!==r.value?.img_drive_root_path&&r.value?.img_drive_root_path?r.value?.img_drive_root_path:u.state.commonModule.iaRootPath;y.value=t,await Me(!0,e),await Ne()},je=async e=>{if(e||(F.value=!F.value),F.value){let e="";"pb"===q.value?e=`${y.value}/${r.value?.slotId}/${"01"===r.value.testType||"04"===r.value?.testType?"01_WBC_Classification":"05_BF_Classification"}/${r.value?.slotId}.json`:"bm"===q.value&&(e=`${y.value}/${r.value?.slotId}/${At(q.value)}/${r.value?.slotId}.json`);const t=await Wc({fullPath:e});if(t&&t.success){const e=t.data;a.value.forEach((t=>{0!==t.images.length&&t.images.forEach((t=>{const a=B.value,l=e.find((e=>e?.FILE_NM===t?.fileName));if(l){const e=(a[0]?.width||150)/Number(l.ORG_WIDTH)*100,s=(a[0]?.height||150)/Number(l.ORG_HEIGHT)*100,o=(Number(l.POSX2)-Number(l.POSX1))*(e/100),n=(Number(l.POSY2)-Number(l.POSY1))*(s/100),i=a[0]?.offsetLeft+Number(l.POSX1)*(e/100)+o/2+"px",r=a[0]?.offsetTop+Number(l.POSY1)*(s/100)+n/2+"px";t.coordinates={position:"absolute",left:i,top:r,width:"5px",height:"5px",background:"#10ff00"}}}))}))}}else a.value.forEach((e=>{e.images.forEach((e=>{e.coordinates={display:"none"}}))}))},Ye=(e,a)=>{O.value=e?.target?.checked?a:"",t.value=e?.target?.checked?a:"",qe()},qe=()=>{T.value=[],z.value=[],Z.value=[];for(const e in a.value)if(O.value===a.value[e].title)for(const t in a.value[e].images){const l={id:a.value[e].id,title:a.value[e].title,...a.value[e].images[t]};T.value.push(l),z.value.push(l)}},Qe=e=>{ue.value&&ue.value.scrollToElement(e)};function Je(){x.value=[0,0,0],Q.value="0.9",et("reset")}function ze(){je(!0),D.value=150,a.value.forEach((e=>{e.images.forEach((e=>{e.width=150,e.height=150}))}))}function Ze(){M.value=100,Q.value="0.9",et("reset")}function et(e){const t=K.value;if(!t)return void Je();"reset"!==e&&(Q.value="0.9");const l=x.value[0],s=x.value[1],o=x.value[2];a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(${Q.value}) drop-shadow(0 0 0 rgb(${l}, ${s}, ${o})) brightness(${M.value}%)`}))}))}function tt(e){const t=x.value[0],l=x.value[1],s=x.value[2],o=e?.target?.value;a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(0.9) drop-shadow(0 0 0 rgb(${t}, ${l}, ${s})) brightness(${o}%)`}))}))}function lt(e){const t=Number(e?.target?.value);for(const l of a.value)for(const e of l.images)e.width=t,e.height=t;requestAnimationFrame((()=>je(!0)))}const st=e=>{const t=e.target,a=parseFloat(t.value);isNaN(a)||(D.value=ke(a+1)),requestAnimationFrame((()=>je(!0)))},ot=(0,s.EW)((()=>Se(D.value).replace("%","")));function nt(){}async function it(){A.push(JSON.parse(JSON.stringify(a.value)))}async function rt(e){const t=a.value[w.value];if(e.id!==t.id)if(await it(),0===T.value.length){const l=t.images[L.value];e.images.push(l);const s=JSON.parse(JSON.stringify(a.value)),o=s.findIndex((t=>t.id===e.id));-1!==o?s[o].images.push(l):console.error("일치하는 id를 가진 요소 없음"),await ht(o,[{fileName:l.fileName}],a.value[w.value],s[o],!1)}else{const l=a.value.findIndex((t=>t.id===e.id));await ht(l,T.value,t,a.value[l],!1,"",a.value)}}function ct(e){const t=e.target;t.closest(".wbcImgWrapLi")||t.closest(".context-menu")||(T.value=[],P.value=[],z.value=[])}async function ut(e){e.shiftKey&&(k.value=!0),e.ctrlKey&&(N.value=!0),"Escape"===e.key&&U&&(U.value=!1),"pb"===q.value?e.key&&("01"===r.value?.testType||"04"===r.value?.testType?j.value:Y.value).some((t=>t.key.toUpperCase()===e.key.toUpperCase()))&&await dt(("01"===r.value?.testType||"04"===r.value?.testType?j.value:Y.value).find((t=>t.key.toUpperCase()===e.key.toUpperCase()))):"bm"===q.value&&e.key&&j.value.some((t=>t.key.toUpperCase()===e.key.toUpperCase()))&&await dt(j.value.find((t=>t.key.toUpperCase()===e.key.toUpperCase())))}async function dt(e){const t=a.value.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),l=T.value;await it();const s=[];for(const o of l){const e=a.value.findIndex((e=>(e.title||e.abbreviation)===(o.title||o.abbreviation))),t=a.value[e],l=t.images.findIndex((e=>e.fileName===o.fileName));-1!==l&&s.push({fileName:o.fileName,id:o.id,title:o.title})}s.length>0&&await ht(t,s,l,e,!0,"keyMove")}function mt(e){e.shiftKey||(k.value=!1),e.ctrlKey||(N.value=!1)}async function vt(e,t,l){a.value=[];let s=[];t?(a.value=0!==l.wbcInfoAfter.length?l.wbcInfoAfter:l.wbcInfo.wbcInfo[0],s=l):(a.value=0!==r.value.wbcInfoAfter.length?r.value.wbcInfoAfter:r.value.wbcInfo.wbcInfo[0],s=r.value),s.wbcInfoAfter&&0!==s.wbcInfoAfter.length?(a.value=s.wbcInfoAfter,s.wbcInfo.wbcInfo[0].forEach((e=>{const t=e.title,a=s.wbcInfoAfter.find((e=>e.title===t));a&&a.images.forEach((e=>{e.title=t}))}))):(a.value=s.wbcInfo.wbcInfo[0],s.wbcInfo.wbcInfo[0].forEach((e=>{e.images&&e.images.length>0&&e.images.forEach((t=>{t.title=e.title}))}))),""!==e&&(s.wbcInfo.wbcInfo[0]=s.wbcInfo.wbcInfo[0].filter((t=>!e.find((e=>e.customNum===t.id&&""===e.abbreviation)))));const o=a.value.map((e=>e.id)),n=s.wbcInfo.wbcInfo[0].filter((e=>!o.includes(e.id)));a.value=[...a.value,...n];const i=ee.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),c=0!==ee.value.length?i:"bm"===window.PROJECT_TYPE?wa:Ea;await De(a.value,c),await Pt()}const pt=async()=>{try{const e=await He();e&&(0===e?.data.length?ee.value=[]:ee.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.log(e)}};function gt(){}function ft(e,t){h.value=e,S.value=t,L.value=t,w.value=e,R.value.push(e)}function It(e,l,s){if(k.value){if(null!==_.value){P.value.push(l);const o=Math.min(_.value,l),n=Math.max(_.value,l);T.value=[],z.value=[];for(let t=o;t<=n;t++)T.value.push({id:a.value[e].id,title:a.value[e].title,...a.value[e].images[t]}),z.value.push(s);z.value.length===n-o+1&&(t.value=a.value[0].title)}}else{_.value=l;const t=a.value[e].images[l];if(!N.value)return T.value=[],z.value=[],T.value.push({...t,id:a.value[e].id}),void z.value.push(s);const o=T.value.findIndex((e=>e.fileName===t.fileName));-1===o?(T.value.push({...t,id:a.value[e].id}),z.value.push(s)):(T.value.splice(o,1),z.value.splice(o,1))}}function yt(e){const t=e.fileName;return T.value.some((e=>e.fileName===t))}async function bt(e){if(await it(),0===T.value.length)return await Ct(e);await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0});const l=[],s=[],o=[];let n=!1,i="";for(const r of T.value){const n=r.fileName,c=a.value.findIndex((e=>e.images.some((e=>e.fileName===n))));if(-1===c){console.error(`Dragged item with image ${n} not found`);continue}const u=a.value[c];u.id!==a.value[e].id?(l.push({fileName:r.fileName}),s.push(u),o.push(a.value[e]),i=i||r.keyMove||""):t.value=""}l.length>0&&await ht(e,l,s,o[0],n,i),await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1}),T.value=[],z.value=[],P.value=[]}async function Ct(e){if(null!==h.value&&null!==S.value&&h.value!==e){const t=a.value[h.value],l=t.images[S.value];await ht(e,[{fileName:l.fileName}],t,a.value[e],!1)}}async function ht(e,l,s,o,n,i,c){E.value=!1;const{slotId:d}=r.value,m=l;let v=[],p=[],g=[],f=0;for(const t of m){const e=t.fileName;g.push(e);try{if("keyMove"===i){const e=o.id<10?`0${o.id}`:o.id,a="bm"===window.PROJECT_TYPE?wa:Ea,l=a.find((e=>e.abbreviation===(t.title||t.abbreviation))),i=n?`${y.value}/${d}/${At(q.value)}/${l?.id}_${t.title}`:`${y.value}/${d}/${At(q.value)}/${l?.id}_${s[f].title}`,r=`${y.value}/${d}/${At(q.value)}/${e}_${o.abbreviation}`;p.push(r),v.push(i)}else if(!c&&"keyMove"!==i){let e;e=s[f]?s[f]:s;const a=n?`${y.value}/${d}/${At(q.value)}/${t.id}_${t.title}`:`${y.value}/${d}/${At(q.value)}/${e.id}_${e.title}`,l=`${y.value}/${d}/${At(q.value)}/${o.id}_${o.title}`;p.push(l),v.push(a)}}catch(b){console.error("Error during image move:",b)}f++}const I={sourceFolders:v,destinationFolders:p,fileNames:g};try{const t=await Eg(I);if(await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0}),t){let t=0;for(const l of m){const o=l.fileName;if("keyMove"===i){const t=a.value.findIndex((e=>e.title===(l.title||l.abbreviation))),s=a.value[t],n=s.images.findIndex((e=>e.fileName===o));if(-1!==n){const t=s.images.splice(n,1)[0];t.title=a.value[e].title,t.width=D.value,t.height=D.value,a.value[e].images.push(t),s.count--,a.value[e].count++}}else{let n=[];n=s[t]?s[t]:s;const i=n.images.findIndex((e=>e.fileName===o));-1!==i&&n.images.splice(i,1);const r=a.value.findIndex((e=>e.title===n.title));a.value[r]=n;const c={width:D.value,height:D.value};a.value[e].images.push({...l,...c}),a.value=kt(a.value),a.value.forEach((e=>{e.count=e.images.length,e.images.length>0&&e.images.forEach((t=>{t.title=e.title}))}))}t++}T.value=[],z.value=[],P.value=[],await _t()}else console.error("이미지 옮기기 실패.")}catch(b){console.error("이미지 옮기는 작업 서버 실패:",b)}finally{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1})}if(c)try{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0});for(const e of z.value){const t="bm"===window.PROJECT_TYPE?wa:Ea,a=t.find((t=>t.abbreviation===(e.title||e.abbreviation))),l=`${y.value}/${d}/${At(q.value)}/${a?.id}_${e.title}`,s=`${y.value}/${d}/${At(q.value)}/${o.id}_${o.title}`;p.push(s),v.push(l)}const t={sourceFolders:v,destinationFolders:p,fileNames:g};let s=await Eg(t);if(s){const t=a.value[e];for(const e of St(z.value,"title")){const s=l.filter((t=>t.title===(e.title||e.abbreviation)));t.images.push(...s),t.count=t.images.length;const o=a.value.findIndex((t=>t.title===(e.title||e.abbreviation)));if(-1!==o){const e=a.value[o],t=l.map((e=>e.fileName)),s=e.images.filter((e=>!t.includes(e.fileName)));e.images=s,e.count=e.images.length}}for(const s of l)s.title=a.value[e].title,s.width=D.value,s.height=D.value}else console.error("이미지 움직임 실패.")}catch(b){console.error("서버 이미지 옮기기 실패:",b)}finally{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1})}T.value=[],z.value=[],P.value=[],O.value="",t.value="",await _t()}function St(e,t){const a=new Set;return e.filter((e=>{const l=e[t];return!a.has(l)&&(a.add(l),!0)}))}function kt(e){const t=new Set;return e.map((e=>{const a=e.images.filter((e=>!t.has(e.fileName)&&(t.add(e.fileName),!0)));return{...e,images:a}}))}const Nt=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","MA","SM","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2};async function _t(e){let t=[],l=JSON.parse(JSON.stringify(a.value)),s=0;l.forEach((e=>{if("bm"===q.value)"OT"!==e.title&&(s+=Number(e.count));else{const t=Nt(b.value,r.value?.testType);t.includes(e.title)||(s+=Number(e.count))}})),l.forEach((e=>{if(e.images.forEach((e=>{delete e.width,delete e.height,delete e.filter})),"bm"===q.value){if("OT"!==e.title){const t=(Number(e.count)/Number(s)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}else{const t=Nt(b.value,r.value?.testType);if(!t.includes(e.title)){const t=(Number(e.count)/Number(s)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}}));let o=[];const n=l.map((e=>{const t=e.images.filter((e=>!o.includes(e.fileName)&&(o.push(e.fileName),!0)));return{...e,images:t}}));if(l=n,"notWbcAfterSave"!==e){r.value.wbcInfoAfter=l,await u.dispatch("commonModule/setCommonInfo",{selectedSampleId:r.value?.id}),a.value=l;const e=await pu(String(r.value?.id));e&&(e.data.wbcInfoAfter=l),t=[e.data]}await Et(l,t)}async function Et(e,t){try{const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:o,searchText:n,nrCount:i,testType:r,wbcInfo:c,wbcTotal:u}=JSON.parse(e),m=a+l+o+n+i+r+c+u,v=await uu({userId:Number(d.value),runingInfoDtoItems:t,dayQuery:m});if(v&&0!==v?.data.length){F.value&&await je(!0),c.value=[],c.value=v.data[0].wbcInfoAfter;const e=0!==ee.value.length?ee.value:"bm"===window.PROJECT_TYPE?La:Ra;await De(c.value,e),fe.value=!0,await(0,s.dY)(),fe.value=!1}else console.error("백엔드가 디비에 저장 실패함")}catch(a){console.error("Error:",a)}}function wt(e,t,l,s,o){if(!a.value||0===a.value.length)return"";const n=r.value?.slotId||"";let i=`${y.value}/${n}/${At(q.value)}/${t}_${l}`,c="";return c="getImageRealTime"===s||"pb"===q.value?`${H}/images/getImageRealTime?folder=${i}&imageName=${e}`:`${H}/images?folder=${i}&imageName=${e}`,c}async function Rt(){if(A.length<=0)return;const e=A.pop();h.value=null,S.value=null,w.value=null,R.value=[],L.value=null,T.value=[],z.value=[],P.value=[],await Tt(a.value,e),a.value=e}const Lt=(e,t,a)=>{e.forEach(((e,l)=>{const s=t[l];e&&s&&e.images.forEach(((e,t)=>{const o=s.images[t];void 0===o&&a.push({itemIndex:l,imageIndex:t,fileName:e.fileName,title:s.title,id:s.id})}))}))};async function Tt(e,t){const l=[],s=[];Lt(e,t,l),Lt(t,e,s);let o=[],n=[],c=[];for(const a in l){const e=`${y.value}/${r.value?.slotId}/${At(q.value)}/${l[a].id}_${l[a].title}`,t=`${y.value}/${r.value?.slotId}/${At(q.value)}/${s[a].id}_${s[a].title}`;o.push(e),n.push(t),c.push(l[a].fileName)}const u={sourceFolders:o,destinationFolders:n,fileNames:c};let d=await Eg(u);d&&(a.value=t),i.value=a.value;const m=ee.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),v=0!==ee.value.length?m:"bm"===window.PROJECT_TYPE?wa:Ea;await De(a.value,v),await _t()}const Pt=async()=>{try{const e=`${y.value}/${r.value.slotId}/${At(q.value)}`,t=await fetch(`${H}/folders/check-and-move-images`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderPath:e,wbcInfo:a.value})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);await t.json()}catch(e){console.error("Error:",e)}},At=e=>"bm"===e?"04_BM_Classification":"pb"===e?"01_WBC_Classification":void 0,Dt=()=>{me.value=!1};return(e,c)=>{const u=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",jb," Moving image...",512),[[l.aG,p.value]]),(0,s.bF)(Pf,{onRefreshClass:Ve,isNext:ie.value,onIsNextFalse:Ee},null,8,["isNext"]),(0,s.Lk)("div",Yb,[(0,s.Lk)("div",qb,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,(0,n.v_)("bm"===q.value?(0,o.R1)(f)(r.value?.testType):(0,o.R1)(g)(r.value?.testType)),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.barcodeNo),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.patientId||"patientId No Data"),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.cbcPatientNo),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.patientName),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.cbcPatientNm)+" "+(0,n.v_)(r.value?.cbcSex)+" "+(0,n.v_)(r.value?.cbcAge),1),(0,s.Lk)("li",null,(0,n.v_)(r.value?.analyzedDttm),1)])]),v.value?((0,s.uX)(),(0,s.Wv)(aI,{key:0,selectItems:r.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcRight shadowBox"+(v.value?" cbcLayer":""))},[ce.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(ty,{key:0,wbcInfo:a.value,selectItems:r.value,classCompareShow:re.value,type:"listTable",onNextPage:_e,onScrollEvent:Qe},null,8,["wbcInfo","selectItems","classCompareShow"]))],2),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcLeft"+(v.value?" cbcLayer":""))},[(0,s.Lk)("div",Qb,[(0,s.Lk)("button",{type:"button",onClick:c[0]||(c[0]=e=>je(!1))},[(0,s.bF)(u,{icon:F.value?["fas","toggle-on"]:["fas","toggle-off"]},null,8,["icon"]),(0,s.eW)(" Cell Marking ")]),(0,s.Lk)("button",{onClick:Le,class:"sizeButton"},[(0,s.bF)(u,{icon:["fas","plus-minus"]}),(0,s.eW)(" Size ")]),(0,s.bo)((0,s.Lk)("div",Jb,[(0,s.Lk)("div",null,[zb,(0,s.Lk)("div",Zb,[(0,s.Lk)("input",{type:"number",value:ot.value,onInput:st},null,40,eC)]),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"290","onUpdate:modelValue":c[1]||(c[1]=e=>D.value=e),onInput:lt},null,544),[[l.Jo,D.value]]),(0,s.Lk)("button",{class:"resetBtn mb1",onClick:ze},"Size Reset")])],512),[[l.aG,te.value]]),(0,s.Lk)("div",tC,[(0,s.Lk)("button",{onClick:We},[(0,s.bF)(u,{icon:["fas","gear"]}),(0,s.eW)(" IMG Setting ")]),(0,s.bo)((0,s.Lk)("div",aC,[(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","sun"]}),(0,s.eW)(" Brightness "),(0,s.Lk)("div",lC,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[2]||(c[2]=e=>M.value=e),onInput:tt},null,544),[[l.Jo,M.value]])]),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"120","onUpdate:modelValue":c[3]||(c[3]=e=>M.value=e),onInput:tt},null,544),[[l.Jo,M.value]]),(0,s.Lk)("button",{class:"resetBtn mb2",onClick:Ze},"Brightness Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","palette"]}),(0,s.eW)(" RGB "),(0,s.Lk)("div",sC,[(0,s.eW)(" [ "),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[4]||(c[4]=e=>x.value[0]=e),onInput:c[5]||(c[5]=e=>et(""))},null,544),[[l.Jo,x.value[0]]]),(0,s.eW)(", "),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[6]||(c[6]=e=>x.value[1]=e),onInput:c[7]||(c[7]=e=>et(""))},null,544),[[l.Jo,x.value[1]]]),(0,s.eW)(", "),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[8]||(c[8]=e=>x.value[2]=e),onInput:c[9]||(c[9]=e=>et(""))},null,544),[[l.Jo,x.value[2]]]),(0,s.eW)(" ] ")]),(0,s.Lk)("div",oC,[nC,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[10]||(c[10]=e=>x.value[0]=e),onInput:c[11]||(c[11]=e=>et(""))},null,544),[[l.Jo,x.value[0]]])]),(0,s.Lk)("div",iC,[rC,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[12]||(c[12]=e=>x.value[1]=e),onInput:c[13]||(c[13]=e=>et(""))},null,544),[[l.Jo,x.value[1]]])]),(0,s.Lk)("div",cC,[uC,(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[14]||(c[14]=e=>x.value[2]=e),onInput:c[15]||(c[15]=e=>et(""))},null,544),[[l.Jo,x.value[2]]])]),(0,s.Lk)("button",{class:"resetBtn",onClick:Je},"RGB Reset")])],512),[[l.aG,G.value]])],512),(0,s.Lk)("button",{onClick:he},[(0,s.bF)(u,{icon:["fas","code-compare"]}),(0,s.eW)(" Class Compare ")]),(0,s.Lk)("button",{onClick:Rt,class:"rollbackButton"},[(0,s.bF)(u,{icon:["fas","rotate-left"]}),(0,s.eW)(" Rollback ")])]),(0,s.Lk)("div",null,[Ie.value?((0,s.uX)(),(0,s.Wv)(Vb,{key:0,ref_key:"$imageGalleryRef",ref:ue,wbcInfoRefresh:E.value,wbcInfo:a.value,wbcReset:fe.value,totalCount:r.value?.wbcInfo?.totalCount,slotId:r.value?.slotId,iaRootPath:y.value,projectTypeReturn:At(q.value),projectType:q.value,apiBaseUrl:(0,o.R1)(H),classCompareShow:re.value,selectedTitle:t.value,hiddenImages:ae.value,replaceFileNamePrefix:Oe,onDragOver:gt,isBorderChanged:Ke,isSelected:yt,imageSize:D.value,updateWbcInfo:i.value,onAllCheckChange:Ye,onSelectImage:It,onOpenModal:Be,onHideImage:Re,onHandleRightClick:we,onOnDrop:bt,onOnDragStart:ft,onOnDropCircle:rt,onOnDragOverCircle:nt,onScrollToElement:Qe,cellRef:B.value,"onUpdate:cellRef":Ce},null,8,["wbcInfoRefresh","wbcInfo","wbcReset","totalCount","slotId","iaRootPath","projectTypeReturn","projectType","apiBaseUrl","classCompareShow","selectedTitle","hiddenImages","imageSize","updateWbcInfo","cellRef"])):(0,s.Q3)("",!0)]),le.value?((0,s.uX)(),(0,s.CE)("div",{key:0,style:(0,n.Tr)({top:oe.value+"px",left:se.value+"px"}),class:"context-menu detail"},[(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,onClick:a=>Ae(e,t)},(0,n.v_)(e.name),9,dC)))),128))])],4)):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",{class:"wbcModal",onWheel:$e},[(0,s.Lk)("div",{class:"wbc-modal-content",onClick:Ue},[(0,s.Lk)("span",{class:"wbcClose",onClick:Fe},"×"),(0,s.Lk)("div",mC,[(0,s.Lk)("img",{src:$.value,style:(0,n.Tr)({width:W.value,height:X.value}),class:"modal-image",ref:"modalImage"},null,12,vC)]),(0,s.Lk)("div",pC,[(0,s.Lk)("div",gC,[(0,s.Lk)("p",null,(0,n.v_)(((J.value-200)/400*100).toFixed(0))+" %",1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"200",max:"600","onUpdate:modelValue":c[16]||(c[16]=e=>J.value=e),onInput:ye},null,544),[[l.Jo,J.value]])])])])],544),[[l.aG,U.value]])],2)]),me.value?((0,s.uX)(),(0,s.Wv)(at,{key:0,"is-visible":me.value,type:ve.value,message:ge.value,onHide:Dt,"onUpdate:hideAlert":Dt},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const IC=fC;var yC=IC;const bC=(0,s.Lk)("div",{id:"viewerSmall"},null,-1),CC={class:"leftImgList"},hC={class:"leftImgUl"},SC=(0,s.Lk)("p",null,"Partical Image",-1),kC=["src","onDblclick"],NC={class:"leftImgUl"},_C=(0,s.Lk)("p",null,"Ideal Zone",-1),EC=["src","onDblclick"],wC={class:"leftImgUl"},RC=(0,s.Lk)("p",null,"Ideal Stitch",-1),LC=["src","onDblclick"],TC=(0,s.Lk)("p",null,"Megakaryocyte",-1),PC=["src","onDblclick"];var AC=(0,s.pM)({__name:"leftImgList",props:["selectItems"],setup(e){const t=e,a=(0,c.Pj)(),l=window.APP_API_BASE_URL||"http://192.168.0.131:3002",n=(0,o.KR)([]),i=(0,o.KR)([]),r=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)([]),m=(0,o.KR)([]),v=(0,o.KR)([]),p=(0,o.KR)([]),g=["02_Particle_Image","03_Cell_Ideal_Image","04_Cell_Ideal_Stitch_Image","05_Mega_Image"],f=(0,o.KR)(!1);let I=null;(0,s.EW)((()=>a.state.commonModule.iaRootPath));(0,s.sV)((async()=>{await C()})),(0,s.wB)((()=>t.selectItems),(async()=>{await C()}));const y=async e=>{const a=t.selectItems?.slotId||"",s=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),o=`${s}/${a}/${e}`,n=`${l}/folders?folderPath=${o}`,i=await fetch(n),r=await i.json();return r.some((e=>e.endsWith("_files")))},b=async(e,a)=>{let s;const o=t.selectItems?.slotId||"",n=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath");let i="";switch(a){case"particle":s=`02_Particle_Image/${e}/10`,i=await y("02_Particle_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${s}/0_0.jpg`:"02_Particle_Image/Thumb";break;case"idealZone":i=await y("03_Cell_Ideal_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/03_Cell_Ideal_Image/${e}`:"03_Cell_Ideal_Image";break;case"idealStitch":s=`04_Cell_Ideal_Stitch_Image/${e}/10`,i=await y("04_Cell_Ideal_Stitch_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${s}/0_0.jpg`:"04_Cell_Ideal_Stitch_Image";break;case"mega":i=await y("05_Mega_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/05_Mega_Image/${e}`:"05_Mega_Image";break;default:break}return i.includes(l)?i:`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${i}/${e}`},C=async()=>{const e=t.selectItems?.slotId||"",a=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath");for(const t of g)try{const s=await Z.A.get(`${l}/folders?folderPath=${a}/${e}/${t}`);switch(t){case"02_Particle_Image":n.value=await y("02_Particle_Image")?s.data.filter((e=>!e.includes(".dzi"))).slice(0,7):s.data.filter((e=>"Thumb"!==e)).slice(0,7),d.value=await Promise.all(n.value.map((e=>b(e,"particle"))));break;case"03_Cell_Ideal_Image":i.value=s.data.filter((e=>"Thumb"!==e)).slice(0,14),m.value=await Promise.all(i.value.map((e=>b(e,"idealZone"))));break;case"04_Cell_Ideal_Stitch_Image":r.value=await y("04_Cell_Ideal_Stitch_Image")?s.data.filter((e=>!e.includes(".dzi"))).slice(0,7):s.data.filter((e=>"Thumb"!==e)),v.value=await Promise.all(r.value.map((e=>b(e,"idealStitch"))));break;case"05_Mega_Image":u.value=s.data.filter((e=>"Thumb"!==e)),p.value=await Promise.all(u.value.map((e=>b(e,"mega"))));break}}catch(s){console.error("Error:",s)}},h=async(e,a,l,s)=>{I&&I.destroy();let o={};if("03_Cell_Ideal_Image"!==a&&await l){const e=t.selectItems?.slotId||"",l=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),n=`${l}/${e}/${a}`,i=await k(n);o=i[s]}else o={type:"image",url:e};I=Sg()({id:"viewerSmall",element:document.getElementById("viewerSmall"),tileSources:o,defaultZoomLevel:.2,navigator:!1,minZoomLevel:.2,maxZoomLevel:2,showZoomControl:!1,showHomeControl:!1,showFullScreenControl:!1,showRotationControl:!1,showFullPageControl:!1}),f.value=!0,I.addHandler("open",(function(){const e=I.source.dimensions.x,t=I.source.dimensions.y,a=document.getElementById("viewerSmall"),l=a.clientWidth,s=t/e,o=l*s;a.style.position="fixed",a.style.height=`${o}px`,a.style.width="100%",a.style.left="0",a.style.background="#00000061"})),I.addHandler("canvas-click",(e=>{e.preventDefaultAction=!0}))},S=()=>{if(I){I.destroy();const e=document.getElementById("viewerSmall");e&&(e.innerHTML="",e.style.background="none",e.style.height="0",e.style.width="0",e.removeEventListener("click",S)),I=null,f.value=!1}},k=async e=>{const t=`${l}/folders?folderPath=${e}`,a=await fetch(t);if(!a.ok)throw new Error("Network response was not ok");const s=await a.json(),o=[];for(const n of s)if(n.endsWith("_files")){const t=N(n),{width:a,height:s,tileSize:i}=await _(t,e);o.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${l}/folders?folderPath=${e}/${n}/`,Format:"jpg",Overlap:"1",TileSize:i,Size:{Width:a,Height:s}}})}return o},N=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e},_=async(e,t)=>{const a=`${t}/${e}.dzi`,l=await Xc({filePath:a});return await E(`${e}`,l)},E=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[f.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"closeViewer",onClick:S},"x")):(0,s.Q3)("",!0),bC,(0,s.Lk)("div",CC,[(0,s.Lk)("ul",hC,[SC,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:d.value[t],alt:"Partical Image",onDblclick:e=>h(d.value[t],"02_Particle_Image",y("02_Particle_Image"),t)},null,40,kC)])))),128))]),(0,s.Lk)("ul",NC,[_C,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi",style:{width:"100px"}},[(0,s.Lk)("img",{src:m.value[t],onDblclick:e=>h(m.value[t],"03_Cell_Ideal_Image",y("03_Cell_Ideal_Image"),t)},null,40,EC)])))),128))]),(0,s.Lk)("ul",wC,[(0,s.Lk)("div",null,[RC,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:v.value[t],onDblclick:e=>h(v.value[t],"04_Cell_Ideal_Stitch_Image",y("04_Cell_Ideal_Stitch_Image"),t)},null,40,LC)])))),128))]),(0,s.Lk)("div",null,[TC,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:p.value[t],onDblclick:e=>h(p.value[t],"05_Mega_Image",y("05_Mega_Image"),t)},null,40,PC)])))),128))])])])],64))}});const DC=AC;var MC=DC;const xC={class:"tilingViewerContainer",style:{height:"100%"},id:"tiling-container"};var KC=(0,s.pM)({__name:"tilingViewer",props:["selectItems"],setup(e){const t=e,a=(0,c.Pj)(),l=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),i=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),r="viewer"===i.value?window.MAIN_API_IP:window.APP_API_BASE_URL,u=(0,o.KR)(null),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,o.KR)("85vh");let p=null;(0,s.sV)((async()=>{const e="PMC_Result",{width:t,height:a}=await I(e);d.value=a,m.value=t,v.value=`${Math.min(a/window.innerHeight*100,85)}vh`,await g(a,!1)})),(0,s.wB)((()=>t.selectItems),(async e=>{await(0,s.dY)();const t="PMC_Result",{width:a,height:l}=await I(t);d.value=l,m.value=a,await g(l,!1)})),(0,s.wB)((()=>window.innerHeight),(()=>{v.value=`${Math.min(Number(d.value)/window.innerHeight*100,85)}vh`}));const g=async(e,a)=>{p&&p.destroy();const l=t.selectItems?.slotId||"",s=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),o=`${s}/${l}/01_Stitching_Image`;try{const e=await f(o);p=Sg()({id:"tiling-viewer",animationTime:.4,navigatorSizeRatio:.25,showNavigator:!0,sequenceMode:!0,defaultZoomLevel:1,prefixUrl:`${r}/folders?folderPath=D:/UIMD_Data/Res/uimdFe/images/`,tileSources:e,gestureSettingsMouse:{clickToZoom:!1}}),p.addHandler("open",(function(){p.source.dimensions.x,p.source.dimensions.y;const e=document.getElementById("tiling-viewer"),t=e.clientWidth;e.style.width=`${t}px`,e.style.position="absolute",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)"})),p.addHandler("zoom",(function(){const e=document.getElementById("tiling-viewer");a&&e&&(e.style.height="80vh")}))}catch(n){console.error("Error:",n)}},f=async e=>{const t=`${r}/folders?folderPath=${e}`,a=await fetch(t);if(!a.ok)throw new Error("Network response was not ok");const l=await a.json(),s=[];for(const o of l)if(o.endsWith("_files")){const t=b(o),{width:a,height:l,tileSize:n}=await I(t);s.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${r}/folders?folderPath=${e}/${o}/`,Format:"jpg",Overlap:"1",TileSize:n,Size:{Width:a,Height:l}}})}return s},I=async e=>{const a=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:l.value,s=`${a}/${t.selectItems.slotId}/01_Stitching_Image/${e}.dzi`,o=await Xc({filePath:s});return await y(`${e}`,o)},y=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}},b=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",xC,[(0,s.Lk)("div",{ref_key:"tilingViewerLayer",ref:u,id:"tiling-viewer",style:(0,n.Tr)({height:v.value})},null,4)]))}});const OC=KC;var BC=OC;const FC={class:"imgContent"},UC={class:"wrap-whole"},$C={class:"leftWhole"};var WC=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.commonModule.selectedSampleId)),l=(0,o.KR)(null),n=(0,o.KR)(!1),i=(0,o.KR)(null),r=(0,o.KR)(null);(0,s.KC)((async()=>{await u()})),(0,s.sV)((async()=>{i.value=document.querySelector(".img")}));const u=async()=>{try{n.value=!0;const e=await vu(String(a.value));l.value=e.data,n.value=!1}catch(e){console.log(e),l.value=null,n.value=!1}},d=async e=>{l.value=e};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Pf,{onRefreshClass:d}),(0,s.Lk)("div",FC,[(0,s.Lk)("div",UC,[(0,s.Lk)("div",{ref_key:"imageContainer",ref:r,class:"image-container"},[n.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(BC,{key:0,selectItems:l.value},null,8,["selectItems"]))],512),(0,s.Lk)("div",$C,[n.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(MC,{key:0,selectItems:l.value},null,8,["selectItems"]))])])])],64))}});const XC=WC;var GC=XC;const HC=(0,r.aE)({history:(0,r.LA)(),routes:[{path:"/analysis",name:"AnalysisView",component:ms},{path:"/user/join",name:"join",component:xs},{path:"/user/login",name:"login",component:lo},{path:"/setting",name:"setting",component:iu},{path:"/database",name:"database",component:Gp},{path:"/databaseDetail",name:"databaseDetail",component:yC},{path:"/databaseWhole",name:"databaseWhole",component:GC},{path:"/databaseRbc",name:"databaseRbc",component:iI},{path:"/report",name:"report",component:ib}]});HC.beforeEach((async(e,t,a)=>{const l=sessionStorage.getItem("user"),o=JSON.parse(l||"{}"),n=(0,c.Pj)(),i=(0,s.EW)((()=>n.state.commonModule.settingChangedChecker)),r=n.state.userModule;if("/setting"===t.path){const t=(0,s.EW)((()=>n.state.commonModule.beforeSettingFormattedString)),l=(0,s.EW)((()=>n.state.commonModule.afterSettingFormattedString));t.value===l.value?(await n.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await n.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),await n.dispatch("commonModule/setCommonInfo",{enteringRouterPath:""}),await n.dispatch("commonModule/setCommonInfo",{settingType:""}),a()):(await n.dispatch("commonModule/setCommonInfo",{settingChangedChecker:!i.value}),await n.dispatch("commonModule/setCommonInfo",{enteringRouterPath:e.path}),a(!1))}"login"===e.name||"join"===e.name||o.userId||r.userId?"database"===e.name?(n.dispatch("commonModule/setCommonInfo",{dataBasePageReset:!0}),a()):a():a("/user/login")}));var VC=HC;const jC={class:"header"},YC={class:"borderLine"},qC=(0,s.Lk)("img",{src:i,class:"headerLogo"},null,-1),QC={class:"logoProjectTitle"},JC=(0,s.Lk)("span",{class:"icoText"},"Setting",-1),zC=(0,s.Lk)("span",{class:"icoText"},"Analysis",-1),ZC=(0,s.Lk)("span",{class:"icoText"},"Database",-1),eh={class:"small-icon-menu"},th={class:"lastMenu"},ah={class:"lastLiM"},lh={class:"iconHeaderMenu"},sh={class:"alarm"},oh=["title"],nh=["title"],ih=(0,s.Lk)("h2",null,"Immersion Oil",-1),rh={class:"immersionOilContainer"},ch=(0,s.Lk)("h5",{class:"modalTitle mb1"},"Immersion Oil count Reset",-1),uh=(0,s.Lk)("span",{class:"grayText"},"Reset Immersion Oil count after changing Oil pack",-1),dh={class:"flexSpaceBetween alignItemsCenter mt1"},mh=(0,s.Lk)("span",null,"Estimated number of slides left",-1),vh={class:"f18"},ph={class:"flexColumnAlignEnd"},gh={class:"mt2"},fh=(0,s.Lk)("h5",{class:"modalTitle mb1"},"Prime Immersion Oil",-1),Ih=(0,s.Lk)("span",{class:"grayText mt1"},"Prime oil to remove air from the oil hose",-1),yh={class:"flexColumnAlignEnd"},bh=(0,s.Lk)("div",{class:"statusBarWrapper"},null,-1);var Ch=(0,s.pM)({__name:"AppHeader",setup(e){const t=(0,r.lq)(),a=(0,o.KR)(!1),i=(0,c.Pj)(),u=sessionStorage.getItem("user"),d=JSON.parse(u||"{}"),m=(0,s.EW)((()=>i.state.commonModule.viewerCheck)),v=(0,o.KR)(!1);let p=null;const g=(0,s.nI)(),f=(0,o.KR)(!1),I=(0,o.KR)(""),y=(0,o.KR)(""),b=(0,s.EW)((()=>i.state.embeddedStatusModule)),C=(0,o.KR)(0),h=(0,o.KR)(""),S=(0,o.KR)(0),k=(0,o.KR)(""),N=(0,s.EW)((()=>i.state.commonModule)),_=(0,s.EW)((()=>i.state.commonModule)),E=(0,o.KR)({icon:["fas","person"],class:""}),w=(0,o.KR)(""),R=(0,o.KR)(""),L=(0,o.KR)(!1),T=(0,o.KR)(!1),P=(0,o.KR)(1e3),A=(0,o.KR)(null),D=(0,o.KR)(null),M=(0,o.KR)(""),x=(0,s.EW)((()=>i.state.userModule)),K=(0,o.KR)(sessionStorage.getItem("isNsNbIntegration")||""),O=(0,s.EW)((()=>i.state.commonModule.analysisType)),B=(0,o.KR)(0),F=(0,o.KR)(!1),U=(0,o.KR)(""),$=(0,o.KR)("");let W=null;const X=(0,o.KR)(!1),H=(0,o.KR)(""),V=(0,o.KR)(""),Y=(0,o.KR)(!1),q=(0,o.KR)(""),Q=(0,o.KR)(!1),J=(0,o.KR)(!1),ee=(0,s.EW)((()=>U.value)),te=(0,s.EW)((()=>$.value)),ae=()=>{Q.value=!Q.value},le=()=>{const e=new Date;U.value=e.toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}),$.value=e.toLocaleTimeString("en-US")},oe=async()=>{if(f.value=!1,await fs({userId:M.value}),"exit"===q.value)if("main"===m.value)Je.publish("childEmitSocketData",z().embedStatus.exit);else{const e=await Ot(),t=`ip=${e.data}`,a=`http://${e.data}:3000/close?${t}`;await Z.A.get(a)}else sessionStorage.clear(),await VC.push("user/login"),document.fullscreenElement&&await document.exitFullscreen()},ne=()=>{f.value=!1},ie=()=>{document.fullscreenElement||document.documentElement.requestFullscreen()};(0,s.sV)((async()=>{Y.value="bm"===window.PROJECT_TYPE,le();const e=setInterval(le,1e3);(0,s.xo)((()=>{clearInterval(e)})),""===M.value&&await i.dispatch("userModule/setUserAction",d),document.addEventListener("click",ue),window.addEventListener("wheel",re,{passive:!1})})),(0,s.xo)((()=>{document.removeEventListener("click",ue),window.removeEventListener("wheel",re)})),(0,s.wB)(x.value,((e,t)=>{Ee(),M.value=e.id})),(0,s.wB)([b.value],(async e=>{await(0,s.dY)(),C.value=Number(e[0].sysInfo.oilCount),h.value=e[0].sysInfo.isDoorOpen,S.value=Number(e[0].sysInfo.storageSize),k.value=e[0].sysInfo.eqStatCd,E.value=be(e[0].sysInfo.eqStatCd),w.value=Ie(),R.value=ye(),J.value||ce()}));const re=e=>{e.ctrlKey&&e.preventDefault()},ce=async()=>{const e=j(),t={jobCmd:"SEARCH_CARD_COUNT",reqUserId:M.value,reqDttm:e,testType:O.value};Je.publish("childEmitSocketData",t),J.value=!0};(0,s.wB)([_.value],(async e=>{const t=JSON.parse(JSON.stringify(e));t[0].isRunningState?F.value=!0:F.value=!1})),(0,s.wB)([N.value],(async e=>{L.value=e[0].isAlarm,e[0].isAlarm&&(W=setTimeout((()=>{i.dispatch("commonModule/setCommonInfo",{isAlarm:!1})}),B.value))}));const ue=e=>{const t=document.querySelector(".userSetOutUl"),a=document.querySelector(".cursorPointer");a&&a.contains(e.target)||t&&!t.contains(e.target)&&(Q.value=!1)},de=e=>{X.value=!0,H.value="success",V.value=e},me=e=>{X.value=!0,H.value="error",V.value=e},ve=()=>{X.value=!1},pe=e=>t.path===e,ge=()=>{q.value="logout",y.value=G.Logout,f.value=!0,localStorage.removeItem("user"),Q.value=!1},fe=async()=>{q.value="exit",y.value=G.exit,f.value=!0,Q.value=!1},Ie=()=>C.value>=0&&C.value<=100?"10%":C.value>100&&C.value<=250?"25%":C.value>250&&C.value<=500?"50%":C.value>500&&C.value<=750?"75%":"100%",ye=()=>S.value>=0&&S.value<=30?"30%":S.value>30&&S.value<=60?"60%":S.value>60&&S.value<=90?"90%":"100%",be=e=>"01"===e?{icon:["fas","person"],class:""}:"02"===e?{icon:["fas","person-walking"],class:""}:"03"===e?{icon:["fas","person-running"],class:"runRed"}:"04"===e||"05"===e?{icon:["fas","person-running"],class:"runBlue"}:{icon:["fas","person"],class:""},Ce=()=>{"viewer"!==m.value?T.value=!0:me("Access is only available from the main PC.")},he=e=>{T.value=e},Se=()=>{ke();const e=z().embedStatus.settings;e.reqUserId=M,Object.assign(e,{oilCount:C,isOilReset:"Y",userId:"",isNsNbIntegration:K.value||""}),g?.appContext.config.globalProperties.$socket.emit("message",{type:"SEND_DATA",payload:e}),de(G.IDS_MSG_SUCCESS)},ke=()=>{if(!A.value||!D.value)return;const e=Math.round(C.value/P.value*100),t=e/100*A.value.offsetWidth+"px";D.value.style.width=t},Ne=()=>{null!==p&&clearTimeout(p),v.value=!0,z().embedStatus.oilPrime.reqUserId=M,Je.publish("childEmitSocketData",z().embedStatus.oilPrime),p=setTimeout((()=>{v.value=!1,p=null}),1500)},_e=()=>{ke()},Ee=async()=>{try{const e=await se();if(e&&e?.data){const t=e.data;await i.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:t.isNsNbIntegration?"Y":"N"}),B.value=t?.isAlarm?1e3*Number(t.alarmCount):5e3,await i.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",t.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",t?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",t?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",t?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(t?.edgeShotType)),sessionStorage.setItem("iaRootPath",t?.iaRootPath),await i.dispatch("commonModule/setCommonInfo",{iaRootPath:String(t?.iaRootPath)})}}catch(e){console.log(e)}};return(e,i)=>{const r=(0,s.g2)("font-awesome-icon"),c=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("header",jC,[(0,s.Lk)("nav",null,[a.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["appHeaderLeft",{bmComponent:Y.value}])},[(0,s.Lk)("div",YC,[qC,(0,s.Lk)("p",QC,(0,n.v_)(Y.value?"BM":"PB"),1)]),(0,s.bF)(c,{to:F.value?"#":"/setting",class:(0,n.C4)({leftActive:pe("/setting"),disabledLink:F.value})},{default:(0,s.k6)((()=>[(0,s.bF)(r,{icon:["fas","gear"],style:{"font-size":"1rem"}}),JC])),_:1},8,["to","class"]),"main"===m.value?((0,s.uX)(),(0,s.Wv)(c,{key:0,to:"/",class:(0,n.C4)({leftActive:pe("/analysis")||"/"===(0,o.R1)(t).path})},{default:(0,s.k6)((()=>[(0,s.bF)(r,{icon:["fas","chart-pie"],style:{"font-size":"1rem"}}),zC])),_:1},8,["class"])):(0,s.Q3)("",!0),(0,s.bF)(c,{to:"/dataBase",class:(0,n.C4)({leftActive:pe("/dataBase")||pe("/databaseDetail")||pe("/databaseRbc")||pe("/report")||pe("/databaseWhole")})},{default:(0,s.k6)((()=>[(0,s.bF)(r,{icon:["fas","server"],style:{"font-size":"1rem"}}),ZC])),_:1},8,["class"]),(0,s.Lk)("div",eh,[(0,s.Lk)("div",th,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,(0,n.v_)(ee.value)+" "+(0,n.v_)(te.value),1),(0,s.Lk)("li",ah,[(0,s.Lk)("div",{class:"cursorPointer userBox",onClick:ae},[(0,s.bF)(r,{icon:["fas","circle-user"]}),(0,s.eW)(" "+(0,n.v_)(x.value.userId),1)]),(0,s.bo)((0,s.Lk)("ul",{class:"userSetOutUl",onClick:i[0]||(i[0]=(0,l.D$)((()=>{}),["stop"]))},[(0,s.Lk)("li",{onClick:ge},"LOGOUT")],512),[[l.aG,Q.value]]),(0,s.Lk)("div",{class:"logOutBox",onClick:fe}," EXIT "),(0,s.Lk)("div",{class:"logOutBox",onClick:ie},"FULL SCREEN")])])]),(0,s.Lk)("div",lh,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",sh,[(0,s.bF)(r,{icon:["fas","bell"],class:(0,n.C4)({blinking:L.value})},null,8,["class"])]),(0,s.Lk)("li",null,["Y"!==h.value?((0,s.uX)(),(0,s.Wv)(r,{key:0,icon:["fas","door-closed"]})):((0,s.uX)(),(0,s.Wv)(r,{key:1,icon:["fas","door-open"]}))]),(0,s.Lk)("li",null,[(0,s.bF)(r,{icon:E.value.icon,class:(0,n.C4)(E.value.class)},null,8,["icon","class"])]),(0,s.Lk)("li",{class:"oliCount",onClick:Ce,title:"oilCount: "+(w.value||0)},[(0,s.bF)(r,{icon:["fas","droplet"]})],8,oh),(0,s.Lk)("li",{class:"storage",title:"storage: "+(R.value||0)},[(0,s.bF)(r,{icon:["fas","database"]})],8,nh)])])])],2))])]),T.value?((0,s.uX)(),(0,s.Wv)(rr,{key:0,"onUpdate:closeLayer":he,onAfterOpen:_e},{header:(0,s.k6)((()=>[ih])),content:(0,s.k6)((()=>[(0,s.Lk)("div",rh,[ch,uh,(0,s.Lk)("div",dh,[mh,(0,s.Lk)("span",vh,(0,n.v_)(C.value),1)]),(0,s.Lk)("div",ph,[(0,s.Lk)("div",{ref_key:"statusBarWrapper",ref:A,class:"statusBarWrapper"},[(0,s.Lk)("div",{ref_key:"statusBar",ref:D,class:"statusBar"},null,512)],512),(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:Se,class:"alertButton"},"Reset")])])]),(0,s.Lk)("div",gh,[fh,Ih,(0,s.Lk)("div",yh,[bh,(0,s.Lk)("button",{type:"button",onClick:Ne,class:(0,n.C4)({alertButton:!0,blinkGripper:v.value})},"Prime ",2)])])])),_:1})):(0,s.Q3)("",!0),X.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":X.value,type:H.value,message:V.value,onHide:ve,"onUpdate:hideAlert":ve},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),f.value?((0,s.uX)(),(0,s.Wv)(Dt,{key:2,"is-visible":f.value,type:I.value,message:y.value,onHide:ne,onOkConfirm:oe},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const hh=Ch;var Sh=hh;const kh=async e=>{if("00000"===e?.resultCd){const t={embeddedStatusJobCmd:"",userStop:"Y"===e.isRecovery,isRecoveryRun:"N"===e.isRecovery&&!1,isPause:"PAUSE"===e.jobCmd,sysInfo:e,isInit:e?e.isInit:void 0},a={siteCd:e.siteCd,deviceSerialNm:e.deviceBarcode};return await qi.dispatch("commonModule/setCommonInfo",a),await qi.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",t),null}return await qi.dispatch("commonModule/setCommonInfo",{appAlertOpen:!0}),e?.resultMsg},Nh=async e=>{await qi.dispatch("runningInfoModule/setRunningInfo",e)},_h=(e,t)=>{let a=0,l=0;const s={isNormal:"Y",class:[]};return e&&(e.forEach((e=>{-1===["NR","AR","GP","PA","MC","MA"].indexOf(e.title)&&(a+=Number(e.count)),["NE","NS","NB"].includes(e.title)&&(l+=Number(e.count))})),e.forEach((e=>{t.forEach((t=>{if("01"===t.classId){let o=0;["01","71"].includes(e.id)&&(o=l/a*100,o<t.min||o>t.max?(console.log(`SET [NE] Abnormal : ${e.title}`),s.isNormal="N",s.class.push(`[NE] : [${o.toFixed(2)}]%`)):console.log(`SET [NE] NORMAL : ${e.title}`))}else if(e.id===t.classId)if("Count"===t.unit)(Number(e.count)<t.min||Number(e.count)>t.max)&&(s.isNormal="N",s.class.push(`${e.title} : [${e.count}]Count`));else{let l=0;l=Number(e.count)/a*100,l<t.min||l>t.max?(console.log(`SET Abnormal : ${e.title}`),s.isNormal="N",s.class.push(`${e.title} : [${l.toFixed(2)}]%`)):console.log(`SET NORMAL : ${e.title}`)}}))}))),s};const Eh=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,key:"",order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,key:"",order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,key:"",order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,key:"",order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,key:"",order:7},{id:"61",title:"LR",name:"Reactive lymphocyte",count:0,percent:0,key:"",order:8},{id:"62",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,key:"",order:9},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,key:"",order:10},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,key:"",order:11},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,key:"",order:12},{id:"10",title:"BL",name:"Blast",count:0,percent:0,key:"",order:13},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,key:"",order:14},{id:"12",title:"NR",name:"nRBC",count:0,percent:0,key:"",order:15},{id:"13",title:"GP",name:"Giant platelet",count:0,percent:0,key:"",order:16},{id:"14",title:"PA",name:"Platelet aggregation",count:0,percent:0,key:"",order:17},{id:"16",title:"MA",name:"Malaria",count:0,percent:0,key:"",order:18},{id:"15",title:"AR",name:"Artifact",count:0,percent:0,key:"",order:19},{id:"17",title:"SM",name:"Smudge",count:0,percent:0,key:"",order:20}],wh=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,order:7},{id:"06",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,order:8},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,order:9},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,order:10},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,order:11},{id:"10",title:"BL",name:"Blast",count:0,percent:0,order:12},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,order:13},{id:"12",title:"ON",name:"Orthochromic Normoblast",count:0,percent:0,order:14},{id:"13",title:"PN",name:"Polychromic Normoblast",count:0,percent:0,order:15},{id:"14",title:"BN",name:"Basophilic Normoblast",count:0,percent:0,order:16},{id:"15",title:"PE",name:"Proerythroblast",count:0,percent:0,order:17},{id:"16",title:"HC",name:"Histiocyte",count:0,percent:0,order:18},{id:"17",title:"OT",name:"Others",count:0,percent:0,order:19}];var Rh=(0,s.pM)({__name:"App",setup(e){const t=(0,r.rd)(),a=(0,o.KR)(!1),l=(0,o.KR)(""),i=(0,o.KR)(""),u=(0,c.Pj)(),d=(0,s.EW)((()=>u.state.commonModule)),m=(0,s.nI)(),v=(0,o.KR)(""),p=sessionStorage.getItem("user"),g=JSON.parse(p||"{}"),f=(0,o.KR)([]),I=(0,s.EW)((()=>u.state.userModule)),y=(0,s.EW)((()=>u.state.commonModule)),b=(0,o.KR)(!1);let C=null,h=null;const S=(0,s.EW)((()=>u.state.commonModule.iaRootPath)),k=(0,s.EW)((()=>u.state.commonModule.slotIndex)),N=(0,s.EW)((()=>u.state.commonModule.siteCd)),_=(0,s.EW)((()=>u.state.commonModule.isDownloadOrUploading)),E=(0,o.KR)("N"),w=(0,o.KR)([]),R=(0,o.KR)([]),L=(0,o.KR)([]),T=(0,o.KR)(""),P=(0,o.KR)(!1),A=(0,o.KR)({}),D=(0,o.KR)(!1),M=(0,o.KR)(""),x=(0,o.KR)(""),K=(0,o.KR)(!1);let O;const B=(0,o.KR)(!1);let F;const U=(0,o.KR)(!1),$=(0,o.KR)(!1),W=(0,o.KR)("");m?.appContext.config.globalProperties.$socket.on("isTcpConnected",(async e=>{console.log("isTcpConnected",e),e&&setTimeout((async()=>{await u.dispatch("commonModule/setCommonInfo",{isTcpConnected:!0})}),1500)})),m?.appContext.config.globalProperties.$socket.on("viewerCheck",(async e=>{await H(e)}));const X=(0,o.KR)(!1),H=async e=>{try{const e=await Ot();e.data,T.value=e.data}catch(t){console.log(t)}};function V(){const{path:e}=t.currentRoute.value;"/user/login"!==e&&(B.value=window.matchMedia("(display-mode: fullscreen)").matches,B.value?"Please click the full screen button."===i.value&&ve():me("Please click the full screen button."))}function j(){V(),F=setInterval(V,6e4)}(0,s.wB)(y.value,(async(e,t)=>{if(!e.reqArr)return;const a=ae(e.reqArr),l=a.filter((e=>!["SYSINFO","RUNNING_INFO"].includes(e.jobCmd)));if(!_.value)return l.length>0?(await ce(l[0]),void await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})):K.value?(K.value=!1,void await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})):void(0!==a.length&&(l.length>0?await ce(l[0]):await ce(a[0]),await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})));await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})})),(0,s.wB)(I.value,((e,t)=>{""!==e.id&&(ue(),v.value=e.id)})),(0,s.KC)((()=>{m?.appContext.config.globalProperties.$socket.emit("viewerCheck",{type:"SEND_DATA",payload:window.APP_API_BASE_URL})})),window.addEventListener("beforeunload",(async function(e){await fs({userId:v.value}),await u.dispatch("commonModule/setCommonInfo",{firstLoading:!1})})),window.addEventListener("unload",(async()=>{$.value&&m?.appContext.config.globalProperties.$socket.emit("message",{type:"SEND_DATA",payload:{jobCmd:"clientExit",reqUserId:"",reqDttm:""}})}));const Y=async e=>{if(e.preventDefault(),!$.value){const e=await Ot(),t=`ip=${e.data}`,a=`http://${e.data}:3000/close?${t}`;await Z.A.get(a)}};(0,s.KC)((()=>{P.value="bm"===window.PROJECT_TYPE,M.value=window.PB_VERSION}));const q=(e,t)=>{const a=/http:\/\/([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+):/,l=e.match(a);return!(!l||!l[1])&&l[1]===t};async function Q(e){if("main"===d.value.viewerCheck){K.value=!1;try{if("string"===typeof e)return void await de(G.TCP_DiSCONNECTED);const a=new TextDecoder("utf-8"),l=a.decode(e),s=JSON.parse(l),o=s;switch(i.value===G.TCP_DiSCONNECTED&&ve(),o.jobCmd){case"RBC_RE_CLASSIFICATION":await u.dispatch("commonModule/setCommonInfo",{rbcReDataClass:!0}),await u.dispatch("commonModule/setCommonInfo",{rbcReData:!0}),await u.dispatch("commonModule/setCommonInfo",{rbcReDataCheck:!1});break;case"SYSINFO":const y=await kh(o);null!==y&&me(y);const C={siteCd:o.siteCd,deviceSerialNm:o.deviceSerialNm};X.value||await p(C);break;case"INIT":W.value="",await u.dispatch("commonModule/setCommonInfo",{initValData:!1}),ie();break;case"START":W.value="",await r();break;case"RUNNING_INFO":A.value=o,b.value=!0,await Nh(o),await c(o);break;case"STOP":console.log("stop!=--------------------------"),W.value="",await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),D.value=!1,b.value=!1;break;case"RUNNING_COMP":W.value="",await n();break;case"PAUSE":W.value="",await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{isPause:!0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),D.value=!1,b.value=!1;break;case"RESTART":W.value="",await Nh(o),await c(o),await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{isPause:!1}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),b.value=!0,D.value=!0,await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),R.value=[],L.value=[];break;case"RECOVERY":W.value="",await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{userStop:!1}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]});break;case"ERROR_CLEAR":console.log("err"),await de(G.IDS_MSG_FAILED);break;case"SEARCH_CARD_COUNT":break}async function n(){await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!0}),await u.dispatch("commonModule/setCommonInfo",{embeddedNumber:String(e?.iCasStat)}),await u.dispatch("commonModule/setCommonInfo",{startEmbedded:!1}),await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1}),await u.dispatch("commonModule/setCommonInfo",{isAlarm:!0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"stop"}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),b.value=!1,D.value=!1}async function r(){await u.dispatch("commonModule/setCommonInfo",{isRunningState:!0}),await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"start"}),await u.dispatch("commonModule/setCommonInfo",{startEmbedded:"start"}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!1}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),D.value=!0,R.value=[],L.value=[],b.value=!0}async function c(e){const t=/[1,2,9]/g;if("999999999999"!==String(e?.iCasStat)){const a=String(e?.iCasStat),l=e?.slotInfo,s=e?.iCasStat,o=[...s],n=-1===o.lastIndexOf("3")?0:o.lastIndexOf("3")+1;if(0===o.lastIndexOf("2")&&await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!0}),-1!==e?.iCasStat.indexOf("2")&&await u.dispatch("commonModule/setCommonInfo",{slideProceeding:e?.iCasStat.indexOf("2")}),"100a"===M.value&&(x.value="1"===e?.iCasChange?"reset":""),a.search(t)<0||"111111111111"===e?.oCasStat&&!d.value.runningInfoStop)return z().embedStatus.runIngComp.reqUserId=I.value.userId,("100a"!==M.value||"Y"===e?.workingDone)&&(await u.dispatch("commonModule/setCommonInfo",{reqArr:z().embedStatus.runIngComp}),await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!0})),void await m(e,e?.slotInfo?.slotNo);await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"start"}),"Y"===l?.isLowPowerScan&&"03"===l?.testType?(z().embedStatus.pause.reqUserId=v.value,await u.dispatch("commonModule/setCommonInfo",{reqArr:z().embedStatus.pause}),z().embedStatus.pause.reqUserId=v.value,await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1})):n!==k.value&&(await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"afterChange"}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!0}),await m(w.value,w.value?.slotInfo?.slotNo),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:l?.slotId}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:n})),-1!==o.lastIndexOf("2")&&(w.value=e)}}async function m(e,t,a,l){const s=e.slotInfo;if(s){s.userId=v.value,s.cassetId=e.cassetId,s.isNormal="Y","01"===s.analysisType&&(s.isNormal=_h(s.wbcInfo,f.value).isNormal);const o=R.value.filter((e=>e?.slotId===s.slotId)),n=L.value.filter((e=>e?.slotId===s.slotId)),i=o[0],r={wbcInfo:i?.wbcInfo,nonRbcClassList:i?.nonRbcClassList,totalCount:i?.totalCount,maxWbcCount:i?.maxWbcCount};let c=[],u=[];const d=()=>P.value?{wbcInfo:[wh]}:{wbcInfo:[Eh]},m=()=>P.value?[wh]:[Eh],p=()=>0===Object.keys(r).length?d():r,I=()=>0===Object.keys(r).length?m():r?.wbcInfo[0],y=P.value?[]:n[0].rbcInfo;"0011"===N.value||""===N.value||"0000"===N.value?("04"!==s.testType&&(r.wbcInfo[0]=await _u(s,I())),u=p(),c=I(),W.value!==s.barcodeNo&&(Je.publish("appVueSlideDataSaveLisSave",c,y,s.barcodeNo),W.value=s?.barcodeNo)):(u=p(),c=I());const b={slotNo:s.slotNo,lock_status:!1,traySlot:"1-"+t,barcodeNo:s.barcodeNo,patientId:s.patientId,patientNm:s.patientNm,gender:s.gender,birthDay:s.birthDay,wbcCount:s.wbcCount,slotId:s.slotId,orderDttm:s.orderDttm,testType:s.testType,analyzedDttm:z().embedStatus.settings.reqDttm,tactTime:s.tactTime,maxWbcCount:s.maxWbcCount,bf_lowPowerPath:s.bf_lowPowerPath,wbcInfo:u,wbcInfoAfter:c,rbcInfo:P.value?[]:{pltCount:s.pltCount,malariaCount:s.malariaCount,maxRbcCount:s.maxRbcCount,rbcClass:n[0].rbcInfo},rbcInfoAfter:y,bminfo:s.bminfo,cassetId:s.cassetId,isNormal:s.isNormal,submitState:"",submitOfDate:"",submitUserId:"",isNsNbIntegration:E.value||"",wbcMemo:"",rbcMemo:""};await g(b,a,l)}}async function p(e){try{const t=await Kt();0!==t.data.length&&t.data||await xt({deviceItem:e}),X.value=!0,await u.dispatch("commonModule/setCommonInfo",{siteCd:o.siteCd}),localStorage.setItem("siteCd",o.siteCd)}catch(t){console.error("Error handling device information",t),X.value=!0}}async function g(e,t,a){try{let a;console.log("저장 전 runingInfoDtoItems",e),a=await cu({userId:Number(v.value),runingInfoDtoItems:e}),a&&(t&&console.log("save successful"),J("SEND_DATA","refreshDb",300))}catch(l){console.error(l)}}}catch(t){console.error(t)}}}(0,s.sV)((async()=>{await(0,s.dY)(),await ue(),j();const e=await Ot();$.value=q(window.APP_API_BASE_URL,e.data),X.value=!1,window.addEventListener("beforeunload",Y),""===v.value&&(await u.dispatch("userModule/setUserAction",g),v.value=I.value.id),d.value.isRunningState||(v.value&&""!==v.value&&await re(),!d.value.firstLoading&&$.value&&"main"===window.FORCE_VIEWER&&(C=setInterval((async()=>{await le()}),400),h=setInterval((async()=>{d.value.runningInfoStop||await oe()}),500),await u.dispatch("commonModule/setCommonInfo",{firstLoading:!0}))),Je.subscribe("childEmitSocketData",ne)})),(0,s.xo)((async()=>{window.removeEventListener("beforeunload",Y),h&&(clearInterval(h),h=null),C&&(clearInterval(h),h=null)})),m?.appContext.config.globalProperties.$socket.on("chat",(async e=>{await Q(e)}));const J=(e,t,a)=>{void 0!==O&&clearTimeout(O),O=window.setTimeout((()=>{m?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},ee=e=>{L.value[e.iCasStatArr]=e.rbc},te=e=>{R.value[e.iCasStatArr]=e.classInfo},ae=e=>{const t=new Set,a=[];return e.forEach((e=>{t.has(e.jobCmd)||(t.add(e.jobCmd),a.push(e))})),a},le=async()=>{z().embedStatus.sysInfo.reqUserId=v.value;const e=z().embedStatus.sysInfo;await u.dispatch("commonModule/setCommonInfo",{reqArr:e})},oe=async()=>{if(!b.value)return;z().embedStatus.runningInfo.reqUserId=v.value;const e=z().embedStatus.runningInfo;await u.dispatch("commonModule/setCommonInfo",{reqArr:e})},ne=async e=>{await u.dispatch("commonModule/setCommonInfo",{reqArr:e}),await u.dispatch("commonModule/setCommonInfo",{rbcReDataCheck:!0})},ie=()=>{const e={jobCmd:"SETTINGS",reqUserId:"",reqDttm:z().embedStatus.settings.reqDttm,pbiaRootDir:S.value||"",oilCount:"1000",isOilReset:"N",deviceType:"01",isNsNbIntegration:E.value};u.dispatch("commonModule/setCommonInfo",{reqArr:e})},re=async()=>{try{const e=await Ce();if(e&&e?.data){const t=e.data;f.value=t}}catch(e){console.log(e)}},ce=async e=>{const t=async()=>{m?.appContext.config.globalProperties.$socket.emit("message",{type:"SEND_DATA",payload:e})};await t(),K.value=!0},ue=async()=>{try{const e=await se();if(e&&e?.data){const t=e.data;sessionStorage.setItem("iaRootPath",t?.iaRootPath),await u.dispatch("commonModule/setCommonInfo",{iaRootPath:String(t?.iaRootPath)}),await u.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),E.value=t?.isNsNbIntegration?"Y":"N",await u.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",t?.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",t?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",t?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",t?.diffPltPositionMargin);const a="pb"===window.PROJECT_TYPE?"keepPage":"bmKeepPage";sessionStorage.setItem(a,String(t?.keepPage)),sessionStorage.setItem("edgeShotType",String(t?.edgeShotType)),sessionStorage.setItem("keepPage",String(t?.keepPage))}}catch(e){console.log(e)}},de=async e=>{a.value=!0,l.value="success",i.value=e},me=e=>{a.value=!0,l.value="error",i.value=e},ve=()=>{a.value=!1};return(e,r)=>{const c=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",null,["/user/login"!==(0,o.R1)(t).currentRoute.value.path&&"/user/join"!==(0,o.R1)(t).currentRoute.value.path?((0,s.uX)(),(0,s.Wv)(Sh,{key:0})):(0,s.Q3)("",!0),(0,s.Lk)("main",{class:(0,n.C4)(["content",{bmComponent:P.value}])},[(0,s.bF)(c),(0,s.bF)(cs,{onClassAppUpdateLast:te,onRbcAppUpdate:ee,parsedData:A.value,isClass:"/"===(0,o.R1)(t).currentRoute.value.path,startStatus:D.value,pb100aCassette:x.value,stataasdasd:U.value},null,8,["parsedData","isClass","startStatus","pb100aCassette","stataasdasd"])],2),a.value?((0,s.uX)(),(0,s.Wv)(at,{key:1,"is-visible":a.value,type:l.value,message:i.value,onHide:ve,"onUpdate:hideAlert":ve},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)])}}});const Lh=Rh;var Th=Lh,Ph=a(7107),Ah=a(6188),Dh=a(1273),Mh=a(6373);const xh=window.MAIN_WEBSOCKET_IP||"http://192.168.0.131:3002",Kh={install:e=>{const t=(0,Mh.io)(`${xh}`,{transports:["websocket"],withCredentials:!0,reconnection:!0,reconnectionAttempts:15,reconnectionDelay:3e3,timeout:3e4});let a=null;function l(){t.connected&&(t.emit("ping"),console.log("Ping sent to server")),a=setTimeout(l,1e4)}t.on("connect",(()=>{console.log("WebSocket connected"),e.config.globalProperties.$socketError=!1,l(),a&&(clearTimeout(a),a=null)})),t.on("disconnect",(()=>{console.log("WebSocket disconnected"),e.config.globalProperties.$socketError=!0,console.log("연결이 끊어졌습니다. 재연결을 시도합니다."),l(),a&&(clearTimeout(a),a=null)})),t.on("connect_error",(t=>{console.error("WebSocket connection error:",t),e.config.globalProperties.$socketError=!0,l(),a&&(clearTimeout(a),a=null),console.log("서버와의 연결에 문제가 발생했습니다. 재연결을 시도합니다.")})),t.on("pong",(e=>{console.log(`Pong received with latency: ${e}ms`)})),e.config.globalProperties.$socket=t,e.config.globalProperties.$socketError=!1;const s=e.unmount.bind(e);e.unmount=()=>{t.disconnect(),a&&clearTimeout(a),s()}}};var Oh=Kh;const Bh={prefix:"fac",iconName:"half-circle-up",icon:[512,512,[],"e002","M256 0c141.385 0 256 114.615 256 256H0C0 114.615 114.615 0 256 0z"]},Fh={prefix:"fac",iconName:"half-circle-down",icon:[512,512,[],"e003","M256 512c-141.385 0-256-114.615-256-256h512c0 141.385-114.615 256-256 256z"]};Ph.Yv.add(Ah.X7I),Ph.Yv.add(Ah.GEE),Ph.Yv.add(Bh),Ph.Yv.add(Fh);const Uh=(0,l.Ef)(Th);Uh.use(VC),Uh.use(qi),Uh.use(Oh),Uh.component("font-awesome-icon",Dh.gc),Uh.mount("#app")}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var o=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){var e=[];a.O=function(t,l,s,o){if(!l){var n=1/0;for(u=0;u<e.length;u++){l=e[u][0],s=e[u][1],o=e[u][2];for(var i=!0,r=0;r<l.length;r++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](l[r])}))?l.splice(r--,1):(i=!1,o<n&&(n=o));if(i){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[l,s,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,o,n=l[0],i=l[1],r=l[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(r)var u=r(a)}for(t&&t(l);c<n.length;c++)o=n[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},l=self["webpackChunkuimdCell"]=self["webpackChunkuimdCell"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],(function(){return a(2708)}));l=a.O(l)})();
//# sourceMappingURL=app.37320549.js.map